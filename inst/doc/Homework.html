<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Jinyiren Ren" />

<meta name="date" content="2022-12-13" />

<title>Homework to SA22204174</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework to SA22204174</h1>
<h4 class="author">Jinyiren Ren</h4>
<h4 class="date">2022-12-13</h4>



<div id="homework-2023.09.11" class="section level1">
<h1>Homework-2023.09.11</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<p>The three examples are shown as follows.</p>
<div id="example-of-table-and-figure-generated-from-random-variables." class="section level3">
<h3>1. Example of Table and Figure Generated from Random Variables.</h3>
<p>We generate 100 samples that follow the standard normal distribution
<span class="math inline">\(\mathcal{N}(0,1)\)</span> randomly and
compare their distribution trends such as their minimum, maximum,
quarter, three quarters, median, and mean with the standard normal
distribution <span class="math inline">\(\mathcal{N}(0,1)\)</span>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">summary</span>(data1)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>population <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fu">qnorm</span>(<span class="fl">0.25</span>), <span class="fu">qnorm</span>(<span class="fl">0.5</span>), <span class="dv">0</span>, <span class="fu">qnorm</span>(<span class="fl">0.75</span>), <span class="sc">+</span><span class="cn">Inf</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>table1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(samples, population)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(table1)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">samples</th>
<th align="right">population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Min.</td>
<td align="right">-2.2146999</td>
<td align="right">-Inf</td>
</tr>
<tr class="even">
<td align="left">1st Qu.</td>
<td align="right">-0.4942425</td>
<td align="right">-0.6744898</td>
</tr>
<tr class="odd">
<td align="left">Median</td>
<td align="right">0.1139092</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">Mean</td>
<td align="right">0.1088874</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">3rd Qu.</td>
<td align="right">0.6915454</td>
<td align="right">0.6744898</td>
</tr>
<tr class="even">
<td align="left">Max.</td>
<td align="right">2.4016178</td>
<td align="right">Inf</td>
</tr>
</tbody>
</table>
<p>Then we compare the frequency distribution histogram of the samples
with the density function of the standard normal distribution, <span class="math display">\[f(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}.\]</span></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#plot(x, dexp(x), ty=&quot;l&quot;, main=&quot;指数分布&quot;, xlab=&quot;x&quot;, ylab=&quot;f(x)&quot;)</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">hist</span>(data1, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&#39;Histogram of samples from N(0,1)&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>), <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dnorm</span>(x), <span class="at">col=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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Lo9hDYDekggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgLIA2s7byerxd46pkl3AljOBmd50D5pPjywHILn0Yzed0PO1Yy5J2vHZciaQfMT5W+d7h2dElgGQ2ill+u7LO9eMtp5pcu9I40zQdjv8uBbozIksVx00GdCuunLMRvov1pNg+NqXUVYCaDujEnIB+uLO/YUvQS/vFv0TI8sDaDfrXZKO69X5wJcbAoB8U5uTI8tXxKbvF5cQ0M7/bviJkWVrB824jaUrYsGp8WmRpQVkvY79+N3i+kTTKml3AmMxVIym7WOXIQfpAGbsQ+RIErrNe31496OdE1mOIiY3FLaWyhwtV+ShhqLnUh8vvK5nRJalDpIvRp6xHaPzekOdAzegrV6B4kw1PTJ2VoEICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgP4PbPsoYc8IC0wAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="example-of-table-and-figure-generated-form-data" class="section level3">
<h3>2. Example of Table and Figure Generated form Data</h3>
<p>This famous (Fisher’s or Anderson’s) iris data set gives the
measurements in centimeters of the variables sepal length and width and
petal length and width, respectively, for 50 flowers from each of 3
species of iris. The species are Iris setosa, versicolor, and
virginica.</p>
<p>iris is a data frame with 150 cases (rows) and 5 variables (columns)
named Sepal.Length, Sepal.Width, Petal.Length, Petal.Width, and Species.
We output its first 6 rows in table.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> iris</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(d[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,])</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<p>We made frequency histogram and density curve for the length of
sepals of each iris flower species.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">#par(mfrow=c(2,2))</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">hist</span>(d[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="st">&quot;Sepal.Length&quot;</span>], <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&#39;Histogram of setosa&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">6</span>), <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(d[<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="st">&quot;Sepal.Length&quot;</span>]), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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O2nHXbmBogI6XH3bBi6XIbLNIlJ27Ws6Jo20PQ53hgOrN7OdOSs3UExAdS26vkVWyPIP1exO5WeF5bWK+h6HO8OB1dvx1f/vfLyNFRGQaLld4PIInz7OdTvxMpg6romYjD12d4aZ3dtBTEjplpFyVW6kiID0dTxddRiv9wk7IhQS7IgOF1qjWQlQ03A9DjHDrt1kXTit3YMOCsPBlDfZ4Xh6MxQP0KGdXSLr4OhVdTspeK5H3So810sant4MJRooojNpaZztpv6Zxh67O8PM7k3O3IHeJpRqJA3GYuosJqo5uQy6scfuzjCzexMdXz99Z7WBogxcniwO8FJD2pXm0abbyD3InWFm93aUAwCfyhnixSoQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQERENBf2ItdRX5FnTQAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">hist</span>(d[<span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>, <span class="st">&quot;Sepal.Length&quot;</span>], <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&#39;Histogram of versicolor&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">8</span>), <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(d[<span class="dv">51</span><span class="sc">:</span><span class="dv">100</span>, <span class="st">&quot;Sepal.Length&quot;</span>]), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">hist</span>(d[<span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>, <span class="st">&quot;Sepal.Length&quot;</span>], <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&#39;Histogram of virginica&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">9</span>), <span class="at">xlab =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(d[<span class="dv">101</span><span class="sc">:</span><span class="dv">150</span>, <span class="st">&quot;Sepal.Length&quot;</span>]), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-of-table-and-figure-inserted-in-r-markdown" class="section level3">
<h3>3. Example of Table and Figure Inserted in R Markdown</h3>
<p>We typed the table in Example 2 in the document in LaTeX format and
markdown format. The code is shown in the inserted image.</p>
<p>And we present the table in this HTML with code in markdown form.</p>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.10</td>
<td align="right">3.50</td>
<td align="right">1.40</td>
<td align="right">0.20</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.90</td>
<td align="right">3.00</td>
<td align="right">1.40</td>
<td align="right">0.20</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.70</td>
<td align="right">3.20</td>
<td align="right">1.30</td>
<td align="right">0.20</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.60</td>
<td align="right">3.10</td>
<td align="right">1.50</td>
<td align="right">0.20</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.00</td>
<td align="right">3.60</td>
<td align="right">1.40</td>
<td align="right">0.20</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.40</td>
<td align="right">3.90</td>
<td align="right">1.70</td>
<td align="right">0.40</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="homework-2023.09.18" class="section level1">
<h1>Homework-2023.09.18</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<div id="question-1." class="section level3">
<h3>Question 1.</h3>
<p>课后习题: 利用逆变换发复现函数sample的部分功能(replace=TRUE),
my.sample &lt;- function().</p>
</div>
<div id="question-2." class="section level3">
<h3>Question 2.</h3>
<p>Exercises 3.2, 3.7, 3.9, 3.10 (pages 94-96, Statistical Computing
with R).</p>
</div>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="课后习题." class="section level3">
<h3>1. 课后习题.</h3>
<p><strong>Problem.</strong>
利用逆变换发复现函数sample的部分功能(replace=TRUE), my.sample &lt;-
function().</p>
<p><strong>Solution.</strong> We define a function named “my.sample”,
which repeats some of the functionality of the function sample, through
the inverse transform method. As for the new function “my.sample”, we
input the range of values of random variables, the probability
corresponding to each value and the number of random samples to be
generated, and the function outputs the corresponding number of random
samples with replacement.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>my.sample <span class="ot">&lt;-</span> <span class="cf">function</span>(x, n, <span class="at">p =</span> <span class="dv">0</span>){</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#  cat(p,&#39;\n&#39;)</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(p) <span class="sc">==</span> <span class="dv">1</span>){</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>    cp <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x), <span class="dv">1</span>, <span class="dv">1</span><span class="sc">/</span><span class="fu">length</span>(x))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>    cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(p)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>  }</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#  cat(cp,&#39;\n&#39;)</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(U,cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>}</span></code></pre></div>
<p>We take some examples to show the functionality of function
“my.sample”. In each example, we compare the frequency of random samples
generated by the function with the distribution of the random
variable.</p>
<p>Example.1. We generate 2000 random samples which take values in <span class="math inline">\((1,2,3)\)</span> with averaged probability.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>example1.sample <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">n =</span> <span class="dv">2000</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>example1.ct <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(example1.sample))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>example1.ct<span class="sc">/</span><span class="fu">sum</span>(example1.ct)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1.0035 0.9870 1.0095</code></pre>
<p>Example.2. We generate 5000 random samples which take values in <span class="math inline">\((1,2,3,4)\)</span> with probability <span class="math inline">\((0.1,0.2,0.3,0.4)\)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>example2.sample <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">n =</span> <span class="dv">5000</span>, <span class="at">p =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>example2.ct <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(example2.sample))</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>example2.ct<span class="sc">/</span><span class="fu">sum</span>(example2.ct)<span class="sc">/</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span></code></pre></div>
<pre><code>## [1] 1.074000 1.000000 1.008667 0.975000</code></pre>
<p>Example.1. We generate 1000 random samples which take values in <span class="math inline">\((1,2,10)\)</span> with probability <span class="math inline">\((0.1,0.7,0.2)\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>example3.sample <span class="ot">&lt;-</span> <span class="fu">my.sample</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>), <span class="at">n =</span> <span class="dv">1000</span>, <span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.2</span>))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>example3.ct <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">table</span>(example3.sample))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>example3.ct<span class="sc">/</span><span class="fu">sum</span>(example3.ct)<span class="sc">/</span>(<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.7</span>,<span class="fl">0.2</span>))</span></code></pre></div>
<pre><code>## [1] 0.960000 1.008571 0.990000</code></pre>
<p>It has shown that the distribution of the random sample generated by
the function “my.sample” is close to the theoretical distribution.</p>
</div>
<div id="exercise-3.2.-page-94-statistical-computing-with-r." class="section level3">
<h3>2. Exercise 3.2. (Page 94, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> The standard Laplace distribution has
density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},\
x\in\mathbb{R}\)</span>. Use the inverse transform method to generate a
random sample of size 1000 from this distribution. Use one of the
methods shown in this chapter to compare the generated sample to the
target distribution.</p>
<p><strong>Solution.</strong> Suppose <span class="math inline">\(X\)</span> is a random variable with density <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|}=\frac{1}{2}e^{x}I_{(x\leq0)}+\frac{1}{2}e^{-x}I_{(x&gt;0)}.\]</span>
So the distribution function of <span class="math inline">\(X\)</span>
is <span class="math display">\[F(x)=\int_{-\infty}^xf(t)dt=\frac{1}{2}e^xI_{(x\leq0)}+(1-\frac{1}{2}e^{-x})I_{(x&gt;0)}.\]</span>
And the inverse function of <span class="math inline">\(F(x)\)</span> is
<span class="math display">\[F^{-1}(y)=\log(2y)I_{(0\leq
y\leq\frac{1}{2})}-\log(2(1-y))I_{(\frac{1}{2}&lt;y\leq1)}.\]</span> We
also suppose random variable <span class="math inline">\(U\sim\)</span>Uniform(0,1), then we have that
<span class="math inline">\(F^{-1}(U)\)</span> has the same distribution
as <span class="math inline">\(X\)</span>.</p>
<p>Now we use the inverse transform mathod to generate a random sample
of size 1000 from the target distribution.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># the inverse function of distribution function F</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>F.inverse <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="dv">0</span> <span class="sc">&lt;=</span> x <span class="sc">&amp;&amp;</span> x <span class="sc">&lt;=</span> <span class="fl">0.5</span>){</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>x)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>  }</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># inverse transform method</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>x.sample<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">sapply</span>(u, F.inverse)</span></code></pre></div>
<p>Then we compare the generated sample to the target diatribution.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>,<span class="fl">0.1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">hist</span>(x.sample<span class="fl">.1</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">main =</span>  <span class="st">&quot;Histogram of x&quot;</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="fu">lines</span>(x<span class="fl">.1</span>, <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x<span class="fl">.1</span>))<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we conclude that the distribution of samples roughly
fit the target distribution.</p>
</div>
<div id="exercise-3.7.-page-94-statistical-computing-with-r." class="section level3">
<h3>3. Exercise 3.7. (Page 94, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Write a function to generate a random
sample of size n from the Beta<span class="math inline">\((a,
b)\)</span> distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<p><strong>Solution.</strong> We use the acceptance-rejection method to
generate the random sample of size 1000. Suppose random variable <span class="math inline">\(X\sim\)</span>Beta<span class="math inline">\((a,b)\)</span>, so the density of <span class="math inline">\(X\)</span> is <span class="math display">\[f(x)=\frac{1}{\mathrm{Beta}(a,b)}x^{a-1}(1-x)^{b-1}I_{(0,1)}(x)=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}I_{(0,1)}(x).\]</span>
We also suppose random variable <span class="math inline">\(Y\sim\)</span>Uniform(0,1), whose density is <span class="math inline">\(g(x)=I_{(0,1)}(x)\)</span>. Then we have <span class="math display">\[\frac{f(x)}{g(x)}=\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}x^{a-1}(1-x)^{b-1}\leq\frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\triangleq
c.\]</span> So we define <span class="math display">\[\rho(Y)=\frac{f(Y)}{cg(Y)}=x^{a-1}(1-x)^{b-1}I_{(0,1)}(x).\]</span></p>
<p>Based on the acceptance-rejection algorithm, our algorithm is shown
below:</p>
<p>Step 1. Generate random numbers <span class="math inline">\(U\sim\)</span>Uniform(0,1) and <span class="math inline">\(Y\sim g(\cdot)\)</span>, which means that <span class="math inline">\(Y\sim\)</span>Uniform(0,1),</p>
<p>Step 2. If <span class="math inline">\(U\leq\rho(Y)\)</span>, then
accept <span class="math inline">\(Y\)</span> and stop (return <span class="math inline">\(X=Y\)</span>); otherwise reject <span class="math inline">\(Y\)</span> and continue.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># preparation</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>accept <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>x.sample<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a><span class="co"># acceptance-rejection algorithm</span></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="cf">while</span>(accept <span class="sc">&lt;</span> n){</span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co"># random variable from g(.)</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">&gt;</span> u){</span>
<span id="cb17-14"><a href="#cb17-14" tabindex="-1"></a>    <span class="co"># we accept x</span></span>
<span id="cb17-15"><a href="#cb17-15" tabindex="-1"></a>    accept <span class="ot">&lt;-</span> accept <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-16"><a href="#cb17-16" tabindex="-1"></a>    x.sample<span class="fl">.2</span>[accept] <span class="ot">&lt;-</span> x</span>
<span id="cb17-17"><a href="#cb17-17" tabindex="-1"></a>  }</span>
<span id="cb17-18"><a href="#cb17-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we graph the histogram of the sample with the theoretical
Beta(3,2) density superimposed.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>x<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.02</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="fu">hist</span>(x.sample<span class="fl">.2</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of x&quot;</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="fu">lines</span>(x<span class="fl">.2</span>, x<span class="fl">.2</span><span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="fl">.2</span>)<span class="sc">^</span>(b<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">gamma</span>(a<span class="sc">+</span>b)<span class="sc">/</span>(<span class="fu">gamma</span>(a)<span class="sc">*</span><span class="fu">gamma</span>(b)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we conclude that the distribution of samples roughly
fit the target distribution.</p>
</div>
<div id="exercise-3.9.-page-95-statistical-computing-with-r." class="section level3">
<h3>4. Exercise 3.9. (Page 95, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> The rescaled Epanechnikov kernel [85] is a
symmetric density function <span class="math display">\[f_e(x)=\frac{3}{4}(1-x^2),\quad|x|\leq1.\]</span>
Devroye and Gy¨orfi [71, p. 236] give the following algorithm for
simulation from this distribution. Generate iid <span class="math inline">\(U_1,U_2,U_3\ \sim\)</span>Uniform(−1, 1). If <span class="math inline">\(|U_3|\geq|U_2|\)</span> and <span class="math inline">\(|U_3|\geq|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span>, and construct
the histogram density estimate of a large simulated random sample.</p>
<p><strong>Solution.</strong> Note that <span class="math display">\[g(u_1,u_2,u_3)=u_2I_{(|u_3|\geq|u_1|\
\mathrm{and}\ |u_3|\geq|u_2|)}+u_3(1-I_{(|u_3|\geq|u_1|\ \mathrm{and}\
|u_3|\geq|u_2|)}).\]</span> And we generate function <span class="math inline">\(fe\)</span> according to the description of the
question.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>fe <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>    <span class="cf">if</span>((<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u2[i])) <span class="sc">&amp;&amp;</span> (<span class="fu">abs</span>(u3[i]) <span class="sc">&gt;=</span> <span class="fu">abs</span>(u1[i]))){</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> u2[i]</span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>    }<span class="cf">else</span> x[i] <span class="ot">&lt;-</span> u3[i]</span>
<span id="cb19-10"><a href="#cb19-10" tabindex="-1"></a>  }</span>
<span id="cb19-11"><a href="#cb19-11" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb19-12"><a href="#cb19-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we construct the histogram density estimate of a simulated
random sample of size 1000.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>x.sample<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">fe</span>(n)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>x<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="fu">hist</span>(x.sample<span class="fl">.3</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of x&quot;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="fu">lines</span>(x<span class="fl">.3</span>, (<span class="dv">1</span><span class="sc">-</span>x<span class="fl">.3</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we conclude that the distribution of samples roughly
fit the target distribution.</p>
</div>
<div id="exercise-3.10.-page-95-statistical-computing-with-r." class="section level3">
<h3>5. Exercise 3.10. (Page 95, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Prove that the algorithm given in Exercise
3.9 generates variates from the density <span class="math inline">\(f_e\)</span> (3.10).</p>
<p><strong>Proof.</strong> The density of <span class="math inline">\(U_1,U_2,U_3\)</span> is <span class="math inline">\(f_U(u)=\frac{1}{2}I_{(-1,1)}(u)\)</span>, and the
distribution function of them is <span class="math inline">\(F_U(u)=\frac{1}{2}(x+1)I_{(-1,1)}(u)\)</span>.
Because of the independence of <span class="math inline">\(U_1,U_2,U_3\)</span>, the joint density of <span class="math inline">\((U_1,U_2,U_3)\)</span> is <span class="math display">\[f_{(U_1,U_2,U_3)}(u_1,u_2,u_3)=f_U(u_1)f_U(u_2)f_U(u_3)=\frac{1}{8}\prod_{i=1}^3I_{(-1,1)}(u_i).\]</span></p>
<p>Note that <span class="math inline">\(f(x)\triangleq
f_{g(U_1,U_2,U_3)}(x)\)</span>. For <span class="math inline">\(x\in(-\infty,-1]\cup[1,+\infty)\)</span>, <span class="math inline">\(f(x)=0\)</span>. And for <span class="math inline">\(x\in(-1,1)\)</span>, <span class="math display">\[P(g(U_1,U_2,U_3)\leq x)=P(U_2\leq x,
g(U_1,U_2,U_3)=U_2)+P(U_3\leq x, g(U_1,U_2,U_3)=U_3).\]</span></p>
<p>For the first term, we have</p>
<p><span class="math display">\[\begin{equation*}
  \begin{aligned}
    &amp;P(U_2\leq x, g(U_1,U_2,U_3)=U_2)=P(U_2\leq
x,|U_3|\geq|U_2|,|U_3|\geq|U_1|)\\
    =&amp;\frac{1}{8}\int_{\mathbb{R}}I_{(-1,1)}(u_3)\left(\int_{-|u_3|}^{\min\{|u_3|,x\}}I_{(-1,1)}(u_2)du_2\right)\left(\int_{-|u_3|}^{|u_3|}I_{(-1,1)}(u_1)du_1\right)du_3\\
    =&amp;\frac{1}{4}\int_{-1}^1(\min\{|u_3|,x\}+|u_3|)|u_3|du_3=\frac{1}{2}\int_{0}^1(\min\{u_3,x\}+u_3)u_3du_3\\
    =&amp;\frac{1}{2}\int_{0}^x2u_3^2du_3+\frac{1}{2}\int_x^1(u_3+x)u_3du_3=\frac{1}{2}\int_0^xu_3^2du_3+\frac{1}{2}\int_0^1u_3^2du_3+\frac{x}{2}\int_x^1u_3du_3\\
    =&amp;\frac{1}{6}x^3+\frac{1}{6}+\frac{x}{4}(1-x^2)=-\frac{x^3}{12}+\frac{x}{4}+\frac{1}{6}.
  \end{aligned}
\end{equation*}\]</span></p>
<p>And for the second term, we have <span class="math display">\[\begin{equation*}
  \begin{aligned}
    &amp;P(U_3\leq x, g(U_1,U_2,U_3)=U_3)=P(U_3\leq x)-P(U_3\leq x,
g(U_1,U_2,U_3)=U_2)\\
    =&amp;P(U_3\leq x)-P(U_3\leq x,|U_3|\geq|U_2|,|U_3|\geq|U_1|)\\
    =&amp;\frac{x+1}{2}-\frac{1}{8}\int_{-\infty}^xI_{(-1,1)}(u_3)\left(\int_{-|u_3|}^{|u_3|}I_{(-1,1)}(u_2)du_2\right)\left(\int_{-|u_3|}^{|u_3|}I_{(-1,1)}(u_1)du_1\right)du_3\\
    =&amp;\frac{x+1}{2}-\frac{1}{2}\int_{-1}^x|u_3|^2du_3=\frac{x+1}{2}-\frac{1}{2}\int_0^1u_3^2du_3-\frac{1}{2}\int_0^xu_3^2du_3\\
    =&amp;\frac{x+1}{2}-\frac{1}{6}-\frac{x^3}{6}=-\frac{x^3}{6}+\frac{x}{2}+\frac{1}{3}.
  \end{aligned}
\end{equation*}\]</span></p>
<p>So we finally obtain that <span class="math display">\[P(g(U_1,U_2,U_3)\leq
x)=-\frac{x^3}{4}+\frac{3x}{4}+\frac{1}{2}.\]</span> And the density of
<span class="math inline">\(g(U_1,U_2,U_3)\)</span> is <span class="math display">\[f(x)=\frac{dP(g(U_1,U_2,U_3)\leq
x)}{dx}=-\frac{3x^2}{4}+\frac{3}{4}=\frac{3}{4}(1-x^2),\]</span> which
equals the target density <span class="math inline">\(f_e\)</span>.</p>
</div>
</div>
</div>
<div id="homework-2023.09.25" class="section level1">
<h1>Homework-2023.09.25</h1>
<div id="question-2" class="section level2">
<h2>Question</h2>
<div id="question-1.-1" class="section level3">
<h3>Question 1.</h3>
<ul>
<li><p>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>? (<span class="math inline">\(m\sim B(n,p)\)</span>, using <span class="math inline">\(\delta\)</span> method).</p></li>
<li><p>Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0\leq\rho\leq1\)</span>, including <span class="math inline">\(\rho_{\min}\)</span>) and use Monte Carlo
simulation to verify your answer. (<span class="math inline">\(n=10^6\)</span>, Number of repeated simulations
<span class="math inline">\(K=100\)</span>)</p></li>
</ul>
</div>
<div id="question-2.-1" class="section level3">
<h3>Question 2.</h3>
<p>Exercises 5.6, 5.7 (pages 149-151, Statistical Computing with R)</p>
</div>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="question-1.1." class="section level3">
<h3>Question 1.1.</h3>
<p><strong>Problem.</strong>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat{\pi}\)</span>? (<span class="math inline">\(m\sim B(n,p)\)</span>, using <span class="math inline">\(\delta\)</span> method).</p>
<p><strong>Proof.</strong> According to the definition of random
variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> we have known that <span class="math inline">\(X\sim U(0,\frac{d}{2})\)</span> and <span class="math inline">\(Y\sim U(0,\frac{\pi}{2})\)</span>. Then we obtain
the expectation and variance of the random variable <span class="math inline">\(I_{\left\{\frac{l}{2}\sin Y\geq
X\right\}}\)</span> that <span class="math display">\[p\triangleq\mathbb{E}\left[I_{\left\{\frac{l}{2}\sin
Y\geq X\right\}}\right]=\mathrm{P}\left(\frac{l}{2}\sin Y\geq
X\right)=\frac{2l}{d\pi}=\frac{2\rho}{\pi},\]</span> and <span class="math display">\[\begin{align*}
  \sigma^2\triangleq&amp;\mathrm{Var}\left(I_{\left\{\frac{l}{2}\sin
Y\geq
X\right\}}\right)=\mathbb{E}\left[\mathbb{E}\left[\left.(I_{\left\{\frac{l}{2}\sin
Y\geq X\right\}}-p)^2\right|Y\right]\right]\\
=&amp;\mathbb{E}\left[p^2\frac{2}{d}\left(\frac{d}{2}-\frac{l}{2}\sin
Y\right)+(1-p)^2\frac{2}{d}\cdot\frac{l}{2}\sin Y\right]\\
=&amp;p^2-p^2\frac{l}{d}\mathbb{E}[\sin
Y]+(1-p)^2\frac{l}{d}\mathbb{E}[\sin Y]\\
=&amp;p^2+(1-2p)\rho\mathbb{E}[\sin Y]=p^2+\frac{2}{\pi}(1-2p)\rho\\
=&amp;\frac{4\rho^2}{\pi^2}+\frac{2\rho}{\pi}\cdot\left(1-\frac{4\rho}{\pi}\right)=\frac{2\rho}{\pi}-\frac{4\rho^2}{\pi^2}.
\end{align*}\]</span> Combining the CLT with the definition of random
variable <span class="math inline">\(m\triangleq\sum_{i=1}^nI_{\left\{\frac{l}{2}\sin
Y_i\geq X_i\right\}}\sim B(n,p)\)</span>, we obtain that <span class="math display">\[\sqrt{n}\left(\frac{m}{n}-p\right)\xrightarrow[n\to\infty]{d}N(0,\sigma^2).\]</span></p>
<p>Because <span class="math inline">\(\frac{m}{n}=\frac{2l}{d\hat{\pi}}=\frac{2\rho}{\hat{\pi}}\)</span>,
we have <span class="math inline">\(\hat{\pi}=\frac{2n\rho}{m}\)</span>.
Define <span class="math inline">\(g(t)=\frac{2\rho}{t}\)</span>, then
<span class="math inline">\(g&#39;(t)=-\frac{2\rho}{t^2}\)</span>. And
from the <span class="math inline">\(\delta\)</span>-method we have
<span class="math display">\[\sqrt{n}\left(g\left(\frac{m}{n}\right)-g(p)\right)\xrightarrow[n\to\infty]{d}N(0,\left(g&#39;(p)\right)^2\sigma^2),\]</span>
which means that <span class="math display">\[\sqrt{n}(\hat{\pi}-\pi)\xrightarrow[n\to\infty]{d}
N(0,\tau^2),\]</span> where <span class="math display">\[\tau^2=\left(\frac{2\rho}{p^2}\right)^2\left(\frac{2\rho}{\pi}-\frac{4\rho^2}{\pi^2}\right)=\left(\frac{\pi^2}{2\rho}\right)^2\frac{2\rho}{\pi}\left(1-\frac{2\rho}{\pi}\right)=\frac{\pi^3}{2}\left(\frac{1}{\rho}-\frac{2}{\pi}\right).\]</span>
Because <span class="math inline">\(\tau^2\)</span> decreases with the
increase of <span class="math inline">\(\rho\in(0,1]\)</span>, we fine
that when <span class="math inline">\(\rho=\rho_{\min}=1\)</span> the
variance of <span class="math inline">\(\hat{\pi}\)</span> reaches its
minimum value <span class="math inline">\(\tau^2_{\min}=\frac{\pi^2(\pi-2)}{2\pi}\)</span>.</p>
</div>
<div id="question-1.2." class="section level3">
<h3>Question 1.2.</h3>
<p><strong>Problem.</strong> Take three different values of <span class="math inline">\(\rho\)</span> (<span class="math inline">\(0\leq\rho\leq1\)</span>, including <span class="math inline">\(\rho_{\min}\)</span>) and use Monte Carlo
simulation to verify your answer. (<span class="math inline">\(n=10^6\)</span>, Number of repeated simulations
<span class="math inline">\(K=100\)</span>)</p>
<p><strong>Solution.</strong> We firstly define the function to generate
<span class="math inline">\(\hat{\pi}\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>pihat <span class="ot">&lt;-</span> <span class="cf">function</span>(rho){</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>  d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  l <span class="ot">&lt;-</span> rho</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>  pi.hat <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>l<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>  <span class="fu">return</span>(pi.hat)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we take <span class="math inline">\(\rho=0.1,0.5,1\)</span> to
verify the answer in the previous question.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>pihat.sample <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(rho), <span class="at">ncol =</span> K)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co"># obtain pihat</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>pihat.sample[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(rho[<span class="dv">1</span>], <span class="at">times =</span> K), pihat)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>pihat.sample[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(rho[<span class="dv">2</span>], <span class="at">times =</span> K), pihat)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a>pihat.sample[<span class="dv">3</span>,] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(rho[<span class="dv">3</span>], <span class="at">times =</span> K), pihat)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="co"># calculate the standard deviation</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>pihat.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(pihat.sample, <span class="dv">1</span>, var)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">names</span>(pihat.var) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;rho=0.1&quot;</span>, <span class="st">&quot;rho=0.5&quot;</span>, <span class="st">&quot;rho=1&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="co">#knitr::kable(variance)</span></span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(pihat.var)</span></code></pre></div>
<table style="width:50%;">
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="16%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">rho=0.1</th>
<th align="center">rho=0.5</th>
<th align="center">rho=1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.0001611</td>
<td align="center">1.797e-05</td>
<td align="center">6.913e-06</td>
</tr>
</tbody>
</table>
<p>Comparing the variances of the three cases, we obtain that when <span class="math inline">\(\rho=1\)</span> the variance of <span class="math inline">\(\rho\)</span> reaches its minimum, which is
consistent with our previous conclusion.</p>
</div>
<div id="exercises-5.6.-pages-150-statistical-computing-with-r." class="section level3">
<h3>Exercises 5.6. (pages 150, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> In Example 5.7 the control variate approach
was illustrated for Monte Carlo integration of <span class="math display">\[\theta=\int_0^1e^xdx.\]</span> Now consider the
antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U,e^{1-U})\)</span>, where <span class="math inline">\(U\sim\)</span>Uniform(0,1). What is the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<p><strong>Solution.</strong> Because random variable <span class="math inline">\(e^U\)</span> and <span class="math inline">\(e^{1-U}\)</span> have the same distribution, we
have that <span class="math display">\[\mathbb{E}\left[e^{1-U}\right]=\mathbb{E}\left[e^U\right]=\int_0^1e^udu=e-1,\]</span>
and <span class="math display">\[\mathbb{E}\left[e^{2-2U}\right]=\mathbb{E}\left[e^{2U}\right]=\int_0^1e^{2u}du=\frac{1}{2}(e^2-1).\]</span>
So we obtain the covariance of <span class="math inline">\(e^U\)</span>
and <span class="math inline">\(e^{1-U}\)</span> that <span class="math display">\[Cov\left(e^U,e^{1-U}\right)=\mathbb{E}\left[e^U\cdot
e^{1-U}\right]-\mathbb{E}\left[e^U\right]\mathbb{E}\left[e^{1-U}\right]=e-(e-1)^2=-e^2+3e-1,\]</span>
as well as the variance of both of them that <span class="math display">\[Var\left(e^{1-U}\right)=Var\left(e^U\right)=\mathbb{E}\left[e^{2U}\right]-\mathbb{E}^2\left[e^U\right]=\frac{1}{2}(e^2-1)-(e-1)^2\\=\frac{1}{2}(e-1)(e+1-2e+2)=\frac{1}{2}(e-1)(3-e).\]</span>
We can also calculate that <span class="math display">\[=Var\left(e^U+e^{1-U}\right)=Var(e^U)+Var(e^{1-U})+2Cov(e^U,e^{1-U})\\
=(e-1)(3-e)+2(-e^2+3e-1)=-3e^2+10e-5.\]</span> From the computation</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="sc">-</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] -0.2342106</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>(<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">+</span><span class="dv">10</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">5</span>)<span class="sc">/</span><span class="dv">4</span></span></code></pre></div>
<pre><code>## [1] 0.003912497</code></pre>
<p>We have that <span class="math inline">\(Cov(e^U,e^{1-U})=-0.2342106\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})=0.003912497\)</span>.</p>
<p>We suppose random variable <span class="math inline">\(U,V\sim\)</span>Uniform(0,1) are identically
independent distributed and define <span class="math inline">\(\hat{\theta}_s=\frac{1}{2}(e^U+e^V)\)</span> is
the simple MC estimator and <span class="math inline">\(\hat{\theta}_a=\frac{1}{2}(e^U+e^{1-U})\)</span>
is the antithetic estimator. Then we have <span class="math display">\[Var(\hat{\theta}_s)=\frac{1}{4}Var\left(e^U+e^V\right)=\frac{1}{2}Var\left(e^U\right)=\frac{1}{4}(e-1)(3-e),\]</span>
and <span class="math display">\[Var(\hat{\theta}_a)=\frac{1}{4}Var\left(e^U+e^{1-U}\right)
=\frac{1}{4}\left((e-1)(3-e)+2(-e^2+3e-1)\right).\]</span> The percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates is <span class="math display">\[\frac{Var(\hat{\theta}_s)-Var(\hat{\theta}_a)}{Var(\hat{\theta}_s)}=\frac{2(e^2-3e+1)}{(e-1)(3-e)}.\]</span>
Now we calculate the number.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a>reduction.theoretical <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="fu">exp</span>(<span class="dv">2</span>)<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span><span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span>((<span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">3</span><span class="sc">-</span><span class="fu">exp</span>(<span class="dv">1</span>)))</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The theoretical percent reduction is&quot;</span>, reduction.theoretical, <span class="st">&quot;.&quot;</span> ,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## The theoretical percent reduction is 0.9676701 .</code></pre>
</div>
<div id="exercise-5.7.-pages-150-statistical-computing-with-r." class="section level3">
<h3>Exercise 5.7. (pages 150, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Refer to Exercise 5.6. Use a Monte Carlo
simulation to estimate <span class="math inline">\(\theta\)</span> by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<p><strong>Solution. </strong> We firstly use the MC method with samples
<span class="math inline">\(n=10000\)</span> to generate <span class="math inline">\(\hat{\theta}_s\)</span> and <span class="math inline">\(\hat{\theta}_a\)</span> and the number of repeated
simulations <span class="math inline">\(K=1000\)</span>).</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>MC_s <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(<span class="fu">runif</span>(n))))</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>}</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>MC_a <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>  v <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span>u</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">exp</span>(u)<span class="sc">+</span><span class="fu">exp</span>(v))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>theta_s <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(n,<span class="at">times =</span> K), MC_s)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>theta_a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">rep</span>(n,<span class="at">times =</span> K), MC_a)</span></code></pre></div>
<p>Then we compute the empirical estimate of the percent reduction in
variance using the antithetic variate.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>var_s <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_s)</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>var_a <span class="ot">&lt;-</span> <span class="fu">var</span>(theta_a)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>reduction.empirical <span class="ot">&lt;-</span> (var_s<span class="sc">-</span>var_a)<span class="sc">/</span>var_s</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The empirical percent reduction is&quot;</span>,reduction.empirical, <span class="st">&quot;.&quot;</span> ,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## The empirical percent reduction is 0.9675289 .</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>reduction <span class="ot">&lt;-</span> <span class="fu">c</span>(reduction.theoretical, reduction.empirical)</span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a><span class="fu">names</span>(reduction) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;theoretical&quot;</span>, <span class="st">&quot;empirical&quot;</span>)</span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(reduction)</span></code></pre></div>
<table style="width:39%;">
<colgroup>
<col width="19%" />
<col width="19%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">theoretical</th>
<th align="center">empirical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.9677</td>
<td align="center">0.9675</td>
</tr>
</tbody>
</table>
<p>In conclusion, the empirical result is close to the theoretical
value.</p>
</div>
</div>
</div>
<div id="homework-2023.10.09" class="section level1">
<h1>Homework-2023.10.09</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<div id="question-1.-2" class="section level3">
<h3>Question 1.</h3>
<p><span class="math inline">\(Var(\hat{\theta}^M)=\frac{1}{Mk}\sum_{i=1}^k\sigma_i^2+Var(\theta_I)=Var(\hat{\theta}^S)+Var(\theta_I)\)</span>,
where <span class="math inline">\(\theta_i=E[g(U)|I=i]\)</span>, <span class="math inline">\(\sigma_i^2=Var(g(U)|I=i)\)</span> and <span class="math inline">\(I\)</span> takes uniform distribution over <span class="math inline">\(\{1,\dots,k\}\)</span>.</p>
<p>Proof that if <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a, b)\)</span>, then <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}^M)\to0\)</span>
as <span class="math inline">\(b_i-a_i\to0\)</span> for all <span class="math inline">\(i=1,\dots,k\)</span>.</p>
</div>
<div id="question-2.-2" class="section level3">
<h3>Question 2.</h3>
<ul>
<li><p>Exercises 5.13, 5.14, 5.15 (pages 149-151, Statistical Computing
with R).</p></li>
<li><p>Exercises 6.5, 6.A (pages 180-181, Statistical Computing with
R).</p></li>
</ul>
</div>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="question-1.-3" class="section level3">
<h3>Question 1.</h3>
<p><strong>Proof.</strong> For <span class="math inline">\(i=1,\dots,k\)</span>, when <span class="math inline">\(I=i\)</span>, <span class="math inline">\(U\sim\)</span>Uniform<span class="math inline">\((a_i,b_i)\)</span>. So we have that <span class="math display">\[\theta_i=\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g(u)du,\quad
\sigma_i^2=\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g^2(u)du-\theta_i^2.\]</span>
Then we obtain that <span class="math display">\[Var(\hat{\theta}^S)=\frac{1}{Mk}\sum_{i=1}^k\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g^2(u)du-\frac{1}{Mk}\sum_{i=1}^k\theta_i^2,\]</span>
and <span class="math display">\[Var(\theta_I)=\frac{1}{k}\sum_{i=1}^k\theta_i^2-\left(\frac{1}{k}\sum_{i=1}^k\theta_i\right)^2.\]</span></p>
<p>Because <span class="math inline">\(g\)</span> is a continuous
function over <span class="math inline">\((a, b)\)</span>, from the
first mean value theorem for integration, there exists <span class="math inline">\(x_i,y_i\in[a_i,b_i]\)</span> which satisfies that
<span class="math display">\[\theta_i=\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g(u)du=g(x_i),\quad
\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g^2(u)du=g^2(y_i).\]</span> Because
<span class="math inline">\((b_i-a_i)=0,\forall i=1,\dots,k\)</span>,
from the definition of Riemann Integration, we obtain that as <span class="math inline">\((b_i-a_i)=0,\forall i=1,\dots,k\)</span>, <span class="math display">\[\frac{1}{k}\sum_{i=1}^k\theta_i\xrightarrow{}\int_{a}^bg(u)du,\
\frac{1}{k}\sum_{i=1}^k\theta_i^2\xrightarrow{}\int_{a}^bg^2(u)du,\]</span>
and <span class="math display">\[\frac{1}{k}\sum_{i=1}^k\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g^2(u)du\xrightarrow{}\int_{a}^bg^2(u)du.\]</span></p>
<p>So we have <span class="math display">\[Var(\hat{\theta}^S)=\frac{1}{Mk}\sum_{i=1}^k\frac{1}{b_i-a_i}\int_{a_i}^{b_i}g^2(u)du-\frac{1}{Mk}\sum_{i=1}^k\theta_i^2\xrightarrow{}\frac{1}{M}\left(\int_{a}^bg^2(u)du-\int_{a}^bg^2(u)du\right)=0,\]</span>
and <span class="math display">\[Var(\theta_I)=\frac{1}{k}\sum_{i=1}^k\theta_i^2-\left(\frac{1}{k}\sum_{i=1}^k\theta_i\right)^2\xrightarrow{}\int_{a}^bg^2(u)du-\left(\int_{a}^bg(u)du\right)^2\geq0,\]</span>
as <span class="math inline">\((b_i-a_i)=0,\forall
i=1,\dots,k\)</span>.</p>
<p>If <span class="math inline">\(g(u)\equiv C\)</span>, where <span class="math inline">\(C\)</span> is any constant on <span class="math inline">\(\mathbb{R}\)</span>, we have that <span class="math display">\[Var(\hat{\theta}^S)=\frac{C^2}{M}-\frac{C^2}{M}=0,\
Var(\theta_I)=C^2-C^2=0,\]</span> So <span class="math display">\[Var(\hat{\theta}^M)=Var(\hat{\theta}^S)+Var(\theta_I)=0.\]</span>
Then <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}^M)\)</span>
is not exist.</p>
<p>If <span class="math inline">\(g(u)\)</span> is not identical to a
constant, <span class="math inline">\(\int_{a}^bg^2(u)du-\left(\int_{a}^bg(u)du\right)^2&gt;0\)</span>.
Then we have that as <span class="math inline">\((b_i-a_i)=0,\forall
i=1,\dots,k\)</span>, <span class="math display">\[\frac{Var(\hat{\theta}^S)}{Var(\hat{\theta}^M)}=\frac{Var(\hat{\theta}^S)}{Var(\hat{\theta}^S)+Var(\theta_I)}\xrightarrow{}\frac{0}{\int_{a}^bg^2(u)du-\left(\int_{a}^bg(u)du\right)^2}=0.\]</span></p>
</div>
<div id="exercises-5.13.-pages-151-statistical-computing-with-r." class="section level3">
<h3>Exercises 5.13. (pages 151, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\
x&gt;1.\]</span> Which of your two importance functions should produce
the smaller variance in estimating <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span>
by importance sampling? Explain.</p>
<p><strong>Solution.</strong> We suppose the first importance function
is the density of standard normal distribution <span class="math inline">\(N(0,1)\)</span> that <span class="math display">\[f_1(x)=\frac{1}{\sqrt{2\pi}}e^{-\frac{x^2}{2}},\]</span>
and the second important function is the density of Gamma distribution
<span class="math inline">\(\Gamma(\lambda,a)\)</span> with <span class="math inline">\(\lambda=1,a=3\)</span> that <span class="math display">\[f_2(x)=\frac{\lambda^a}{\Gamma(a)}x^{a-1}e^{-\lambda
x}I_{(x&gt;0)}=\frac{1}{\Gamma(3)}x^2e^{-x}I_{(x&gt;0)}=\frac{1}{2}x^2e^{-x}I_{(x&gt;0)}.\]</span></p>
<p>Firstly we display the figure of <span class="math inline">\(g(x),
f_1(x), f_2(x)\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">3</span>, <span class="at">rate =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">8</span>, <span class="fl">0.01</span>)</span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Figure of g(x), f1(x), f2(x)&quot;</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f1</span>(x), <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(<span class="fu">g</span>(x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)), <span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)), <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span><span class="dv">2</span>)), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we find that the two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> are ‘close’ to <span class="math inline">\(g(x)\)</span> on <span class="math inline">\((1,\infty)\)</span>.</p>
<p>In order to discuss which of the two importance functions should
produce the smaller variance, we display the figure of <span class="math inline">\(g(x)/f_1(x)\)</span> and <span class="math inline">\(g(x)/f_2(x)\)</span> to compare the rates of <span class="math inline">\(g(x)/f(x)\)</span>.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="fl">0.01</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Figure of g(x)/f1(x) and g(x)/f2(x)&quot;</span>)</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x), <span class="at">lty =</span> <span class="dv">3</span>)</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">expression</span>(f[<span class="dv">1</span>](x)<span class="sc">==</span>e<span class="sc">^</span>{<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>}<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)), <span class="fu">expression</span>(f[<span class="dv">2</span>](x)<span class="sc">==</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>e<span class="sc">^</span>{<span class="sc">-</span>x}<span class="sc">/</span><span class="dv">2</span>)), <span class="at">lty =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>From the figure we conclude that <span class="math inline">\(g(x)/f_1(x)\)</span> tends to infinity fast, and
<span class="math inline">\(g(x)/f_2(x)\)</span> tends to 0 slowly. So
<span class="math inline">\(g(x)/f_2(x)\)</span> is more close to a
constant and <span class="math inline">\(f_2\)</span> performs better
than <span class="math inline">\(f_1\)</span> in the importance sampling
procedure.</p>
</div>
<div id="exercises-5.14.-pages-151-statistical-computing-with-r." class="section level3">
<h3>Exercises 5.14. (pages 151, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Obtain a Monte Carlo estimate of <span class="math display">\[\int_1^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-\frac{x^2}{2}}dx\]</span>
by importance sampling.</p>
<p><strong>Solution.</strong> We use importance sampling to calculate
the integration in the case that the importance functions are <span class="math inline">\(f_1(x)\)</span> and <span class="math inline">\(f_2(x)\)</span> respectively.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> sd.theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a><span class="co"># the importance function is f1</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>sd.theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f1</span>(x))</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a><span class="co"># the importance function is f2</span></span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(m,<span class="at">shape =</span> <span class="dv">3</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x))</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>sd.theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sd</span>(<span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f2</span>(x))</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a><span class="co"># result reporting</span></span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, sd.theta.hat)</span></code></pre></div>
<pre><code>##                   [,1]      [,2]
## theta.hat    0.4098941 0.4010703
## sd.theta.hat 1.1245829 0.4569034</code></pre>
<p>The simulation indicates that <span class="math inline">\(f_2\)</span> produce smaller variance than <span class="math inline">\(f_1\)</span>, which is consistent with our
conclusion of the last question. So we take the importance function
<span class="math inline">\(f=f_2\)</span> and get an estimate of <span class="math inline">\(\hat{\theta}=0.401\)</span>.</p>
</div>
<div id="exercises-5.15.-pages-151-statistical-computing-with-r." class="section level3">
<h3>Exercises 5.15. (pages 151, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Obtain the stratified importance sampling
estimate in Example 5.13 and compare it with the result of Example
5.10.</p>
<p><strong>Solution.</strong> In Example 5.10 our best result was
obtained with importance function <span class="math inline">\(f(x)=e^{-x}/(1-e^{-1}),0&lt;x&lt;1\)</span>.From
10000 replicates we obtained the estimate <span class="math inline">\(\hat{\theta}=0.5257801\)</span> and an estimated
standard error <span class="math inline">\(0.0970314\)</span>. Now
divide the interval to five subintervals, <span class="math inline">\((j/5,(j+1)/5),j=0,1,\dots,4\)</span>. Then on the
<span class="math inline">\(j^{th}\)</span> subinterval variables are
generated from the density <span class="math display">\[f_j(x)=\frac{5e^{-x}}{1-e^{-1}}\cdot
I_{\left(F^{-1}(\frac{j-1}{5})&lt;x&lt;F^{-1}(\frac{j}{5})\right)},\]</span>
where <span class="math inline">\(F^{-1}(x)=-\log(1-(1-e^{-1})t)\)</span>, for <span class="math inline">\(j=1,\dots,5\)</span>.</p>
<p>We suppose <span class="math inline">\(U_j\sim\)</span>Uniform<span class="math inline">\(\left(\frac{j-1}{5},\frac{j}{5}\right),j=1,\dots,5\)</span>
and <span class="math inline">\(\int_{0}^{X_j}\frac{e^{-t}}{1-e^{-1}}dt=\frac{1-e^{-X}}{1-e^{-1}}=U_j\Leftrightarrow
X_j=-\log(1-(1-e^{-1})U_j)\)</span>. Then <span class="math inline">\(X_j\)</span> have the density <span class="math inline">\(f_j(x)\)</span>.</p>
<p>First we get the estimate from importance sampling method.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">exp</span>(<span class="sc">-</span>x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">*</span>(x<span class="sc">&lt;</span><span class="dv">1</span>)</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> sd.theta.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># data generation and analysis</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a>fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a>theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>sd.theta.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span><span class="fu">sd</span>(fg)</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a><span class="co"># result reporting</span></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a><span class="fu">c</span>(theta.hat[<span class="dv">1</span>], sd.theta.hat[<span class="dv">1</span>])</span></code></pre></div>
<pre><code>## [1] 0.52433470 0.09786775</code></pre>
<p>So we have <span class="math inline">\(\hat{\theta}=0.52433470\)</span> and <span class="math inline">\(se(\hat{\theta})=0.09786775\)</span>. Then we use
transformation method to implement stratified importance sampling.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># number of subintervals</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>r <span class="ot">&lt;-</span> M<span class="sc">/</span>k <span class="co"># replicates per stratum</span></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>theta.hat_s <span class="ot">&lt;-</span> var_s <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a><span class="co"># data generation and analysis</span></span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(r,(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>,j<span class="sc">/</span><span class="dv">5</span>)</span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">1</span>))<span class="sc">*</span>u)</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  fg <span class="ot">&lt;-</span> <span class="fu">g</span>(x)<span class="sc">/</span>k<span class="sc">/</span><span class="fu">f</span>(x)</span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  theta.hat_s[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(fg)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  var_s[j] <span class="ot">&lt;-</span> <span class="fu">var</span>(fg)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>}</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sum</span>(theta.hat_s)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>sd.theta.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(var_s))</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a><span class="co"># result reporting</span></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a><span class="fu">c</span>(theta.hat[<span class="dv">2</span>], sd.theta.hat[<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## [1] 0.524688376 0.009383897</code></pre>
<p>So we have <span class="math inline">\(\hat{\theta}=0.524688376\)</span> and <span class="math inline">\(se(\hat{\theta})=0.009383897\)</span>.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">rbind</span>(theta.hat, sd.theta.hat)</span></code></pre></div>
<pre><code>##                    [,1]        [,2]
## theta.hat    0.52433470 0.524688376
## sd.theta.hat 0.09786775 0.009383897</code></pre>
<p>Comparing the sample standard error of the estimate, we can find that
the stratified sampling method can effectively reduce variance.</p>
</div>
<div id="exercises-6.5.-pages-180-statistical-computing-with-r." class="section level3">
<h3>Exercises 6.5. (pages 180, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Suppose a 95% symmetric t-interval is
applied to estimate a mean, but the sample data are non-normal. Then the
probability that the confidence interval covers the mean is not
necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the
coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results
with the simulation results in Example 6.4. (The t-interval should be
more robust to departures from normality than the interval for
variance.)</p>
<p><strong>Solution.</strong> Firstly we use a Monte Carlo experiment to
estimate the coverage probability of the t-interval for random samples
of <span class="math inline">\(\chi^2(2)\)</span> data with sample size
<span class="math inline">\(n = 20\)</span>.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>  t0 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span>  <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">mean</span>(x) <span class="sc">+</span> t0 <span class="sc">*</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>  <span class="fu">return</span>(ci)</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, <span class="at">expr =</span> <span class="fu">mc</span>(n))</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>LCL <span class="ot">&lt;-</span> CI[<span class="dv">1</span>, ]</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> CI[<span class="dv">2</span>, ]</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(LCL), <span class="fu">mean</span>(UCL))</span></code></pre></div>
<pre><code>## [1] 1.101527 2.892489</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">mean</span>(LCL <span class="sc">&lt;</span> <span class="dv">2</span> <span class="sc">&amp;</span> UCL <span class="sc">&gt;</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.9133</code></pre>
<p>Then from Example 6.6 we estimate the coverage probability of the
interval for variance for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>UCL <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  (n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">var</span>(x) <span class="sc">/</span> <span class="fu">qchisq</span>(alpha, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>} )</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="fu">mean</span>(UCL)</span></code></pre></div>
<pre><code>## [1] 7.47435</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="fu">mean</span>(UCL<span class="sc">&gt;</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## [1] 0.797</code></pre>
<p>Because 0.9133 &gt; 0.797, we conclude that the t-interval should be
more robust to departures from normality than the interval for
variance.</p>
</div>
<div id="exercises-6.a.-pages-181-statistical-computing-with-r." class="section level3">
<h3>Exercises 6.A. (pages 181, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Use Monte Carlo simulation to investigate
whether the empirical Type I error rate of the t-test is approximately
equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is
non-normal. The t-test is robust to mild departures from normality.
Discuss the simulation results for the cases where the sampled
population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii)
Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0:\mu=\mu_0\)</span> vs <span class="math inline">\(H_1:\mu\neq\mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and
Exponential(1), respectively.</p>
<p><strong>Solution.</strong> For the three cases, we calculate the
<span class="math inline">\(\hat{P}(p\leq\alpha)\)</span> and <span class="math inline">\(se(\hat{P}(p\leq\alpha))\)</span>
respectively.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co">#number of replicates</span></span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> m) <span class="co">#storage for p-values</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>p.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>se.p.hat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">3</span>)</span></code></pre></div>
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(X\sim\chi^2(1)\)</span>, then <span class="math inline">\(\mu_0=E(X)=1\)</span>.</li>
</ol>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  p[<span class="dv">1</span>,j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>}</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>p.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p[<span class="dv">1</span>,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>se.p.hat[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat[<span class="dv">1</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat[<span class="dv">1</span>]) <span class="sc">/</span> m)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat[<span class="dv">1</span>], se.p.hat[<span class="dv">1</span>]))</span></code></pre></div>
<pre><code>## [1] 0.100400000 0.003005326</code></pre>
<ol start="2" style="list-style-type: lower-roman">
<li><span class="math inline">\(X\sim\)</span>Uniform(0,2), then <span class="math inline">\(\mu_0=E(X)=\frac{1}{2}\int_0^2xdx=\frac{4}{4}=1\)</span>.</li>
</ol>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>  p[<span class="dv">2</span>,j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>}</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>p.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p[<span class="dv">2</span>,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>se.p.hat[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat[<span class="dv">2</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat[<span class="dv">2</span>]) <span class="sc">/</span> m)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat[<span class="dv">2</span>], se.p.hat[<span class="dv">2</span>]))</span></code></pre></div>
<pre><code>## [1] 0.050200000 0.002183574</code></pre>
<ol start="3" style="list-style-type: lower-roman">
<li><span class="math inline">\(X\sim\)</span>Exponential(1), then <span class="math inline">\(\mu_0=E(x)=\int_0^{\infty}xe^{-x}dx=1\)</span>.</li>
</ol>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>mu0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  ttest <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">mu =</span> mu0)</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  p[<span class="dv">3</span>,j] <span class="ot">&lt;-</span> ttest<span class="sc">$</span>p.value</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>}</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>p.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(p[<span class="dv">3</span>,] <span class="sc">&lt;</span> alpha)</span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>se.p.hat[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p.hat[<span class="dv">3</span>] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p.hat[<span class="dv">3</span>]) <span class="sc">/</span> m)</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(p.hat[<span class="dv">3</span>], se.p.hat[<span class="dv">3</span>]))</span></code></pre></div>
<pre><code>## [1] 0.08120000 0.00273142</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">rbind</span>(p.hat, se.p.hat)</span></code></pre></div>
<pre><code>##                 [,1]        [,2]       [,3]
## p.hat    0.100400000 0.050200000 0.08120000
## se.p.hat 0.003005326 0.002183574 0.00273142</code></pre>
<p>We find that the empirical Type I error rate of the t-test is
approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span> in case (ii), but is not in case
(i) and (iii). Because Uniform(0,2) is more slightly deviates from the
normal distribution than <span class="math inline">\(\chi^2(1)\)</span>
and Exponential(1) as shown in the following figure.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.01</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col =</span> <span class="dv">1</span>)</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">2</span>), <span class="at">lty =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="dv">3</span>)</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="fu">dexp</span>(x, <span class="at">rate =</span> <span class="dv">1</span>), <span class="at">lty =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="dv">4</span>)</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">inset =</span> <span class="fl">0.02</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;N(0,1)&quot;</span>, <span class="st">&quot;Chisq(1)&quot;</span>, <span class="st">&quot;Uniform(0,2)&quot;</span>, <span class="st">&quot;Exponential(1)&quot;</span>), <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">col =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-2023.10.16" class="section level1">
<h1>Homework-2023.10.16</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<div id="question-1.-4" class="section level3">
<h3>Question 1.</h3>
<p>考虑<span class="math inline">\(m=1000\)</span>个假设，其中前95%个原假设成立，后5%个对立假设成立。在原假设之下，p-值服从U(0,1)分布，在对立假设之下，p-值服从Beta(0.1,
1)分布（可用rbeta生成）。应用Bonferroni矫正与B-H矫正应用于生成的<span class="math inline">\(m\)</span>个p-值(独立)(应用p.adjust)，得到校正后的p-值，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设。基于<span class="math inline">\(M=1000\)</span>次模拟，可估计FWER, FDR,
TPR输出到表格中：</p>
<table>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">FWER</th>
<th align="center">FDR</th>
<th align="center">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Bonf</td>
<td align="center"><span class="math inline">\(\approx\)</span> 0.1</td>
<td align="center"><span class="math inline">\(\ll\)</span> 0.1</td>
<td align="center">?</td>
</tr>
<tr class="even">
<td align="center">B-H</td>
<td align="center"><span class="math inline">\(\gg\)</span> 0.1</td>
<td align="center"><span class="math inline">\(\approx\)</span> 0.1</td>
<td align="center">??</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2.-3" class="section level3">
<h3>Question 2.</h3>
<p>Homework</p>
<ul>
<li>Suppose the population has the exponential distribution with rate
<span class="math inline">\(\lambda\)</span>, then the MLE of <span class="math inline">\(\lambda\)</span> is <span class="math inline">\(\hat\lambda=1/\bar X\)</span>, where <span class="math inline">\(\bar X\)</span> is the sample mean. It can be
derived that the expectation of <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/(n-1)\)</span>, so that the estimation
bias is <span class="math inline">\(\lambda/(n-1)\)</span>. The standard
error <span class="math inline">\(\hat\lambda\)</span> is <span class="math inline">\(\lambda n/[(n-1)\sqrt{n-2}]\)</span>. Conduct a
simulation study to verify the performance of the bootstrap method.</li>
<li>The true value of <span class="math inline">\(\lambda=2\)</span>.</li>
<li>The sample size <span class="math inline">\(n=5,10,20\)</span>.</li>
<li>The number of bootstrap replicates <span class="math inline">\(B =
1000\)</span>.</li>
<li>The simulations are repeated for <span class="math inline">\(m=1000\)</span> times.</li>
<li>Compare the mean bootstrap bias and bootstrap standard error with
the theoretical ones. Comment on the results.</li>
</ul>
</div>
<div id="question-3." class="section level3">
<h3>Question 3.</h3>
<p>Exercises 7.3 (pages 212, Statistical Computing with R).</p>
</div>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="question-1.-5" class="section level3">
<h3>Question 1.</h3>
<p><strong>Solution.</strong> We define the function “adjust” to
generate and adjust the p-values as well as calculate FWER, FDR and
TPR.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>adjust <span class="ot">&lt;-</span> <span class="cf">function</span>(m, alpha){</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>  m0 <span class="ot">&lt;-</span> m<span class="sc">*</span><span class="fl">0.95</span></span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> m <span class="sc">-</span> m0</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  </span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  <span class="co"># generate p-values</span></span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>  p0 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m0)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m1, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p0, p1)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  </span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  <span class="co"># adjust p-values</span></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>  p.adj_bonf <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;bonferroni&#39;</span>)</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>  p.adj_BH <span class="ot">=</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&#39;BH&#39;</span>)</span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>  </span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>  <span class="co"># calculate FWER, FDR and TPR</span></span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>  FWER_bonf <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">prod</span>(p.adj_bonf[<span class="dv">1</span><span class="sc">:</span>m0] <span class="sc">&gt;=</span> alpha)</span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>  FWER_BH <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">prod</span>(p.adj_BH[<span class="dv">1</span><span class="sc">:</span>m0] <span class="sc">&gt;=</span> alpha)</span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>  FDR_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_bonf[<span class="dv">1</span><span class="sc">:</span>m0] <span class="sc">&lt;</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(p.adj_bonf <span class="sc">&lt;</span> alpha)</span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>  FDR_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_BH[<span class="dv">1</span><span class="sc">:</span>m0] <span class="sc">&lt;</span> alpha) <span class="sc">/</span> <span class="fu">sum</span>(p.adj_BH <span class="sc">&lt;</span> alpha)</span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a>  TPR_bonf <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_bonf[m0<span class="sc">:</span>m] <span class="sc">&lt;</span> alpha) <span class="sc">/</span> m1</span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>  TPR_BH <span class="ot">&lt;-</span> <span class="fu">sum</span>(p.adj_BH[m0<span class="sc">:</span>m] <span class="sc">&lt;</span> alpha) <span class="sc">/</span> m1</span>
<span id="cb67-21"><a href="#cb67-21" tabindex="-1"></a>  </span>
<span id="cb67-22"><a href="#cb67-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(FWER_bonf, FWER_BH, FDR_bonf, FDR_BH, TPR_bonf, TPR_BH))</span>
<span id="cb67-23"><a href="#cb67-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we obtain the estimates of FWER, FDR and TPR from <span class="math inline">\(M=1000\)</span> simulations.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> M, <span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>  rate[i,] <span class="ot">&lt;-</span> <span class="fu">adjust</span>(m, alpha)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>}</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">apply</span>(rate, <span class="dv">2</span>, mean), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>estimate <span class="ot">&lt;-</span> <span class="fu">round</span>(estimate, <span class="dv">3</span>)</span>
<span id="cb69-2"><a href="#cb69-2" tabindex="-1"></a><span class="fu">colnames</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb69-3"><a href="#cb69-3" tabindex="-1"></a><span class="fu">rownames</span>(estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonf&quot;</span>, <span class="st">&quot;B-H&quot;</span>)</span>
<span id="cb69-4"><a href="#cb69-4" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(estimate)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">FWER</th>
<th align="right">FDR</th>
<th align="right">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bonf</td>
<td align="right">0.094</td>
<td align="right">0.005</td>
<td align="right">0.398</td>
</tr>
<tr class="even">
<td align="left">B-H</td>
<td align="right">0.933</td>
<td align="right">0.096</td>
<td align="right">0.565</td>
</tr>
</tbody>
</table>
<p>From the table we find that the estimats of FWER from Bonferroni
correction and FDR from B-H correction are both close to 0.1, the
estimat of FWER from B-H correction is far greater than 0.1, the estimat
of FDR from Bonferroni correction is far smaller that 0.1 and the
estimats of TPR from Bonferroni correction is smaller than that from B-H
correction.</p>
</div>
<div id="question-2.-4" class="section level3">
<h3>Question 2.</h3>
<p><strong>Solution.</strong> We calculate the mean bias and standard
error of <span class="math inline">\(\hat{\theta}^*\)</span> to estimate
the mean bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co">#true value</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>) <span class="co">#sample size</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#bootstrap replicates</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#simulations</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>lambda.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>bias.estimate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>se.estimate <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n[i], <span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>    lambda.hat <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>    <span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>      xstar <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>      lambda.star[b] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xstar)</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>    }</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>    bias.estimate[j,i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(lambda.star)<span class="sc">-</span>lambda.hat</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>    se.estimate[j,i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(lambda.star)</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>  }</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>bias.theta.hat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">apply</span>(bias.estimate, <span class="dv">2</span>, mean), lambda<span class="sc">/</span>(n<span class="dv">-1</span>))</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>se.theta.hat <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">apply</span>(se.estimate, <span class="dv">2</span>, mean), lambda<span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>))</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a><span class="fu">colnames</span>(bias.theta.hat) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(se.theta.hat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;n=5&quot;</span>, <span class="st">&quot;n=10&quot;</span>, <span class="st">&quot;n=20&quot;</span>)</span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="fu">rownames</span>(bias.theta.hat) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(se.theta.hat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;estimate&quot;</span>, <span class="st">&quot;theoretical&quot;</span>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(bias.theta.hat)</span></code></pre></div>
<table style="width:62%;">
<colgroup>
<col width="25%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">n=5</th>
<th align="center">n=10</th>
<th align="center">n=20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>estimate</strong></td>
<td align="center">0.5637</td>
<td align="center">0.2258</td>
<td align="center">0.1031</td>
</tr>
<tr class="even">
<td align="center"><strong>theoretical</strong></td>
<td align="center">0.5</td>
<td align="center">0.2222</td>
<td align="center">0.1053</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(se.theta.hat)</span></code></pre></div>
<table style="width:61%;">
<colgroup>
<col width="25%" />
<col width="11%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">n=5</th>
<th align="center">n=10</th>
<th align="center">n=20</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>estimate</strong></td>
<td align="center">2.074</td>
<td align="center">0.8444</td>
<td align="center">0.5005</td>
</tr>
<tr class="even">
<td align="center"><strong>theoretical</strong></td>
<td align="center">1.443</td>
<td align="center">0.7857</td>
<td align="center">0.4962</td>
</tr>
</tbody>
</table>
<p>From the tables of the mean bootstrap bias and bootstrap standard
error compared with the theoretical ones, we find that the estimates
approximate the theoretical ones as the sample size increases.</p>
</div>
<div id="exercises-7.3.-pages-212-statistical-computing-with-r." class="section level3">
<h3>Exercises 7.3. (pages 212, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Obtain a bootstrap t confidence interval
estimate for the correlation statistic in Example 7.2 (law data in
bootstrap).</p>
<p><strong>Solution.</strong> The studentized bootstrap CI is <span class="math display">\[\left(\hat{\theta}-t_{1-\alpha/2}^*\hat{se}(\hat{\theta}),\hat{\theta}-t_{\alpha/2}^*\hat{se}(\hat{\theta})\right).\]</span>
We use bootstrap method to estimate <span class="math inline">\(t_a\)</span> which is the sample a-quantile of
<span class="math inline">\((\hat{\theta}^{(b)}-\hat{\theta})/\hat{se}(\hat{\theta}^{(b)})\)</span>,
where <span class="math inline">\(\hat{se}(\hat{\theta}^{(b)})\)</span>
involves the second order resampling.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> bootstrap<span class="sc">::</span>law</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(d)</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(d)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>B <span class="ot">&lt;-</span>  <span class="dv">1000</span> <span class="co">#bootstrap replicates for t</span></span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>R <span class="ot">&lt;-</span>  <span class="dv">25</span> <span class="co">#bootstrap replicates for se</span></span>
<span id="cb74-7"><a href="#cb74-7" tabindex="-1"></a>level <span class="ot">&lt;-</span>  <span class="fl">0.95</span></span>
<span id="cb74-8"><a href="#cb74-8" tabindex="-1"></a>stat.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb74-9"><a href="#cb74-9" tabindex="-1"></a>se.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>b.cor <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">i =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(x)) <span class="fu">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>])</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, statistic) {</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>    i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>    <span class="fu">statistic</span>(x[i, ])</span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>  })</span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  xstar <span class="ot">&lt;-</span> d[j, ]</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  stat.star[b] <span class="ot">&lt;-</span> <span class="fu">b.cor</span>(xstar)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>  se.star[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(xstar, <span class="at">R =</span> R, <span class="at">statistic =</span> b.cor)</span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a><span class="co">#  se[b] &lt;- sd(boot(xstar, R = R, statistic = b.cor)$t)</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>}</span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>stat.hat <span class="ot">&lt;-</span> <span class="fu">b.cor</span>(d)</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>t.stats <span class="ot">&lt;-</span> (stat.star <span class="sc">-</span> stat.hat)<span class="sc">/</span>se.star</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>se.hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat.star)</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a><span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat.hat <span class="sc">-</span> Qt <span class="sc">*</span> se.hat)</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>CI</span></code></pre></div>
<pre><code>##      2.5%     97.5% 
## -0.269613  1.004899</code></pre>
</div>
</div>
</div>
<div id="homework-2023.10.23" class="section level1">
<h1>Homework-2023.10.23</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercises 7.5 7.8 7.11 (pages 212-213, Statistical Computing with
R).</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.5.-page-212-statistical-computing-with-r" class="section level3">
<h3>Exercise 7.5. (page 212, Statistical Computing with R)</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.4. Compute 95%
bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ.</p>
<p><strong>Solution.</strong> From Exercise 7.4. we know that the 12
observations in data set <strong>aircondit</strong> are the times in
hours between failures of air-conditioning equipment, and we assume that
the times between failures follow an exponential model Exp(λ). If <span class="math inline">\(X\sim\)</span>Exp(<span class="math inline">\(\lambda\)</span>), we obtain that <span class="math inline">\(E(X)=\frac{1}{\lambda}\)</span>. So the estimate
<span class="math inline">\(\hat{\left(\frac{1}{\lambda}\right)}=\bar{X}\)</span>.</p>
<p>We firstly use the function “boot” and “boot.ci” to obtain the 95%
bootstrap confidence intervals by the standard normal, basic,
percentile, and BCa methods.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> aircondit[<span class="dv">1</span>]</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a>mean.x <span class="ot">&lt;-</span> <span class="cf">function</span>(x, i) <span class="fu">return</span>(<span class="fu">mean</span>(<span class="fu">as.matrix</span>(x[i, ])))</span>
<span id="cb78-4"><a href="#cb78-4" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb78-6"><a href="#cb78-6" tabindex="-1"></a>boot.x <span class="ot">&lt;-</span> <span class="fu">boot</span>(x, <span class="at">statistic =</span> mean.x, <span class="at">R =</span> <span class="dv">2000</span>)</span>
<span id="cb78-7"><a href="#cb78-7" tabindex="-1"></a>boot.x</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = x, statistic = mean.x, R = 2000)
## 
## 
## Bootstrap Statistics :
##     original  bias    std. error
## t1* 108.0833 0.16775    38.11221</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">boot.ci</span>(boot.x, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;perc&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 2000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = boot.x, type = c(&quot;norm&quot;, &quot;perc&quot;, &quot;basic&quot;, 
##     &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 33.2, 182.6 )   ( 25.2, 168.7 )  
## 
## Level     Percentile            BCa          
## 95%   ( 47.4, 190.9 )   ( 57.8, 230.5 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>Then we plot the frequency distribution of the estimates from each
boot replicate and the estimate from data.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">hist</span>(boot.x<span class="sc">$</span>t, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">points</span>(boot.x<span class="sc">$</span>t0, <span class="dv">0</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>The 95% bootstrap confidence intervals for the mean time between
failures <span class="math inline">\(1/\lambda\)</span> by the standard
normal method is (33.2, 182.6), by the basic method is (25.2, 168.7), by
the percentile method is (47.4, 190.9) and by BCa method is (57.8,
230.5).</p>
<p>The reasons for the difference of the intervals are as follows. From
the figure we find that the replicates are not approximately normal, so
the normal and percentile intervals differ. From the histogram of
replicates, it appears that the distribution of the replicates is
skewed, although we are estimating a mean. The reason is that the sample
size is too small for CLT to give a good approximation here. The BCa
interval is a percentile type interval, but it adjusts for both skewness
and bias, so the BCa interval differs from the others.</p>
</div>
<div id="exercise-7.8.-page-213-statistical-computing-with-r." class="section level3">
<h3>Exercise 7.8. (page 213, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Refer to Exercise 7.7. Obtain the jackknife
estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><strong>Solution.</strong> From Exercise 7.7. we known that the
five-dimensional scores data “scor (bootstrap)” have a <span class="math inline">\(5\times5\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span>, with positive eigenvalues <span class="math inline">\(\lambda_1&gt;\dots&gt;\lambda_5\)</span>. In
principal components analysis, <span class="math display">\[\theta=\frac{\lambda_1}{\sum_{j=1}^5\lambda_j}\]</span>
measures the proportion of variance explained by the first principal
component. Let <span class="math inline">\(\hat{\lambda}_1&gt;\dots&gt;\hat{\lambda}_5\)</span>
are the eigenvalues of <span class="math inline">\(\hat{\Sigma}\)</span>, where <span class="math inline">\(\hat{\Sigma}\)</span> is the MLE of <span class="math inline">\(\Sigma\)</span>. And the sample estimate <span class="math display">\[\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{j=1}^5\hat{\lambda}_j}.\]</span></p>
<p>In jackknife method, we calculate <span class="math inline">\(\hat{\theta}_{(j)},j=1,\dots,n\)</span> in the n
cases <span class="math inline">\(x_{(-j)},j=1,\dots,n\)</span>, and
then we get <span class="math inline">\(\bar{\hat{\theta}}_{(\cdot)}\)</span> and <span class="math inline">\(\hat{se}(\hat{\theta})=\sqrt{\widehat{Var}(\hat{\theta})}\)</span>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(bootstrap<span class="sc">::</span>scor)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a><span class="co"># original theta.hat</span></span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cov</span>(x))<span class="sc">$</span>values</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a><span class="co"># n jackknife estimates theta.jack</span></span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  x.jack <span class="ot">&lt;-</span> x[<span class="sc">-</span>i, ]</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  cov.jack <span class="ot">&lt;-</span> <span class="fu">cov</span>(x.jack)</span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov.jack)<span class="sc">$</span>values</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>  theta.jack[i] <span class="ot">&lt;-</span> <span class="fu">max</span>(lambda<span class="sc">/</span><span class="fu">sum</span>(lambda))</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>}</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta.jack) <span class="sc">-</span> theta.hat)</span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">*</span> <span class="fu">sum</span>((theta.jack <span class="sc">-</span> <span class="fu">mean</span>(theta.jack))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a></span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a><span class="co"># result reporting</span></span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">c</span>(theta.hat, bias.jack, se.jack)</span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a><span class="fu">names</span>(result) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;est&quot;</span>, <span class="st">&quot;bias&quot;</span>, <span class="st">&quot;se&quot;</span>)</span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(result)</span></code></pre></div>
<table style="width:43%;">
<colgroup>
<col width="12%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">est</th>
<th align="center">bias</th>
<th align="center">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.6191</td>
<td align="center">0.001069</td>
<td align="center">0.04955</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercise-7.11.-page-213-statistical-computing-with-r." class="section level3">
<h3>Exercise 7.11. (page 213, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> In Example 7.18, leave-one-out (n-fold)
cross validation was used to select the best fitting model. Use
leave-two-out cross validation to compare the models.</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> DAAG<span class="sc">::</span>ironslag</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(d)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(d)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, <span class="dv">2</span>)</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>e_lin <span class="ot">&lt;-</span> e_quad <span class="ot">&lt;-</span> e_exp <span class="ot">&lt;-</span> e_loglog <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>ij <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n <span class="sc">-</span> <span class="dv">1</span>)) <span class="cf">for</span> (j <span class="cf">in</span> (i <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">c</span>(i, j)</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  y <span class="ot">&lt;-</span> d[<span class="sc">-</span>k, <span class="st">&quot;magnetic&quot;</span>]</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> d[<span class="sc">-</span>k, <span class="st">&quot;chemical&quot;</span>]</span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  </span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>  <span class="co"># linear model</span></span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>  J_lin <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  yhat_lin <span class="ot">&lt;-</span> J_lin<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J_lin<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> d[k, <span class="st">&quot;chemical&quot;</span>]</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>  e_lin[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((d[k, <span class="st">&quot;magnetic&quot;</span>] <span class="sc">-</span> yhat_lin)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a>  </span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a>  <span class="co"># quadratic model</span></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>  J_quad <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  yhat_quad <span class="ot">&lt;-</span> J_quad<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J_quad<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> d[k, <span class="st">&quot;chemical&quot;</span>] <span class="sc">+</span> J_quad<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> d[k, <span class="st">&quot;chemical&quot;</span>]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  e_quad[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((d[k, <span class="st">&quot;magnetic&quot;</span>] <span class="sc">-</span> yhat_quad)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>  </span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>  <span class="co"># exponential model</span></span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>  J_exp <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>  logyhat_exp <span class="ot">&lt;-</span> J_exp<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J_exp<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> d[k, <span class="st">&quot;chemical&quot;</span>]</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>  yhat_exp <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat_exp)</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a>  e_exp[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((d[k, <span class="st">&quot;magnetic&quot;</span>] <span class="sc">-</span> yhat_exp)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>  </span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>  <span class="co"># log-log model</span></span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>  J_loglog <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a>  logyhat_loglog <span class="ot">&lt;-</span> J_loglog<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J_loglog<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(d[k, <span class="st">&quot;chemical&quot;</span>])</span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a>  yhat_loglog <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat_loglog)</span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>  e_loglog[ij] <span class="ot">&lt;-</span> <span class="fu">sum</span>((d[k, <span class="st">&quot;magnetic&quot;</span>] <span class="sc">-</span> yhat_loglog)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb86-34"><a href="#cb86-34" tabindex="-1"></a></span>
<span id="cb86-35"><a href="#cb86-35" tabindex="-1"></a>  ij <span class="ot">&lt;-</span> ij <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb86-36"><a href="#cb86-36" tabindex="-1"></a>}</span>
<span id="cb86-37"><a href="#cb86-37" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" tabindex="-1"></a><span class="co"># result reporting</span></span>
<span id="cb86-39"><a href="#cb86-39" tabindex="-1"></a>spe <span class="ot">&lt;-</span> <span class="fu">cbind</span>(e_lin, e_quad, e_exp, e_loglog)</span>
<span id="cb86-40"><a href="#cb86-40" tabindex="-1"></a>aspe <span class="ot">&lt;-</span> <span class="fu">apply</span>(spe, <span class="dv">2</span>, mean)</span>
<span id="cb86-41"><a href="#cb86-41" tabindex="-1"></a><span class="fu">names</span>(aspe) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;linear model&quot;</span>, <span class="st">&quot;quadratic model&quot;</span>, <span class="st">&quot;exponential model&quot;</span>, <span class="st">&quot;log-log model&quot;</span>)</span>
<span id="cb86-42"><a href="#cb86-42" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(aspe)</span></code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="20%" />
<col width="25%" />
<col width="27%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">linear model</th>
<th align="center">quadratic model</th>
<th align="center">exponential model</th>
<th align="center">log-log model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">39.14</td>
<td align="center">35.74</td>
<td align="center">36.91</td>
<td align="center">40.93</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the table of the average squared prediction error, we find that
the quadratic model has the least leave-two-out error in consistent with
leave-one-out validation. So the quadratic model is again selected
according to the minimum prediction error by leave-two-out
cross-validation.</p>
</div>
</div>
</div>
<div id="homework-2023.10.30" class="section level1">
<h1>Homework-2023.10.30</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<div id="question-1.-6" class="section level3">
<h3>Question 1.</h3>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
</div>
<div id="question-2.-5" class="section level3">
<h3>Question 2.</h3>
<p>Exercises 8.1 8.3 (pages 242-243, Statistical Computing with R).</p>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="question-1.-7" class="section level3">
<h3>Question 1.</h3>
<p><strong>Algorithm (continuous situation)</strong></p>
<ul>
<li>Target pdf: <span class="math inline">\(f(x)\)</span>.</li>
<li>Replace <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>.</li>
<li>Proposal distribution (pdf): <span class="math inline">\(g(r|s)\)</span>.</li>
<li>Acceptance probability: <span class="math inline">\(\alpha(s,r)=\min\left\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\right\}\)</span>.</li>
<li>Transition kernel (mixture distribution): <span class="math inline">\(K(r,s)=I_{(s\neq
r)}\alpha(r,s)g(s|r)+I_{(s=r)}[1-\int\alpha(r,s)g(s|r)]\)</span>.</li>
<li>Stationarity: <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>.</li>
</ul>
<p><strong>Proof.</strong> From the definition of <span class="math inline">\(K(r,s)\)</span> and <span class="math inline">\(\alpha(s,r)\)</span>, in the case that <span class="math inline">\(s\neq r\)</span>, we have <span class="math display">\[K(s,r)f(s)=\alpha(s,r)g(r|s)f(s)=\min\left\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\right\}g(r|s)f(s)=\min\left\{f(r)g(s|r),f(s)g(r|s)\right\},\]</span>
and <span class="math display">\[K(r,s)f(r)=\alpha(r,s)g(s|r)f(r)=\min\left\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\right\}g(s|r)f(r)=\min\left\{f(s)g(r|s),f(r)g(s|r)\right\},\]</span>
so <span class="math display">\[K(s,r)f(s)=K(r,s)f(r).\]</span></p>
<p>In the case that <span class="math inline">\(s=r\)</span>, we have
<span class="math display">\[K(s,r)f(s)=\left[1-\int\alpha(s,r)g(r|s)\right]f(s)=\left[1-\int\min\left\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\right\}g(r|s)\right]f(s)\\
=f(s)-\int\min\{f(r)g(s|r),f(s)g(r|s)\}=f(r)-\int\min\{f(r)g(s|r),f(s)g(r|s)\}\\
=\left[1-\int\min\left\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\right\}g(s|r)\right]f(r)=\left[1-\int\alpha(r,s)g(s|r)\right]f(r)=K(r,s)f(r).\]</span></p>
<p>Combining the two cases, we obtain the result <span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span>.</p>
</div>
<div id="exercise-8.1.-pages-242-statistical-computing-with-r." class="section level3">
<h3>Exercise 8.1. (pages 242, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Implement the two-sample Cram&#39;er-von Mises
test for equal distributions as a permutation test. Apply the test to
the data in Examples 8.1 and 8.2.</p>
<p><strong>Solution.</strong> As for two-sample tests for univariate
data, we have Cram&#39;er-von Mises statistic <span class="math display">\[W_2=\frac{mn}{(m+n)^2}\left[\sum_{i=1}^n(F_n(x_i)-G_m(x_i))^2+\sum_{j=1}^m(F_n(y_j)-G_m(y_j))^2\right],\]</span>
where <span class="math inline">\(F_n\)</span> is the ecdf of the sample
<span class="math inline">\(x_1,\dots,x_n\)</span> and <span class="math inline">\(G_m\)</span> is the ecdf of the sample <span class="math inline">\(y_1,\dots,y_m\)</span>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>cvm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">199</span>) {</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a>  N <span class="ot">&lt;-</span> n <span class="sc">+</span> m</span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>  </span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a>  <span class="co"># Fn: ecdf of the sample x1,...,xn; Gm: ecdf of the sample y1,...,ym.</span></span>
<span id="cb88-8"><a href="#cb88-8" tabindex="-1"></a>  Fn <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb88-9"><a href="#cb88-9" tabindex="-1"></a>  Gm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb88-10"><a href="#cb88-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb88-11"><a href="#cb88-11" tabindex="-1"></a>    Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> x))</span>
<span id="cb88-12"><a href="#cb88-12" tabindex="-1"></a>    Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(z[i] <span class="sc">&lt;=</span> y))</span>
<span id="cb88-13"><a href="#cb88-13" tabindex="-1"></a>  }</span>
<span id="cb88-14"><a href="#cb88-14" tabindex="-1"></a>  </span>
<span id="cb88-15"><a href="#cb88-15" tabindex="-1"></a>  <span class="co"># statistic W2</span></span>
<span id="cb88-16"><a href="#cb88-16" tabindex="-1"></a>  cvm0 <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-17"><a href="#cb88-17" tabindex="-1"></a>  </span>
<span id="cb88-18"><a href="#cb88-18" tabindex="-1"></a>  <span class="co"># p-value of the test</span></span>
<span id="cb88-19"><a href="#cb88-19" tabindex="-1"></a>  cvm <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb88-20"><a href="#cb88-20" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb88-21"><a href="#cb88-21" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb88-22"><a href="#cb88-22" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> z[index]</span>
<span id="cb88-23"><a href="#cb88-23" tabindex="-1"></a>    X <span class="ot">&lt;-</span> Z[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb88-24"><a href="#cb88-24" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> Z[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>N]</span>
<span id="cb88-25"><a href="#cb88-25" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb88-26"><a href="#cb88-26" tabindex="-1"></a>      Fn[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> X))</span>
<span id="cb88-27"><a href="#cb88-27" tabindex="-1"></a>      Gm[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">as.integer</span>(Z[i] <span class="sc">&lt;=</span> Y))</span>
<span id="cb88-28"><a href="#cb88-28" tabindex="-1"></a>    }</span>
<span id="cb88-29"><a href="#cb88-29" tabindex="-1"></a>    cvm[j] <span class="ot">&lt;-</span> ((n <span class="sc">*</span> m)<span class="sc">/</span>N) <span class="sc">*</span> <span class="fu">sum</span>((Fn <span class="sc">-</span> Gm)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb88-30"><a href="#cb88-30" tabindex="-1"></a>  }</span>
<span id="cb88-31"><a href="#cb88-31" tabindex="-1"></a>  </span>
<span id="cb88-32"><a href="#cb88-32" tabindex="-1"></a>  <span class="co"># result reporting</span></span>
<span id="cb88-33"><a href="#cb88-33" tabindex="-1"></a>  cvm1 <span class="ot">&lt;-</span> <span class="fu">c</span>(cvm, cvm0)</span>
<span id="cb88-34"><a href="#cb88-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(cvm0, <span class="fu">mean</span>(cvm1 <span class="sc">&gt;=</span> cvm0)))</span>
<span id="cb88-35"><a href="#cb88-35" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we calculate the statistic <span class="math inline">\(M_2\)</span> and the p-value of the test for the
data from “chickwts”.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb89-2"><a href="#cb89-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> chickwts</span>
<span id="cb89-3"><a href="#cb89-3" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb89-4"><a href="#cb89-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(d)</span>
<span id="cb89-5"><a href="#cb89-5" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;horsebean&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb89-6"><a href="#cb89-6" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;linseed&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb89-7"><a href="#cb89-7" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;soybean&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb89-8"><a href="#cb89-8" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;sunflower&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb89-9"><a href="#cb89-9" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;meatmeal&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb89-10"><a href="#cb89-10" tabindex="-1"></a>d[d[,<span class="dv">2</span>]<span class="sc">==</span><span class="st">&quot;casein&quot;</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">6</span></span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">6</span>, <span class="at">ncol =</span> <span class="dv">6</span>)</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>){</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="dv">6</span>){</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">cvm.test</span>(d[d[,<span class="dv">2</span>]<span class="sc">==</span>i, <span class="dv">1</span>], d[d[,<span class="dv">2</span>]<span class="sc">==</span>j, <span class="dv">1</span>])</span>
<span id="cb90-7"><a href="#cb90-7" tabindex="-1"></a>    M2[i,j] <span class="ot">&lt;-</span> result[<span class="dv">1</span>]</span>
<span id="cb90-8"><a href="#cb90-8" tabindex="-1"></a>    p_value[i,j] <span class="ot">&lt;-</span> result[<span class="dv">2</span>]</span>
<span id="cb90-9"><a href="#cb90-9" tabindex="-1"></a>  }</span>
<span id="cb90-10"><a href="#cb90-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="fu">rownames</span>(M2) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(M2) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(p_value) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(p_value) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;horsebean&quot;</span>, <span class="st">&quot;linseed&quot;</span>, <span class="st">&quot;soybean&quot;</span>, <span class="st">&quot;sunflower&quot;</span>, <span class="st">&quot;meatmeal&quot;</span>, <span class="st">&quot;casein&quot;</span>)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>M2</span></code></pre></div>
<pre><code>##           horsebean  linseed   soybean sunflower  meatmeal    casein
## horsebean        NA 15.86667 30.194048  38.35000 26.733333 35.083333
## linseed          NA       NA  4.228022  36.50000 10.803030 27.375000
## soybean          NA       NA        NA  28.43407  4.279481 21.558608
## sunflower        NA       NA        NA        NA  9.484848  3.041667
## meatmeal         NA       NA        NA        NA        NA  7.818182
## casein           NA       NA        NA        NA        NA        NA</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>p_value</span></code></pre></div>
<pre><code>##           horsebean linseed soybean sunflower meatmeal casein
## horsebean        NA    0.01   0.005     0.005    0.005  0.005
## linseed          NA      NA   0.410     0.005    0.080  0.005
## soybean          NA      NA      NA     0.005    0.380  0.005
## sunflower        NA      NA      NA        NA    0.055  0.475
## meatmeal         NA      NA      NA        NA       NA  0.100
## casein           NA      NA      NA        NA       NA     NA</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>The tests to the data on different feed of “chickwts” are shown in
the table. In Example 8.1 and 8.2, the soybean and linseed groups were
discussed. From the table we find that the CvM statistic <span class="math inline">\(M_2=4.228\)</span> and the p-value for the CvM
test comparing soybean and linseed supplements is not significant. So
there is not evidence of a difference between these distributions. In
Example 8.3, the sunflower and linseed groups were discussed. From the
table we find that the CvM statistic <span class="math inline">\(M_2=36.5\)</span> and The p-value for the CvM test
comparing sunflower and linseed supplements is significant at <span class="math inline">\(\alpha=0.01\)</span>, so there is strong evidence
that the distributions of weights for these two groups are
different.</p>
</div>
<div id="exercise-8.3.-pages-243-statistical-computing-with-r." class="section level3">
<h3>Exercise 8.3. (pages 243, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> The Count 5 test for equal variances in
Section 6.4 is based on the maximum number of extreme points. Example
6.15 shows that the Count 5 criterion is not applicable for unequal
sample sizes. Implement a permutation test for equal variance based on
the maximum number of extreme points that applies when sample sizes are
not necessarily equal.</p>
<p><strong>Solution.</strong> The two sample “Count Five” test for
equality of variance counts the number of extreme points of each sample
relative to the range of the other sample. The function “maxoutliers” is
generated from the algorithm.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>maxoutliers <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)))</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>}</span></code></pre></div>
<p>And we calculate the “Count Five” test statistics and the p-value of
the test from the function “maxout”.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>maxout <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R =</span> <span class="dv">199</span>) {</span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(z)</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a>  </span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a>  <span class="co"># statistic</span></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>  stat0 <span class="ot">&lt;-</span> <span class="fu">maxoutliers</span>(x, y)</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a>  </span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a>  <span class="co"># p-value of the test</span></span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>  stat <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>    index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>N)</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>    <span class="fu">maxoutliers</span>(z[index[<span class="dv">1</span><span class="sc">:</span>n]], z[index[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N]])</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a>  })</span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a>  </span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a>  stats <span class="ot">&lt;-</span> <span class="fu">c</span>(stat0, stat)</span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(stats)<span class="sc">/</span>(R <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">estimate =</span> stat0, <span class="at">p =</span> <span class="fu">mean</span>(stats <span class="sc">&gt;=</span> stat0), <span class="at">freq =</span> tab, <span class="at">cdf =</span> <span class="fu">cumsum</span>(tab)))</span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a>}</span></code></pre></div>
<p>Through the new functions, we implement the permutation test for
equal variance based on the maximum number of extreme points in four
specific examples where sample sizes are not necessarily equal.</p>
<p>Example1. Both variances and sample sizes are equal.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 5
## 
## $p
## [1] 0.115
## 
## $freq
## stats
##     1     2     3     4     5     6     7     8 
## 0.265 0.230 0.275 0.115 0.025 0.050 0.035 0.005 
## 
## $cdf
##     1     2     3     4     5     6     7     8 
## 0.265 0.495 0.770 0.885 0.910 0.960 0.995 1.000</code></pre>
<p>Example2. Variances are equal, but sample sizes are unequal.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 6
## 
## $p
## [1] 0.215
## 
## $freq
## stats
##     1     2     3     4     5     6     7     8     9    10    11    13    15 
## 0.220 0.150 0.190 0.145 0.080 0.050 0.070 0.045 0.005 0.030 0.005 0.005 0.005 
## 
## $cdf
##     1     2     3     4     5     6     7     8     9    10    11    13    15 
## 0.220 0.370 0.560 0.705 0.785 0.835 0.905 0.950 0.955 0.985 0.990 0.995 1.000</code></pre>
<p>Example3. Variances are unequal, but sample sizes are equal.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 15
## 
## $p
## [1] 0.005
## 
## $freq
## stats
##     1     2     3     4     5     6     7    15 
## 0.120 0.480 0.200 0.040 0.080 0.050 0.025 0.005 
## 
## $cdf
##     1     2     3     4     5     6     7    15 
## 0.120 0.600 0.800 0.840 0.920 0.970 0.995 1.000</code></pre>
<p>Example4. Both variances and sample sizes are unequal.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a><span class="fu">maxout</span>(x, y)</span></code></pre></div>
<pre><code>## $estimate
## [1] 18
## 
## $p
## [1] 0.005
## 
## $freq
## stats
##     1     2     3     4     5     6     7     8     9    10    11    12    14 
## 0.070 0.315 0.220 0.055 0.100 0.070 0.050 0.045 0.030 0.015 0.015 0.005 0.005 
##    18 
## 0.005 
## 
## $cdf
##     1     2     3     4     5     6     7     8     9    10    11    12    14 
## 0.070 0.385 0.605 0.660 0.760 0.830 0.880 0.925 0.955 0.970 0.985 0.990 0.995 
##    18 
## 1.000</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the results in the four examples, we find that the observed
statistic is not significant in the equal variance examples, but is
significant in the unequal variance examples. In conclusion, the new
permutation test for equal variance based on Count 5 criterion applies
when sample sizes are not necessarily equal.</p>
</div>
</div>
</div>
<div id="homework-2023.11.06" class="section level1">
<h1>Homework-2023.11.06</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<div id="question-1.-8" class="section level3">
<h3>Question 1.</h3>
<p>Consider a model <span class="math inline">\(P(Y=1|X_1,X_2,X_3)=\frac{\exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+\exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>,
where <span class="math inline">\(X_1\sim P(1)\)</span>, <span class="math inline">\(X_2\sim Exp(1)\)</span> and <span class="math inline">\(X_3\sim B(1,0.5)\)</span>.</p>
<ul>
<li><p>Design a function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>.</p></li>
<li><p>Call this function, input values are <span class="math inline">\(N = 106, b_1 = 0, b_2 = 1, b_3 = −1, f_0 = 0.1,
0.01, 0.001, 0.0001\)</span>.</p></li>
<li><p>Plot − log <span class="math inline">\(f_0\)</span> vs <span class="math inline">\(a\)</span>.</p></li>
</ul>
</div>
<div id="question-2.-6" class="section level3">
<h3>Question 2.</h3>
<p>Exercises 9.4 9.7 9.10 (pages 277-278, Statistical Computing with
R).</p>
</div>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="question-1.-9" class="section level3">
<h3>Question 1.</h3>
<p><strong>Solution.</strong> We first design the function that takes as
input values <span class="math inline">\(N, b_1, b_2, b_3\)</span> and
<span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>. The basic idea of calculating <span class="math inline">\(a\)</span> is as following:</p>
<ul>
<li><p>The prevalence <span class="math inline">\(P(Y=1)\)</span> is a
function of <span class="math inline">\(a\)</span> given the other
parameters and distribution of <span class="math inline">\((X_1, X_2,
X_3)\)</span>, say <span class="math inline">\(P(Y=1)=f(a)\)</span>.</p></li>
<li><p>The problem becomes solving <span class="math inline">\(f(a)=f_0\)</span> (find the root of <span class="math inline">\(f(a)-f_0=0\)</span>.</p></li>
<li><p>Approximate <span class="math inline">\(f(a)\)</span> using the
proportions of diseased subjects for any given <span class="math inline">\(a\)</span>.</p></li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>output.a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b, f0){</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>  <span class="co">#生成N组样本(x1i, x2i, x3i), i=1,...,N.</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">rpois</span>(N, <span class="at">lambda =</span> <span class="dv">1</span>), <span class="fu">rexp</span>(N, <span class="at">rate =</span> <span class="dv">1</span>), <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, N, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  </span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>  <span class="co">#构造函数P(Y=1)-f0用来求解a</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>  fa_f0 <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">1</span>,]<span class="sc">-</span>b[<span class="dv">2</span>]<span class="sc">*</span>x[<span class="dv">2</span>,]<span class="sc">-</span>b[<span class="dv">3</span>]<span class="sc">*</span>x[<span class="dv">3</span>,]))</span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>    <span class="fu">log</span>(<span class="fu">mean</span>(prob)) <span class="sc">-</span> <span class="fu">log</span>(f0)</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>  }</span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a>  </span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>  <span class="co">#利用uniroot求解f(a)-f_0=0</span></span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a>  solution <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(fa_f0, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">0</span>))</span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a>  <span class="fu">return</span>(solution<span class="sc">$</span>root)</span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a>}</span></code></pre></div>
<p>Then we call this function and input values are <span class="math inline">\(N = 10^6, b_1 = 0, b_2 = 1, b_3 = −1, f_0 = 0.1,
0.01, 0.001, 0.0001\)</span>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co">#按照题目要求指定 f0, b1, b2, b3, N (large enough)</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>f0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>)</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a><span class="co">#用前面定义的函数output.a得到a的估计</span></span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">sapply</span>(f0, output.a, <span class="at">N =</span> N, <span class="at">b =</span> b)</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a><span class="fu">names</span>(a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;f0=0.1&quot;</span>, <span class="st">&quot;f0=0.01&quot;</span>, <span class="st">&quot;f0=0.001&quot;</span>, <span class="st">&quot;f0=0.0001&quot;</span>)</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##    f0=0.1   f0=0.01  f0=0.001 f0=0.0001 
##  -3.16989  -6.07391  -8.71527 -11.27023</code></pre>
<p>Finally we plot the graph of <span class="math inline">\(\log f_0\sim
a\)</span></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>estimate.logf0 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b){</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>  <span class="co">#生成N组样本(x1i, x2i, x3i), i=1,...,N.</span></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">rpois</span>(N, <span class="at">lambda =</span> <span class="dv">1</span>), <span class="fu">rexp</span>(N, <span class="at">rate =</span> <span class="dv">1</span>), <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, N, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>  </span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a>  <span class="co">#P(Y=1)的概率</span></span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>a<span class="sc">-</span>b[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">1</span>,]<span class="sc">-</span>b[<span class="dv">2</span>]<span class="sc">*</span>x[<span class="dv">2</span>,]<span class="sc">-</span>b[<span class="dv">3</span>]<span class="sc">*</span>x[<span class="dv">3</span>,]))</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>  </span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  <span class="co">#return(log(mean(p)))</span></span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a>  <span class="co">#用二项分布抽样估计概率</span></span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">log</span>(<span class="fu">mean</span>(<span class="fu">rbinom</span>(N, <span class="dv">1</span>, prob))))</span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co">#-logf0关于a的函数图像</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>a_axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)</span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>logf0 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(a_axis, estimate.logf0, <span class="at">b =</span> b)</span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a><span class="fu">plot</span>(a_axis, <span class="sc">-</span>logf0, <span class="at">type =</span> <span class="st">&#39;l&#39;</span>, <span class="at">xlab =</span> <span class="st">&quot;a&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;-log f0&quot;</span>)</span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>  <span class="fu">points</span>(a[i], <span class="sc">-</span><span class="fu">log</span>(f0[i]), <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>)</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>In the figure we show the relationship between house <span class="math inline">\(-\log f_0\)</span> and <span class="math inline">\(a\)</span>. And we also find that the previous
output <span class="math inline">\(a\)</span> in the case <span class="math inline">\(f_0=0.1,0.01,0.001,0.0001\)</span> matches the
figure <span class="math inline">\(-log f_0\sim a\)</span>.</p>
</div>
<div id="exercise-9.4.-pages-277-statistical-computing-with-r." class="section level3">
<h3>Exercise 9.4. (pages 277, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Implement a random walk Metropolis sampler
for generating the standard Laplace distribution (see Exercise 3.2). For
the increment, simulate from a normal distribution. Compare the chains
generated when different variances are used for the proposal
distribution. Also, compute the acceptance rates of each chain.</p>
<p><strong>Solution.</strong> The density of standard Laplace
distribution is <span class="math display">\[f(x)=\frac{1}{2}e^{-|x|},\
x\in\mathbb{R}.\]</span> And the implementation of a random walk
Metropolis sampler for this problem is as follows.</p>
<ul>
<li>Set <span class="math inline">\(g(\cdot|X)\)</span> (proposal pdf)
to be the density of <span class="math inline">\(N(X,\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(X_1\)</span> from <span class="math inline">\(N(0,1)\)</span>.</li>
<li>Repeat for <span class="math inline">\(i=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(Y\)</span> from <span class="math inline">\(N(X_{i-1},\sigma^2)\)</span>.</li>
<li>Generate <span class="math inline">\(U\)</span> from
Uniform(0,1).</li>
<li>Compute accept probability <span class="math inline">\(\alpha(X_{i-1},Y)=\frac{f(Y)g(X_{i-1}|Y)}{f(X_{i-1})g(Y|X_{i-1})}=\frac{f(Y)}{f(X_{i-1})}=\frac{e^{-|Y|}}{e^{-|X_{i-1}|}}\)</span>.
If <span class="math inline">\(U\leq\alpha(X_{i-1},Y)\)</span>, accept
<span class="math inline">\(Y\)</span> and set <span class="math inline">\(X_i=Y\)</span>; otherwise set <span class="math inline">\(X_i=X_{i-1}\)</span>.</li>
<li>Increase <span class="math inline">\(i\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a><span class="co">#Laplace分布密度函数</span></span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>d.Laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>  <span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>}</span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a></span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a><span class="co">#Metropolis抽样方法，其中提议分布为正态分布</span></span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>mcmc.Metropolis.normal <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x.initial, N, f) {</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#M-H方法生成的样本链</span></span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x.initial <span class="co">#初始值</span></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co">#记录接受Y的次数，计算接受率</span></span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>  </span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> (<span class="fu">f</span>(y)<span class="sc">/</span><span class="fu">f</span>(x[i<span class="dv">-1</span>]))){x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a>    } <span class="co">#接受</span></span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>    <span class="cf">else</span>{x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]} <span class="co">#拒绝</span></span>
<span id="cb113-19"><a href="#cb113-19" tabindex="-1"></a>  }</span>
<span id="cb113-20"><a href="#cb113-20" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x, k<span class="sc">/</span>N))</span>
<span id="cb113-21"><a href="#cb113-21" tabindex="-1"></a>}</span></code></pre></div>
<p>We get the result in the cases <span class="math inline">\(\sigma=0.5,1,4,16\)</span>.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#样本链的长度</span></span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#预烧期的长度</span></span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>) <span class="co">#给定的σ值</span></span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">length</span>(sigma) <span class="co">#样本链的数量</span></span></code></pre></div>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co">#M-H方法生成4条样本链和对应的接受率</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>x.initial <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>) <span class="co">#初始值</span></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>mcmc.result <span class="ot">&lt;-</span> <span class="fu">sapply</span>(sigma, mcmc.Metropolis.normal, <span class="at">x.initial =</span> x.initial, <span class="at">N =</span> N, <span class="at">f =</span> d.Laplace)</span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>X.chain <span class="ot">&lt;-</span> <span class="fu">t</span>(mcmc.result[<span class="dv">1</span><span class="sc">:</span>N,]) <span class="co">#样本链</span></span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>accept.prob <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(mcmc.result[(N<span class="sc">+</span><span class="dv">1</span>),]) <span class="co">#接受率</span></span></code></pre></div>
<p>To compare the 4 chains, we show the sample path, the histogram with
the true density, QQ plots and the quantiles of the generated samples
for each chain.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>x_axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="fl">0.01</span>)</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>x_axis.Laplace <span class="ot">&lt;-</span> <span class="fu">d.Laplace</span>(x_axis)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>qq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.005</span>, <span class="dv">1</span>, <span class="fl">0.005</span>)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>qq.population <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fu">rev</span>(<span class="fu">qexp</span>(qq, <span class="dv">1</span>)), <span class="fu">qexp</span>(qq, <span class="dv">1</span>))</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a>qq.chain <span class="ot">&lt;-</span> <span class="fu">apply</span>(X.chain[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, qq))</span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>)){</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a>    <span class="co">#样本路径图</span></span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>    <span class="fu">plot</span>(X.chain[i<span class="sc">+</span>j,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i<span class="sc">+</span>j])), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>    </span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>    <span class="co">#样本频数分布直方图</span></span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>    <span class="fu">hist</span>(X.chain[i<span class="sc">+</span>j, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i<span class="sc">+</span>j])), <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">6</span>, <span class="dv">6</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a>    <span class="fu">lines</span>(x_axis, x_axis.Laplace, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a>    </span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a>    <span class="co">#样本Q-Q图</span></span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a>    <span class="fu">qqplot</span>(qq.population, qq.chain[,i<span class="sc">+</span>j], <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">main =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(sigma[i<span class="sc">+</span>j])), <span class="at">xlab =</span> <span class="st">&quot;Sample quantile&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Population quantile&quot;</span>)</span>
<span id="cb116-19"><a href="#cb116-19" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb116-20"><a href="#cb116-20" tabindex="-1"></a>  }</span>
<span id="cb116-21"><a href="#cb116-21" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="co">#生成服从拉普拉斯分布的样本，得到总体分位数的估计</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>x.Laplace <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">200</span>, <span class="dv">1</span>)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a>x.Laplace <span class="ot">&lt;-</span> x.Laplace <span class="sc">*</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">200</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>), <span class="fl">0.95</span>)</span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a>q.true <span class="ot">&lt;-</span> <span class="fu">quantile</span>(x.Laplace, q)</span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a></span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a><span class="co">#每条样本链的样本分位数</span></span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a>q.chain <span class="ot">&lt;-</span> <span class="fu">apply</span>(X.chain[,<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">quantile</span>(x, q))</span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a></span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a><span class="co">#比较总体分位数和样本链的样本分位数</span></span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a>q.table <span class="ot">&lt;-</span> <span class="fu">cbind</span>(q.true, q.chain)</span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a><span class="fu">colnames</span>(q.table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;True&#39;</span>, <span class="st">&#39;sigma=0.5&#39;</span>, <span class="st">&#39;sigma=1&#39;</span>, <span class="st">&#39;sigma=4&#39;</span>, <span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(q.table)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">True</th>
<th align="right">sigma=0.5</th>
<th align="right">sigma=1</th>
<th align="right">sigma=4</th>
<th align="right">sigma=16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">5%</td>
<td align="right">-2.1823916</td>
<td align="right">-2.1891985</td>
<td align="right">-2.0838377</td>
<td align="right">-2.1107775</td>
<td align="right">-2.2174455</td>
</tr>
<tr class="even">
<td align="left">10%</td>
<td align="right">-1.8356918</td>
<td align="right">-1.6032029</td>
<td align="right">-1.5359687</td>
<td align="right">-1.4326321</td>
<td align="right">-1.6598496</td>
</tr>
<tr class="odd">
<td align="left">20%</td>
<td align="right">-1.1390520</td>
<td align="right">-0.9761851</td>
<td align="right">-0.9748431</td>
<td align="right">-0.7564802</td>
<td align="right">-0.7923252</td>
</tr>
<tr class="even">
<td align="left">30%</td>
<td align="right">-0.7305631</td>
<td align="right">-0.6106492</td>
<td align="right">-0.5797614</td>
<td align="right">-0.3631698</td>
<td align="right">-0.3602846</td>
</tr>
<tr class="odd">
<td align="left">40%</td>
<td align="right">-0.3952421</td>
<td align="right">-0.3085473</td>
<td align="right">-0.2801953</td>
<td align="right">-0.1315037</td>
<td align="right">-0.1182352</td>
</tr>
<tr class="even">
<td align="left">50%</td>
<td align="right">-0.1621381</td>
<td align="right">-0.0747511</td>
<td align="right">-0.0630797</td>
<td align="right">0.0509529</td>
<td align="right">0.0182053</td>
</tr>
<tr class="odd">
<td align="left">60%</td>
<td align="right">0.1426956</td>
<td align="right">0.1510425</td>
<td align="right">0.1617632</td>
<td align="right">0.2462538</td>
<td align="right">0.3233798</td>
</tr>
<tr class="even">
<td align="left">70%</td>
<td align="right">0.4495416</td>
<td align="right">0.4322323</td>
<td align="right">0.4479675</td>
<td align="right">0.5488050</td>
<td align="right">0.5370050</td>
</tr>
<tr class="odd">
<td align="left">80%</td>
<td align="right">0.9130671</td>
<td align="right">0.8147616</td>
<td align="right">0.8274633</td>
<td align="right">0.9166993</td>
<td align="right">0.9532326</td>
</tr>
<tr class="even">
<td align="left">90%</td>
<td align="right">1.3700699</td>
<td align="right">1.4546433</td>
<td align="right">1.5250369</td>
<td align="right">1.6876526</td>
<td align="right">1.6268387</td>
</tr>
<tr class="odd">
<td align="left">95%</td>
<td align="right">2.1174129</td>
<td align="right">1.9625726</td>
<td align="right">2.2153518</td>
<td align="right">2.3197173</td>
<td align="right">2.1315301</td>
</tr>
</tbody>
</table>
<p>From the three figures and table above, we find that the second and
third case are close to the standard Laplace distribution.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="co">#接受率</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">names</span>(accept.prob) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;sigma=0.5&quot;</span>, <span class="st">&quot;sigma=1&quot;</span>, <span class="st">&quot;sigma=4&quot;</span>, <span class="st">&quot;sigma=16&quot;</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>accept.prob</span></code></pre></div>
<pre><code>## sigma=0.5   sigma=1   sigma=4  sigma=16 
##    0.8268    0.7022    0.3412    0.0944</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>As we can see, the acceptance rate of second chain (when <span class="math inline">\(\sigma=1\)</span>) is more favorable.</p>
</div>
<div id="exercise-9.7.-pages-278-statistical-computing-with-r." class="section level3">
<h3>Exercise 9.7. (pages 278, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Implement a Gibbs sampler to generate a
bivariate normal chain <span class="math inline">\((X_t,Y_t)\)</span>
with zero means, unit standard deviations, and correlation 0.9. Plot the
generated sample after discarding a suitable burn-in sample. Fit a
simple linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample and
check the residuals of the model for normality and constant
variance.</p>
<p><strong>Solution.</strong> The target distribution is bivariate
normal that <span class="math display">\[(X,Y)\sim
N(\mu_1,\mu_2,\sigma_1^2,\sigma_2^2,\rho).\]</span> So we have the
conditional distributions <span class="math inline">\(f(x_1|x_2)\)</span> and <span class="math inline">\(f(x_2|x_1)\)</span> that <span class="math display">\[(X|Y=y)\sim
N\left(\mu_1+\rho\frac{\sigma_1}{\sigma_2}(y-\mu_2),
(1-\rho^2)\sigma_1^2\right),\\
(Y|X=x)\sim N\left(\mu_2+\rho\frac{\sigma_2}{\sigma_1}(x-\mu_1),
(1-\rho^2)\sigma_2^2\right).\]</span></p>
<p>We firstly implement the Gibbs sampler below and plot the generated
sample after discarding a suitable burn-in sample.</p>
<ul>
<li>Initialize <span class="math inline">\((X_1, Y_1)\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim
f_{X|Y}(x|Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim
f_{Y|X}(y|X_{t})\)</span>.</li>
<li>Set bivariate normal sample <span class="math inline">\((X_t,Y_t)\)</span>.</li>
<li>Increase <span class="math inline">\(t\)</span>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co">#Gibbs方法估计二元正态分布</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>mcmc.Gibbs.binormal <span class="ot">&lt;-</span> <span class="cf">function</span>(mu, sigma, rho, initial, N) {</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> N) <span class="co">#样本链</span></span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a>  X[,<span class="dv">1</span>] <span class="ot">&lt;-</span> initial <span class="co">#初始值</span></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> sigma <span class="co">#条件正态分布的标准差</span></span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>  </span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>    mu1 <span class="ot">&lt;-</span> mu[<span class="dv">1</span>] <span class="sc">+</span> rho<span class="sc">*</span>(X[<span class="dv">2</span>, t<span class="dv">-1</span>] <span class="sc">-</span> mu[<span class="dv">2</span>])<span class="sc">*</span>sigma[<span class="dv">1</span>]<span class="sc">/</span>sigma[<span class="dv">2</span>]</span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>    X[<span class="dv">1</span>, t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu1, s[<span class="dv">1</span>])<span class="co">#从Y_{t-1}得到X_{t}</span></span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>    mu2 <span class="ot">&lt;-</span> mu[<span class="dv">2</span>] <span class="sc">+</span> rho<span class="sc">*</span>(X[<span class="dv">1</span>, t] <span class="sc">-</span> mu[<span class="dv">1</span>])<span class="sc">*</span>sigma[<span class="dv">2</span>]<span class="sc">/</span>sigma[<span class="dv">1</span>]</span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a>    X[<span class="dv">2</span>, t] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu2, s[<span class="dv">2</span>])<span class="co">#从X_{t}得到Y_{t}</span></span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a>  }</span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb122-2"><a href="#cb122-2" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb122-3"><a href="#cb122-3" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span></span>
<span id="cb122-4"><a href="#cb122-4" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb122-5"><a href="#cb122-5" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb122-6"><a href="#cb122-6" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" tabindex="-1"></a><span class="co">#用Gibbs方法得到样本链</span></span>
<span id="cb122-8"><a href="#cb122-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb122-9"><a href="#cb122-9" tabindex="-1"></a>mcmc.result <span class="ot">&lt;-</span> <span class="fu">mcmc.Gibbs.binormal</span>(mu, sigma, rho, mu, N)</span>
<span id="cb122-10"><a href="#cb122-10" tabindex="-1"></a><span class="co">#样本链X和Y的协方差</span></span>
<span id="cb122-11"><a href="#cb122-11" tabindex="-1"></a><span class="fu">cov</span>(<span class="fu">t</span>(mcmc.result))</span></code></pre></div>
<pre><code>##           [,1]      [,2]
## [1,] 0.9991626 0.9014988
## [2,] 0.9014988 1.0063248</code></pre>
<p>The covariance of <span class="math inline">\((X_t,Y_t)\)</span> is
close to the theoretical matrix <span class="math inline">\(Cov(X,Y)\)</span>. And after discarding the
burn-in sample, the scatter diagram of the generated chain is
elliptically symmetric and centered at the origin</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co">#样本链X和Y的散点图</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>X.chain <span class="ot">&lt;-</span> mcmc.result[<span class="dv">1</span>,]</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a>Y.chain <span class="ot">&lt;-</span> mcmc.result[<span class="dv">2</span>,]</span>
<span id="cb124-4"><a href="#cb124-4" tabindex="-1"></a><span class="fu">plot</span>(X.chain[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], Y.chain[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)], <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Scatter diagram of (X,Y)&quot;</span>, <span class="at">cex =</span> <span class="fl">0.5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb124-5"><a href="#cb124-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmOgBmOjpmOpBmZgBmZjpmkJBmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tpC229u22/+2///bkDrbkGbbtmbbtpDb27bb29vb/7bb/9vb////tmb/25D/27b//7b//9v///+iNLEdAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK7UlEQVR4nO2dDZubuBWF5exM7abbTcfZfmwy02ybYbvbJnSTtsOMzf//XQX0gcDgI8kCC/ucJ4/HAenq6uXqSmCMRUkdlTi3A6mLgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgICCAe1/eS3E6rtPx4r847N5Pa5MvPq8fxC3T6HeDLf/00aIN/L9brt6fN5UzVTv9d+6XXGn39w/b14NeBoKqOpOo9X9aJGXt3WD8hVoGkBF7aAEUOa18VyItXT9Xm7dbcXqsWyQ3T5V2+8OjYQCyoXSePezZl92pESvaGzlsve1ZOclGolJF1HI6pL50BEKBZSJ1fsqPPTB+LUab9+8r999eVtR+/axidoK358UxP1PVbS9eZJu//2teKXGZj0Mbj5aEWTql02dm8cGnqlkdlcHf/3lde3FvysLj61nX76vXPnhSTmgEBUmUl79c2MdDYmskIFW7b2PCEgP57tS+dK0UqiR99gFVHWn1s1nHXvqWOmRagC19dW+1WsJSFZqdyuLQrzuxrEK7cqUDShXJeReC0M9uP73IPdWJg/H2AlDbPXDv9R/Krf/8PSylb38zZPCZg+xrD76cnNV8/ZT+R9Tc/1UR4oCZNeX+zKhANWVrN01oLvy16q77+u9umdNNlEb2iFW1ZOjqsHaGUhV0d9pZNnAGDsxSd98fCo1hPw7CexrPb+tO4DUsclVX++NGVlmt7WTdLd+s8+upHZX26vi8lXFcWuw1ONSAarHozkiK2s8qo6sO5WjAJJpR44ae/7Zf5Ah3gVU9cCMDSt1miPb5qC2vrba6Wu7W/ZZvraAdKW825Ip0ODojiMLWd6DdxqgqrWvP25UV/S0UDtw87ev2x6gQgwD0kc2s4aYrm/v05UOdvcB6UqFnK4OAOVWXmpd1t5HBGRa7K1g5PZdH5A9P/QiyERJ896qPxRB1u6gCKrXPX/uJaFpANUtvasn5WbOlCiKbz/KI3eYpNsc0POin4MO6+sc1FSydg8DGslBukC9cq6j0B5k0wBqF4q19crvN83ouG8mkXp1tNbNyddm2fSylTOM5YU1U+kIMvW7s1i74pW7RwANz2LqABVCpfRquwl7C1DMJG0tYEqzDlq3m2UHq72FvQ5qiWll3XWQXb+7DjI56GiSttdBB9O8PrGo1wxPw4DiTfPlvpnFmiVrqVbS70o5zdx8zPXi+eaTfC1fPlT5vDm17QLa/7ypluDdWUzVbwz8/tPBLCZ3jwGSK+l3ZbelXK0c1/rg3g0AGjwZS/9yx9Bh9VYxkF2ydW/D8+awUMqAsuZaRRUd/Y4EqAqO+96m501/SxHzZHUG6cXTwGH1V97HvP/wrl8mi3m5Yw69fL9B1+SctdvCCypxL5hdjQgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICAIgMSi9G5AMU1N50ICIiAgC4F0GTACSiWYQKa1wMCmtccAZ1NBGRrYN1MQJbEgF+TAjq8R/0kc8cUxd5sgMwXjcXo1+WTBDTfECvkvfpLi6CTDPt5sNvWX/c4BOR/FcFRSwNUltnqkRF0VLm4mxHQZJpwFnvefLNkQCoLTDnND3w57RRz80pP+ZeyUIwOnID6BvoWZhhiM5o72d7QItrPMAFN7MG05iYYYr6GEwfk0mRQm9cDaGQQdbBd9fWgPiAhDrbOfj1oPnMu9pozZPUi/9UvBGQVaa8k6DeiHVWKXIBhz4JnMXfEXtPpw3s22r+y0Ng8f9GAVK/FOB9TYnQhdMmAZKbph08pOsAMnZFVwKUAsiwL653JxYe3RbWjrFMp2NGlAGrT7jCZIVJRHI3TI9uxaaTzLiRjRlZSgKYyZy9m+lmGgHr2rHUORDR+Fu/t6EIAyY474xFH0rOno+kDch5bwuQpBz8uB5DzwFLRU14XoNJ5ZHUIYTcuApAfGwtQTEcTBuQ5uK4OkPAMILz2CXI0RUCOS+ZT+CwZkLk26I3Ip/XlAho7T3eIn+uIILu/nvHj0/jCAXkjms7RtAD5nFZoMGGElgkoYGjpC2iTOZoGoDbL+vLxnt99HZUFd390e2y8/lWC0YdXhwEKYmMQhTXpV9D+YZAjyvUzzYuhh5t7tdurFURGh1BYk54FO7/ZNKL9Q/vrFSO/VBDgbVjgaDihIRSQg/DP6O229/pt0S3bc7w9cwR/w+H4tTPw1x+Q/o2rcUzRI+gkRNrGTEOszr/wdwNyPQxPz0HttVFfLubfSfIGlDnkoPb7PqO/leLarjqzDDupkC+OLZ3oqN8sFqtdYX16FcIneGD5OmoKuq6D4rRr1nYBgRNLSa+kvc+4WkbzOupVMKa5gFOKI/dCTeioT8E45tQg8cZjV57FUf+CUcyZySuEz5yOBhSMYi4o+cT10M3RgIIxzDXd9cVzDYBM5gmauiZRUoD09DPpJ4ExHD2p4AnmzPwsvBBdD6B2fk4nhNICJHed+eTC2dHAguHmhGcCMpWuZIgJ01kcMeqMYgalA8gMFYfAEVZCn1jJABLOg6sp3T8jvZQh1ksgh3sworZCfPeGPI5eMNAcpnP0CuoVANJDbISSjrF53AswPEMEHbuEqIqMenHxgIS1etbv2vsUrA9/5lYKgPofXZSlBcYwK+NeKQxxNE5Bb3PCSkCGkP3v9E//4jgaqaCHOZVa7Isc1h1AbQGHti8yB4kOJzs3D0TYvO4FGJ4QkNxgz14EdJB0FYV23rLLXusQ6/0frnV87EVTKoDOOVEdVTKAUtWkgLyexJloCE0CKORxySeeRywsBwU8Lvm6AI0+LvmIudOG2NIA8XHJWPM+LnmBgAYfl9y9ArYETTnNL/pxyVrTAhq5izzM3Hl0KYCWmIMICImAgAhojnbPZM/fcOKAJhMBAREQ0KUAYg6a2Z6/YQKa1wMCQuYWozMBit2me9FJjPoWjiQCitcmAUUrSkDnMOpbOJIIKF6bBBStKAGdw6hv4WsUAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQGQA1jzUfv8WoVSHE6jGqRals9FG0A5of0P6h6nXu8OzYoipXuBBytqjsjj+rd0DzA5K3oefw2czyRrbModuuFqV228QBSeHQ8Ou2i0Wp/PavSwCUwY4//7bucOEMCFvUZhPPQY1GH2luFWkiwjUuXCzWqgfuAgAVjjnaHZCLxVr1w/jTB+R0tL2GmGP8SKPpAsrlciV36o1PknazqDyode9WvDxLBOVu7rlP864WtdKNoEbPG8ej7bxQdLaolDggFeUOPc8dTzXcLUolDmhhIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgJKG9DzRn6M7nn7RkylDUjdGOV7+0ZMJQ6ouTVz/+B6C/QESh3Qbrv2uBV4AqUOqBpefxl/APoMSh6Q+/2H0yh5QPuHsd/wmEfJA8pu/7s9Y45OHlBRrYBcb4KeRIkDet7U0ZM5358ZX2kD2j80+Uf+IMx5lDQg8wMVrt/EmEBJA0pBBAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQE9H/DgFlU+cM5LQAAAABJRU5ErkJggg==" /><!-- --></p>
<p>From the sample covariance and scatter diagram, we can conclude that
the distribution of the chains <span class="math inline">\((X_t,Y_t)\)</span> approaches to the true
distribution. Then we fit a linear regression model <span class="math inline">\(Y=\beta_0+\beta_1X\)</span> to the sample.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co">#Y关于X的线性回归模型</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a>lin.reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y.chain[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)] <span class="sc">~</span> X.chain[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>b)])</span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>lin.reg</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y.chain[-(1:b)] ~ X.chain[-(1:b)])
## 
## Coefficients:
##     (Intercept)  X.chain[-(1:b)]  
##        0.005174         0.903291</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="fu">summary</span>(lin.reg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Y.chain[-(1:b)] ~ X.chain[-(1:b)])
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.60550 -0.28955 -0.00524  0.28989  1.57293 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)     0.005174   0.006951   0.744    0.457    
## X.chain[-(1:b)] 0.903291   0.007025 128.583   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4395 on 3998 degrees of freedom
## Multiple R-squared:  0.8053, Adjusted R-squared:  0.8052 
## F-statistic: 1.653e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The coefficients of the fitted model 0.903291 is close to the true
value 0.9. Then we check whether the model’s residuals are normal and
constant variance. The theoretical value of the variance of <span class="math inline">\(e\)</span> is <span class="math display">\[Var(e)=Var(Y-0.9X)=Var(Y)+0.9^2Var(X)-2\cdot0.9Cov(X,Y)=1+0.81-1.8\cdot0.9=0.19.\]</span>
So we compare the distribution of the residuals with normal distribution
<span class="math inline">\(N(0,\sigma^2),\ \sigma^2=0.19\)</span>.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co">#残差的期望和方差的理论值和估计值对比</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>mean.var <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">mean</span>(lin.reg<span class="sc">$</span>residuals), <span class="fl">0.19</span>, <span class="fu">var</span>(lin.reg<span class="sc">$</span>residuals))</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a><span class="fu">names</span>(mean.var) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;theoretical mean&quot;</span>, <span class="st">&quot;estimated mean&quot;</span>, <span class="st">&quot;theoretical var&quot;</span>, <span class="st">&quot;estimated var&quot;</span>)</span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(mean.var)</span></code></pre></div>
<table>
<colgroup>
<col width="26%" />
<col width="23%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">theoretical mean</th>
<th align="center">estimated mean</th>
<th align="center">theoretical var</th>
<th align="center">estimated var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">7.844e-18</td>
<td align="center">0.19</td>
<td align="center">0.1931</td>
</tr>
</tbody>
</table>
<p>From the comparison we find that the mean and variance of residuals
are close to the theoretical values.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a><span class="co">#残差的频数分布直方图</span></span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a>x_axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="fl">0.01</span>)</span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="fu">hist</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Density of residuals&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">xlab =</span> <span class="st">&quot;Residual&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>)</span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="fu">lines</span>(x_axis, <span class="fu">dnorm</span>(x_axis, <span class="dv">0</span>, <span class="fu">sqrt</span>(<span class="fl">0.19</span>)), <span class="at">col =</span> <span class="dv">2</span>)</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a><span class="co">#残差的Q-Q图</span></span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a><span class="fu">qqnorm</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">cex =</span> <span class="fl">0.5</span>)</span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a><span class="fu">qqline</span>(lin.reg<span class="sc">$</span>residuals, <span class="at">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the histogram and QQ-plot, we can conclude that the residual is
from the normal distribution with constant variance close to the
theoretical value.</p>
</div>
<div id="exercise-9.10.-pages-278-statistical-computing-with-r." class="section level3">
<h3>Exercise 9.10. (pages 278, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> Refer to Example 9.1. Use the Gelman-Rubin
method to monitor convergence of the chain, and run the chain until the
chain has converged approximately to the target distribution according
to <span class="math inline">\(\hat{R}&lt;1.2\)</span>. (See Exercise
9.9.) Also use the <strong>coda</strong> [212] package to check for
convergence of the chain by the Gelman-Rubin method. Hints: See the help
topics for the coda functions <strong>gelman.diag</strong>,
<strong>gelman.plot</strong>, <strong>as.mcmc</strong>, and
<strong>mcmc.list</strong>.</p>
<p><strong>Solution.</strong> In Example 9.1, the Metropolis-Hastings
with proposal distribution <span class="math inline">\(\chi^2\)</span>(fd = <span class="math inline">\(Y\)</span>) is used to sampler to generate a
sample from a Rayleigh distribution whose density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-\frac{x^2}{2\sigma^2}},\
x\geq0,\sigma&gt;0.\]</span></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co">#Raleigh分布的密度</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>d.Raleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma){</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&gt;=</span> <span class="dv">0</span>)){</span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a>    <span class="fu">return</span>((x<span class="sc">/</span>sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>  }<span class="cf">else</span>{<span class="fu">return</span>(<span class="dv">0</span>)}</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a>}</span>
<span id="cb132-7"><a href="#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="#cb132-8" tabindex="-1"></a><span class="co">#M-H方法，其中提议分布为卡方分布</span></span>
<span id="cb132-9"><a href="#cb132-9" tabindex="-1"></a>mcmc.MH.chisq <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, N, x.initial, f){</span>
<span id="cb132-10"><a href="#cb132-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N) <span class="co">#M-H方法生成的样本链</span></span>
<span id="cb132-11"><a href="#cb132-11" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x.initial <span class="co">#初始值</span></span>
<span id="cb132-12"><a href="#cb132-12" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb132-13"><a href="#cb132-13" tabindex="-1"></a>  </span>
<span id="cb132-14"><a href="#cb132-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb132-15"><a href="#cb132-15" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> x[i<span class="dv">-1</span>])</span>
<span id="cb132-16"><a href="#cb132-16" tabindex="-1"></a>    numerator <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(x[i<span class="dv">-1</span>], <span class="at">df =</span> y)</span>
<span id="cb132-17"><a href="#cb132-17" tabindex="-1"></a>    denominator <span class="ot">&lt;-</span> <span class="fu">f</span>(x[i<span class="dv">-1</span>], sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> x[i<span class="dv">-1</span>])</span>
<span id="cb132-18"><a href="#cb132-18" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> numerator<span class="sc">/</span>denominator){</span>
<span id="cb132-19"><a href="#cb132-19" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y <span class="co">#接受</span></span>
<span id="cb132-20"><a href="#cb132-20" tabindex="-1"></a>    }<span class="cf">else</span>{x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]} <span class="co">#拒绝</span></span>
<span id="cb132-21"><a href="#cb132-21" tabindex="-1"></a>  }</span>
<span id="cb132-22"><a href="#cb132-22" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb132-23"><a href="#cb132-23" tabindex="-1"></a>}</span></code></pre></div>
<p>In the Gelman-Rubin method, we define that <span class="math inline">\(\{X_{ij},1\leq i\leq k,1\leq j\leq n\}\)</span>
are <span class="math inline">\(k\)</span> chains of length <span class="math inline">\(n\)</span> and <span class="math inline">\(\phi_{in}=\phi(X_{i1},\dots,X_{in}),i=1,\dots,k\)</span>
are scalar summary statistics that estimates some parameter of the
target distribution. The Gelman-Rubin statistic is defined as <span class="math display">\[\hat{R}=\frac{\widehat{Var}(\phi)}{W_n},\]</span>
where <span class="math display">\[\widehat{Var}(\phi)=\frac{n-1}{n}W_n+\frac{1}{n}B_n,\
W_n=\frac{1}{k}\sum_{i=1}^k\frac{1}{n-1}\sum_{j=1}^n(\bar{\phi}_{ij}-\bar{\phi}_{i\cdot})^2,\
B_n=\frac{n}{k-1}\sum_{i=1}^k(\bar{\phi}_{i\cdot}-\bar{\phi}_{\cdot\cdot})^2.\]</span></p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="co">#Gelman-Rubin方法</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(phi) {</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(phi)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>  </span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>  <span class="co">#计算Bn, Wn</span></span>
<span id="cb133-6"><a href="#cb133-6" tabindex="-1"></a>  phi.i.mean <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, mean)</span>
<span id="cb133-7"><a href="#cb133-7" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(phi.i.mean)</span>
<span id="cb133-8"><a href="#cb133-8" tabindex="-1"></a>  phi.i.var <span class="ot">&lt;-</span> <span class="fu">apply</span>(phi, <span class="dv">1</span>, var)</span>
<span id="cb133-9"><a href="#cb133-9" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(phi.i.var)</span>
<span id="cb133-10"><a href="#cb133-10" tabindex="-1"></a>  </span>
<span id="cb133-11"><a href="#cb133-11" tabindex="-1"></a>  <span class="co">#计算Var.hat, R.hat</span></span>
<span id="cb133-12"><a href="#cb133-12" tabindex="-1"></a>  var.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>n <span class="sc">+</span> B<span class="sc">/</span>n</span>
<span id="cb133-13"><a href="#cb133-13" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> var.hat<span class="sc">/</span>W</span>
<span id="cb133-14"><a href="#cb133-14" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb133-15"><a href="#cb133-15" tabindex="-1"></a>}</span></code></pre></div>
<p>We firstly use the above function to monitor convergence of the
chain, and run the chain until the chain has converged approximately to
the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>x.initial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">16</span>) <span class="co">#给定初始值</span></span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">length</span>(x.initial) <span class="co">#样本链的数量</span></span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span> <span class="co">#样本链的长度</span></span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co">#预烧期的长度</span></span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a><span class="co">#用M-H方法生成样本链</span></span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a>X.chain <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x.initial, mcmc.MH.chisq, <span class="at">sigma =</span> sigma, <span class="at">N =</span> N, <span class="at">f =</span> d.Raleigh)</span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a><span class="co">#处理样本链得到Φ_{ij}为第i个链前j项的均值</span></span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a>phi.sum <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X.chain, <span class="dv">2</span>, cumsum))</span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a>phi.mean <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(phi.sum, <span class="dv">1</span>, <span class="cf">function</span>(x) x<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>N)))</span></code></pre></div>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a><span class="co">#用Gelman-Rubin方法监测收敛</span></span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>r.hat.chain <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb135-3"><a href="#cb135-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N){</span>
<span id="cb135-4"><a href="#cb135-4" tabindex="-1"></a>  r.hat.chain[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi.mean[, <span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb135-5"><a href="#cb135-5" tabindex="-1"></a>}</span>
<span id="cb135-6"><a href="#cb135-6" tabindex="-1"></a></span>
<span id="cb135-7"><a href="#cb135-7" tabindex="-1"></a><span class="co">#R.hat的图像</span></span>
<span id="cb135-8"><a href="#cb135-8" tabindex="-1"></a><span class="fu">plot</span>(r.hat.chain[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;R.hat&quot;</span>)</span>
<span id="cb135-9"><a href="#cb135-9" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.2</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="co">#N=2000时的R.hat</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>r.hat.final <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(phi.mean)</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>r.hat.final</span></code></pre></div>
<pre><code>## [1] 1.167878</code></pre>
<p>Then we use the <strong>coda</strong> package to check for
convergence of the chain by the Gelman-Rubin method. From help topics,
we know that the function <strong>as.mcmc</strong> is used to convert
other data structures into a Markov Chain Monte Carlo object. The
function <strong>mcmc.list</strong> is used to represent parallel runs
of the same chain, with different starting values and random seeds. The
function <strong>gelman.diag</strong> gives the Gelman and Rubin’s
convergence diagnostic. The plot from function
<strong>gelman.plot</strong> shows the evolution of Gelman and Rubin’s
shrink factor as the number of iterations increases.</p>
<p>We firstly convert the chains into mcmc objects and combine them as a
list. Then we use <strong>gelman.diag</strong> and
<strong>gelman.plot</strong> to discuss the convergence of chains.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a>X.chain <span class="ot">&lt;-</span> <span class="fu">t</span>(X.chain)</span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a><span class="co">#为了使用coda中的Gelman-Rubin诊断函数，我们将链的数据结构转换为mcmc型</span></span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a>mcmc.chain <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">as.mcmc</span>(X.chain[<span class="dv">1</span>, ]), <span class="fu">as.mcmc</span>(X.chain[<span class="dv">2</span>, ]), <span class="fu">as.mcmc</span>(X.chain[<span class="dv">3</span>, ]), <span class="fu">as.mcmc</span>(X.chain[<span class="dv">4</span>, ]))</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a><span class="co">#Gelman-Rubin诊断</span></span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a><span class="fu">gelman.diag</span>(mcmc.chain)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1       1.01</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcmc.chain)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>coda)</span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the above results we can conclude that the MCMC chains tend to
be stable.</p>
</div>
</div>
</div>
<div id="homework-2023.11.13" class="section level1">
<h1>Homework-2023.11.13</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<div id="question-1.-10" class="section level3">
<h3>Question 1.</h3>
<p><strong>课后习题</strong></p>
<p>设 <span class="math display">\[X_1,\dots,X_n\overset{\mathrm{i.i.d}}{\sim}\mathrm{Exp}(\lambda).\]</span>
因为某种原因，只知道<span class="math inline">\(X_i\)</span>落在某个区间<span class="math inline">\((u_i,v_i)\)</span>，其中<span class="math inline">\(u_i&lt;v_i\)</span>是两个非随机的未知常数。这种数据称为区间删失数据。</p>
<ol style="list-style-type: decimal">
<li><p>试分别极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE，且收敛有线性速度。</p></li>
<li><p>设<span class="math inline">\((u_i,v_i),i=1,\dots,n(=10)\)</span>的观测值为
<span class="math display">\[(11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3),\]</span>
试分别编程实现上述两种算法以得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</p></li>
</ol>
<p><strong>提示：</strong>观测数据的似然函数为<span class="math inline">\(L(\lambda)=\prod_{i=1}^n\mathrm{P}_{\lambda}(u_i\leq
X_i\leq v_i)\)</span>。</p>
</div>
<div id="question-2.-7" class="section level3">
<h3>Question 2.</h3>
<p>Exercises 11.8 (pages 354, Statistical Computing with R).</p>
</div>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="question-1.1.-1" class="section level3">
<h3>Question 1.1.</h3>
<p><strong>Solution.</strong> (1). Firstly we obtain the MLE of <span class="math inline">\(\lambda\)</span> through the observed data
likelihood function. From the density and distribution function of
Exp(<span class="math inline">\(\lambda\)</span>) which are <span class="math display">\[f(x|\lambda)=\lambda e^{-\lambda x}\quad
\mathrm{and}\quad F(x|\lambda)=\mathrm{P}_{\lambda}(X\leq
x)=1-e^{-\lambda x},\]</span> the observed data likelihood function
equals that <span class="math display">\[L_o(\lambda|\mathbf{u},\mathbf{v})=\prod_{i=1}^nL_o(\lambda|u_i,v_i)=\prod_{i=1}^n\mathrm{P}_{\lambda}(u_i\leq
X_i\leq v_i)=\prod_{i=1}^n\left((1-e^{-\lambda v_i})-(1-e^{\lambda
u_i})\right)=\prod_{i=1}^n\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right).\]</span> Then the corresponding observed data logarithmic
likelihood function is that <span class="math display">\[l_o(\lambda|\mathbf{u},\mathbf{v})=\log\left(L_o(\lambda|\mathbf{u},\mathbf{v})\right)=\sum_{i=1}^n\log\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right).\]</span></p>
<p>To get the MLE <span class="math inline">\(\hat{\lambda}_{MLE}:=\max_{\lambda&gt;0}l_o(\lambda|\mathbf{u},\mathbf{v})\)</span>,
we obtain the maximum point of <span class="math inline">\(l_o(\lambda|\mathbf{u},\mathbf{v})\)</span> by
exploring the first and second derivatives of it. Because <span class="math display">\[\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})=\frac{\partial
l_o(\lambda|\mathbf{u},\mathbf{v})}{\partial\lambda}=\sum_{i=1}^n\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}},\]</span>
we have <span class="math display">\[\lim_{\lambda\to0+}\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})=\lim_{\lambda\to0+}\sum_{i=1}^n\frac{v_ie^{-\lambda(v_i-u_i)}-u_i}{1-e^{-\lambda(v_i-u_i)}}=+\infty,\\
\lim_{\lambda\to+\infty}\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})=\lim_{\lambda\to0+}\sum_{i=1}^n\frac{v_ie^{-\lambda(v_i-u_i)}-u_i}{1-e^{-\lambda(v_i-u_i)}}=\sum_{i=1}^n-u_i&lt;0.\]</span>
Combining the above result with the fact that <span class="math display">\[\begin{align*}
  \ddot{l}_o(\lambda|\mathbf{u},\mathbf{v})=&amp;\frac{\partial^2
l_o(\lambda|\mathbf{u},\mathbf{v})}{\partial\lambda^2}=\sum_{i=1}^n\frac{\left(u_i^2e^{-\lambda
u_i}-v_i^2e^{-\lambda v_i}\right)\left(e^{-\lambda u_i}-e^{-\lambda
v_i}\right)-\left(v_ie^{-\lambda v_i}-u_ie^{-\lambda
u_i}\right)^2}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\
  =&amp;\sum_{i=1}^n\frac{\left(u_i^2e^{-2\lambda
u_i}-u_i^2e^{-\lambda(u_i+v_i)}-v_i^2e^{-\lambda(u_i+v_i)}+v_i^2e^{-2\lambda
v_i}\right)-\left(u_i^2e^{-2\lambda
u_i}-2u_iv_ie^{-\lambda(u_i+v_i)}+v_i^2e^{-2\lambda
v_i}\right)}{\left(e^{-\lambda u_i}-e^{-\lambda v_i}\right)^2}\\
  =&amp;\sum_{i=1}^n\frac{-u_i^2e^{-\lambda(u_i+v_i)}-v_i^2e^{-\lambda(u_i+v_i)}+2u_iv_ie^{-\lambda(u_i+v_i)}}{\left(e^{-\lambda
u_i}-e^{-\lambda
v_i}\right)^2}=-\sum_{i=1}^n\frac{(u_i-v_i)^2e^{-\lambda(u_i+v_i)}}{\left(e^{-\lambda
u_i}-e^{-\lambda v_i}\right)^2}&lt;0
\end{align*}\]</span></p>
<p>when <span class="math inline">\(u_i&lt;v_i,i=1,\dots,n\)</span>, we
have known the function <span class="math inline">\(\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})\)</span>
is strictly monotonically decreasing and has a unique zero point on
<span class="math inline">\((0,+\infty)\)</span>. So <span class="math inline">\(\hat{\lambda}_{MLE}\)</span> is the unique
solution of the function <span class="math display">\[\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})=\sum_{i=1}^n\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\]</span>
on <span class="math inline">\((0,+\infty)\)</span>, which maximizes the
function <span class="math inline">\({l}_o(\lambda|\mathbf{u},\mathbf{v})\)</span>.</p>
<p>(2). Secondly we obtain the estimate of <span class="math inline">\(\lambda\)</span> through the EM algorithm. We
assume the complete data likelihood function and logarithmic likelihood
function are <span class="math display">\[L_c(\lambda|\mathbf{x})=\prod_{i=1}^nf(x_i|\lambda)=\prod_{i=1}^n\lambda
e^{-\lambda x_i}=\lambda^ne^{-\lambda\sum_{i=1}^nx_i},\\
l_c(\lambda|\mathbf{x})=\log\left(L_c(\lambda|\mathbf{x})\right)=n\log\lambda-\lambda\sum_{i=1}^nx_i.\]</span></p>
<p>The algorithm process is shown below.</p>
<ol style="list-style-type: decimal">
<li><p>Initiate <span class="math inline">\(\lambda\)</span> with <span class="math inline">\(\lambda_0\)</span>.</p></li>
<li><p>E-step: For <span class="math inline">\(t\in\mathbb{N}\)</span>,
from <span class="math display">\[\begin{align*}
  x_{ti}=&amp;\mathbb{E}_{\lambda_t}[x_i|x_i\in(u_i,v_i)]=\frac{\mathbb{E}_{\lambda_t}[x_iI_{x_i\in(u_i,v_i)}]}{\mathbb{E}_{\lambda_t}[I_{x_i\in(u_i,v_i)}]}=\frac{\int_{u_i}^{v_i}xf(x|\lambda_t)dx}{F(v_i|\lambda_t)-F(u_i|\lambda_t)}=\frac{\int_{u_i}^{v_i}\lambda_txe^{-\lambda_tx}dx}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}\\
  =&amp;\frac{-xe^{-\lambda_tx}|_{u_i}^{v_i}+\int_{u_i}^{v_i}e^{-\lambda_tx}dx}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}=\frac{-v_ie^{-\lambda_tv_i}+u_ie^{-\lambda_tu_i}-\frac{1}{\lambda_t}e^{-\lambda_tx}|_{u_i}^{v_i}}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}=\frac{-v_ie^{-\lambda_tv_i}+u_ie^{-\lambda_tu_i}-\frac{1}{\lambda_t}e^{-\lambda_tv_i}+\frac{1}{\lambda_t}e^{-\lambda_tu_i}}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}\\
  =&amp;\frac{u_ie^{-\lambda_tu_i}-v_ie^{-\lambda_tv_i}}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}+\frac{1}{\lambda_t},
\end{align*}\]</span> we have <span class="math display">\[\begin{align*}
l_t(\lambda|\mathbf{u},\mathbf{v})=&amp;\mathbb{E}_{\lambda_t}\left[l_c(\lambda|\mathbf{x})|\mathbf{u},\mathbf{v}\right]=\mathbb{E}_{\lambda_t}\left[\left.n\log\lambda-\lambda\sum_{i=1}^nx_i\right|x_i\in(u_i,v_i),i=1,\dots,n\right]=n\log\lambda-\lambda\sum_{i=1}^nx_{ti}\\
  =&amp;n\log\lambda-\lambda\sum_{i=1}^n\left(\frac{u_ie^{-\lambda_tu_i}-v_ie^{-\lambda_tv_i}}{e^{-\lambda_tu_i}-e^{-\lambda_tv_i}}+\frac{1}{\lambda_t}\right)=n\log\lambda-n\frac{\lambda}{\lambda_t}+\lambda\dot{l}_o(\lambda_t|\mathbf{u},\mathbf{v}).
\end{align*}\]</span></p></li>
<li><p>M-step: maximum <span class="math inline">\(l_t(\lambda|\mathbf{u},\mathbf{v})\)</span> w.r.t.
<span class="math inline">\(\lambda\)</span>, let the resulting
maximizer be <span class="math inline">\(\lambda_{t+1}\)</span>. Because
<span class="math display">\[\dot{l}_t(\lambda|\mathbf{u},\mathbf{v})=\frac{\partial
l_t(\lambda|\mathbf{u},\mathbf{v})}{\partial\lambda}=\frac{n}{\lambda}-\frac{n}{\lambda_t}+\dot{l}_o(\lambda_t|\mathbf{u},\mathbf{v})\]</span>
and <span class="math display">\[\ddot{l}_t(\lambda|\mathbf{u},\mathbf{v})=-\frac{n}{\lambda^2}&lt;0,\]</span>
we find that the function <span class="math inline">\(l_t(\lambda|\mathbf{u},\mathbf{v})\)</span> has a
unique maximum point <span class="math inline">\(\lambda_{t+1}\)</span>
which satisfies the equation that <span class="math display">\[\frac{n}{\lambda_{t+1}}=\frac{n}{\lambda_t}-\dot{l}_o(\lambda_t|\mathbf{u},\mathbf{v}).\]</span></p></li>
<li><p>Repeat steps 2 and 3 until the sequence <span class="math inline">\(\{\lambda_t\},t=0,1,\dots\)</span>
convergence.</p></li>
</ol>
<p>(3). Finally we prove that the sequence <span class="math inline">\(\{\lambda_t\}_{t=0}^{+\infty}\)</span> from EM
algorithm converges to the MLE <span class="math inline">\(\hat{\lambda}_{MLE}\)</span> of the observed data
and has a linear rate of convergence.</p>
<p>Define the function <span class="math display">\[g(y)=y-\frac{1}{n}\dot{l}_o\left(\left.\frac{1}{y}\right|\mathbf{u},\mathbf{v}\right)=\frac{1}{n}\sum_{i=1}^ny-\frac{v_ie^{-v_i/y}-u_ie^{-u_i/y}}{e^{-u_i/y}-e^{-v_i/y}}=\frac{1}{n}\sum_{i=1}^ny-\frac{v_ie^{-(v_i-u_i)/y}-u_i}{1-e^{-(v_i-u_i)/y}}=\frac{1}{n}\sum_{i=1}^n\frac{h(y;u_i,v_i)}{1-e^{-(v_i-u_i)/y}},\quad
y\in(0,+\infty),\]</span> where <span class="math display">\[h(y;u_i,v_i)=y(1-e^{-(v_i-u_i)/y})-(v_ie^{-(v_i-u_i)/y}-u_i).\]</span>
Then we have <span class="math inline">\(\frac{1}{\lambda_{t+1}}=g\left(\frac{1}{\lambda_t}\right)\)</span>.
Because <span class="math display">\[\dot{h}(y;u_i,v_i)=\frac{\partial
h(y;u_i,v_i)}{\partial
y}=1-e^{-(v_i-u_i)/y}+(y+v_i)\frac{(v_i-u_i)}{y^2}e^{-(v_i-u_i)/y}&gt;0,\]</span>
when <span class="math inline">\(y\in(0,+\infty)\)</span>, and <span class="math display">\[\lim_{y\to0+}h(y;u_i,v_i)=u_i&gt;0,\]</span> we
obtain that <span class="math inline">\(g(y)|_{y\in(0,+\infty)}\subset(0,+\infty)\)</span>，which
means that <span class="math inline">\(g(y)\)</span> is a self mapping
function from <span class="math inline">\((0,+\infty)\)</span> to <span class="math inline">\((0,+\infty)\)</span>.</p>
<p>To obtain the Laplace value of the function <span class="math inline">\(g(y)\)</span>, we explore the properties of the
derivative of <span class="math inline">\(g(y)\)</span> with respect to
<span class="math inline">\(y\)</span> that <span class="math display">\[g&#39;(y)=1+\frac{1}{n}\ddot{l}_o\left(\left.\frac{1}{y}\right|\mathbf{u},\mathbf{v}\right)\frac{1}{y^2}=\frac{1}{n}\sum_{i=1}^n1-\frac{(u_i-v_i)^2e^{-(u_i+v_i)/y}}{y^2\left(e^{-u_i/y}-e^{-v_i/y}\right)^2}\triangleq\frac{1}{n}\sum_{i=1}^nl(y;u_i,v_i).\]</span></p>
<p>Because <span class="math display">\[\frac{(u-v)^2e^{-(u+v)/y}}{y^2\left(e^{-u/y}-e^{-v/y}\right)^2}=\frac{(v-u)^2}{y^2(e^{-u/y}-e^{-v/y})(e^{v/y}-e^{u/y})}=\frac{(v-u)^2}{y^2(e^{(v-u)/y}-2+e^{-(v-u)/y})}=\left(\frac{2\frac{v-u}{2y}}{e^{\frac{v-u}{2y}}-e^{-\frac{v-u}{2y}}}\right)^2,\]</span>
we only need to discuss the function <span class="math display">\[s(y)=\frac{2y}{e^y-e^{-y}},\quad
y\in(0,+\infty).\]</span> Because <span class="math display">\[s&#39;(y)=2\frac{(e^y-e^{-y})-y(e^y+e^{-y})}{(e^y-e^{-y})^2}=2\frac{(1-y)e^y-(y+1)e^{-y}}{(e^y-e^{-y})^2}\]</span>
whose numerator <span class="math inline">\(t(y)=(1-y)e^y-(y+1)e^{-y}\)</span> has the
derivative <span class="math display">\[t&#39;(y)=-ye^y+ye^{-y}=-y(e^y-e^{-y})&lt;0,\
y\in(0,+\infty),\]</span> and thus has the maximum <span class="math inline">\(t(0)=1-1=0\)</span>, the derivative <span class="math inline">\(s&#39;(y)&lt;0\)</span> on <span class="math inline">\((0,+\infty)\)</span> and <span class="math inline">\(s(y)\)</span> strictly monotone decreasing on
<span class="math inline">\((0,+\infty)\)</span>. So the function <span class="math inline">\(s(y)\)</span> takes the upper and lower bounds on
<span class="math inline">\((0,+\infty)\)</span> if and only if <span class="math display">\[\sup_{y\in(0,+\infty)}s(y)=\lim_{y\to0+}s(y)=\lim_{y\to0+}\frac{2y}{1+y-(1-y)+O(y^2)}=1,\quad
\inf_{y\in(0,+\infty)}s(y)=\lim_{y\to+\infty}s(y)=0.\]</span> As a
result, the function <span class="math inline">\(l(y;u_i,v_i)\)</span>
decreases strictly monotonically with respect to <span class="math inline">\(y\)</span> on <span class="math inline">\((0,+\infty)\)</span> and <span class="math display">\[\sup_{y\in(0,+\infty)}l(y;u_i,v_i)=\lim_{y\to0+}l(y;u_i,v_i)=1,\quad
\inf_{y\in(0,+\infty)}l(y;u_i,v_i)=\lim_{y\to+\infty}l(y;u_i,v_i)=0.\]</span></p>
<p>From the discussion in (1), we have known that there exists a fixed
point <span class="math inline">\(y_0\in(0,+\infty)\)</span> of the
function <span class="math inline">\(g(y)=y-\frac{1}{n}\dot{l}_o\left(\left.\frac{1}{y}\right|\mathbf{u},\mathbf{v}\right)\)</span>
which satisfies the function <span class="math inline">\(\dot{l}_o\left(\left.\frac{1}{y}\right|\mathbf{u},\mathbf{v}\right)=0\)</span>.
For any <span class="math inline">\(\epsilon\in(0,y_0)\)</span>, define
functions <span class="math inline">\(g_{\epsilon}(y)\)</span> and <span class="math inline">\(l_{\epsilon}(y;u_i,v_i)\)</span> that have the
same expression as <span class="math inline">\(g(y)\)</span> and <span class="math inline">\(l(y;u_i,v_i)\)</span> but with the different
domain <span class="math inline">\([\epsilon,+\infty)\)</span>. Because
<span class="math inline">\(\sup_{y\in[\epsilon,+\infty)}l(y;u_i,v_i)=l(\epsilon;u_i,v_i)&lt;1\)</span>,
we have <span class="math display">\[k_{\epsilon}\triangleq\sup_{y\in[\epsilon,+\infty)}|g_{\epsilon}&#39;(y)|\leq\frac{1}{n}\sum_{i=1}^n\sup_{y\in[\epsilon,+\infty)}l(y;u_i,v_i)=\frac{1}{n}\sum_{i=1}^nl(\epsilon;u_i,v_i)&lt;1.\]</span>
So for any <span class="math inline">\(y_1,y_2\in[\epsilon,+\infty)\)</span>, <span class="math inline">\(|g(y_1)-g(y_2)|\leq
k_{\epsilon}|y_i-y_2|\)</span>. Additionally, for <span class="math inline">\(\forall y\in[\epsilon,+\infty)\)</span>, if <span class="math inline">\(y\in[y_0,+\infty)\)</span>, <span class="math inline">\(g_{\epsilon}(y)\geq
g_{\epsilon}(y_0)=y_0&gt;\epsilon\)</span>; if <span class="math inline">\(y\in[\epsilon,y_0)\)</span>, <span class="math inline">\(g_{\epsilon}(y_0)-g_{\epsilon}(y)\leq
k_{\epsilon}(y_0-y)&lt;y_0-y\)</span>, then <span class="math inline">\(g_{\epsilon}(y)&gt;g_{\epsilon}(y_0)-y_0+y=y\geq\epsilon\)</span>,
so <span class="math inline">\(g_{\epsilon}(y)\in[\epsilon
,+\infty)\)</span>. Thus we find that function <span class="math inline">\(g_{\epsilon}(y)\)</span> is both self mapping and
contraction mapping. From the Banach’s Fixed Point Theory, there exists
a unique fixed point of <span class="math inline">\(g_{\epsilon}(y)\)</span>, which means that there
exists a unique fixed point of <span class="math inline">\(g(y)\)</span>
on <span class="math inline">\([\epsilon,+\infty)\)</span>. Because of
the arbitrariness of <span class="math inline">\(\epsilon\)</span>, we
conclude that there exists a unique fixed point of <span class="math inline">\(g(y)\)</span> on <span class="math inline">\((0,+\infty)\)</span>.</p>
<p>What’s more, we generate a sequence <span class="math inline">\(\{x_i\}_{i=1}^{+\infty}\)</span> from any initial
value <span class="math inline">\(x_0\in(0,+\infty)\)</span> and the
iteration <span class="math inline">\(x_{i}=g(x_{i-1}),i\in\mathbb{N}^*\)</span>.
Through the Banach’s Fixed Point Theory for <span class="math inline">\(g_{\epsilon}(y)\)</span> where <span class="math inline">\(\epsilon\leq\min(x_0,y_0)\)</span>, we have that
the sequence <span class="math inline">\(\{x_i\}_{i=1}^{+\infty}\subset[\epsilon,+\infty)\)</span>
converges to <span class="math inline">\(y_0\)</span>. And from the
above discussion we have known that <span class="math inline">\(g&#39;(y_0)\in(0,\infty)\)</span>. Thus the
sequence <span class="math inline">\(\{x_i\}_{i=1}^{+\infty}\)</span>
has a linear rate of convergence.</p>
<p>Let <span class="math inline">\(\hat{\lambda}_{MLE}=\frac{1}{y_0}\)</span> and
<span class="math inline">\(\lambda_t=\frac{1}{x_t},t\in\mathbb{N}\)</span>.
We conclude that the sequence <span class="math inline">\(\{\lambda_t\}_{t=0}^{+\infty}\)</span> from EM
algorithm converges to the MLE <span class="math inline">\(\hat{\lambda}_{MLE}\)</span> of the observed data
and has a linear rate of convergence.</p>
</div>
<div id="question-1.2.-1" class="section level3">
<h3>Question 1.2.</h3>
<p><strong>Solution.</strong> As for the first method, we obtain the MLE
<span class="math inline">\(\hat{\lambda}_{MLE}\)</span> of <span class="math inline">\(\lambda\)</span> through the observed data
likelihood function, which is the unique solution of the function <span class="math display">\[\dot{l}_o(\lambda|\mathbf{u},\mathbf{v})=\sum_{i=1}^n\frac{v_ie^{-\lambda
v_i}-u_ie^{-\lambda u_i}}{e^{-\lambda u_i}-e^{-\lambda v_i}}=0\]</span>
on <span class="math inline">\((0,+\infty)\)</span>.</p>
<p>Secondly we obtain the estimate of <span class="math inline">\(\lambda\)</span> through the EM algorithm with
iteration <span class="math display">\[\frac{n}{\lambda_{t+1}}=\frac{n}{\lambda_t}-\dot{l}_o(\lambda_t|\mathbf{u},\mathbf{v}).\]</span></p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co">#观测数据对数似然的一阶导函数</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>d.log.likelihood_o <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, u, v){</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a>  numerator <span class="ot">&lt;-</span> v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v) <span class="sc">-</span> u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)</span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a>  denominator <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u) <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)</span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(numerator<span class="sc">/</span>denominator))</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>}</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a></span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a><span class="co">#观测数据：x的下界</span></span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a><span class="co">#观测数据：x的下界</span></span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a><span class="co">#存储两种方法得到的估计值</span></span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>lambda.estimate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">2</span>)</span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a><span class="co">#方法1：关于观测数据似然函数的MLE</span></span>
<span id="cb145-2"><a href="#cb145-2" tabindex="-1"></a><span class="co">#求解对数似然方程</span></span>
<span id="cb145-3"><a href="#cb145-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(d.log.likelihood_o, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.1</span>), <span class="at">u=</span>u, <span class="at">v=</span>v)</span>
<span id="cb145-4"><a href="#cb145-4" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## $root
## [1] 0.07196189
## 
## $f.root
## [1] 0.02240382
## 
## $iter
## [1] 6
## 
## $init.it
## [1] NA
## 
## $estim.prec
## [1] 6.103516e-05</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a>lambda.estimate[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(result[<span class="dv">1</span>])</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co">#方法2：EM算法</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(u) <span class="co">#样本容量</span></span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e3</span> <span class="co">#迭代次数上界</span></span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>lambda.seq <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N<span class="sc">+</span><span class="dv">1</span>) <span class="co">#λ数列</span></span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>lambda.seq[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.01</span> <span class="co">#初始化</span></span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>rate <span class="ot">&lt;-</span> .Machine<span class="sc">$</span>double.eps <span class="co">#当数列中元素变化足够小判断收敛</span></span>
<span id="cb148-7"><a href="#cb148-7" tabindex="-1"></a><span class="co">#迭代</span></span>
<span id="cb148-8"><a href="#cb148-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb148-9"><a href="#cb148-9" tabindex="-1"></a>  lambda.seq[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> n<span class="sc">/</span>(n<span class="sc">/</span>lambda.seq[i] <span class="sc">-</span> <span class="fu">d.log.likelihood_o</span>(lambda.seq[i],u,v))</span>
<span id="cb148-10"><a href="#cb148-10" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">abs</span>(lambda.seq[i<span class="sc">+</span><span class="dv">1</span>] <span class="sc">-</span> lambda.seq[i])<span class="sc">/</span>lambda.seq[i]) <span class="sc">&lt;</span> rate){</span>
<span id="cb148-11"><a href="#cb148-11" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;The sequence converges after&quot;</span>, i, <span class="st">&quot;iterations.&quot;</span>, <span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb148-12"><a href="#cb148-12" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb148-13"><a href="#cb148-13" tabindex="-1"></a>  }</span>
<span id="cb148-14"><a href="#cb148-14" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## The sequence converges after 8 iterations.</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>lambda.estimate[<span class="dv">2</span>] <span class="ot">&lt;-</span> lambda.seq[i<span class="sc">+</span><span class="dv">1</span>]</span></code></pre></div>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="co">#数据整理</span></span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a><span class="fu">names</span>(lambda.estimate) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;MLE&quot;</span>,<span class="st">&quot;EM&quot;</span>)</span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>lambda.estimate</span></code></pre></div>
<pre><code>##        MLE         EM 
## 0.07196189 0.07197350</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>The estimates of <span class="math inline">\(\lambda\)</span> from
the two methods are similar.</p>
</div>
<div id="exercises-11.8-pages-354-statistical-computing-with-r." class="section level3">
<h3>Exercises 11.8 (pages 354, Statistical Computing with R).</h3>
<p><strong>Problem.</strong> In the Morra game, the set of optimal
strategies are not changed if a constant is subtracted from every entry
of the payoff matrix, or a positive constant is multiplied times every
entry of the payoff matrix. However, the simplex algorithm may terminate
at a different basic feasible point (also optimal). Compute <strong>B
&lt;- A + 2</strong>, find the solution of game <span class="math inline">\(B\)</span>, and verify that it is one of the
extreme points (11.12)-(11.15) of the original game <span class="math inline">\(A\)</span>. Also find the value of game <span class="math inline">\(A\)</span> and game <span class="math inline">\(B\)</span>.</p>
<p><strong>Solution.</strong> We generate the function solve.game
according to Example 11.17.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>Morra.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb154-2"><a href="#cb154-2" tabindex="-1"></a>  <span class="co">#用单纯形法求解二人零和博弈</span></span>
<span id="cb154-3"><a href="#cb154-3" tabindex="-1"></a>  </span>
<span id="cb154-4"><a href="#cb154-4" tabindex="-1"></a>  <span class="co">#对A进行线性变换使得A中元素属于[0,1]，且目标函数v &gt;= 0</span></span>
<span id="cb154-5"><a href="#cb154-5" tabindex="-1"></a>  original.A <span class="ot">&lt;-</span> A</span>
<span id="cb154-6"><a href="#cb154-6" tabindex="-1"></a>  A_min <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb154-7"><a href="#cb154-7" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> A_min <span class="co">#由此可得A中元素 &gt;= 0，于是v &gt;= 0</span></span>
<span id="cb154-8"><a href="#cb154-8" tabindex="-1"></a>  A_max <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb154-9"><a href="#cb154-9" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">/</span> A_max <span class="co">#由此可得A中元素属于[0,1]</span></span>
<span id="cb154-10"><a href="#cb154-10" tabindex="-1"></a>  m.x <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb154-11"><a href="#cb154-11" tabindex="-1"></a>  n.y <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb154-12"><a href="#cb154-12" tabindex="-1"></a>  iteration <span class="ot">&lt;-</span> n.y<span class="sc">^</span><span class="dv">3</span> <span class="co">#在单纯形法的每个阶段要进行的最大迭代次数</span></span>
<span id="cb154-13"><a href="#cb154-13" tabindex="-1"></a>  </span>
<span id="cb154-14"><a href="#cb154-14" tabindex="-1"></a>  <span class="co">#先优化玩家1，再优化玩家2</span></span>
<span id="cb154-15"><a href="#cb154-15" tabindex="-1"></a>  </span>
<span id="cb154-16"><a href="#cb154-16" tabindex="-1"></a>  <span class="co">#设玩家1的策略为x^*=(x_1,...,x_m)^T，把v作为额外变量，即要求最小值的目标函数，令x=(x_1,..., x_m, x_{m+1}=v)^T。最大化v=x_{m+1}=e_{m+1}^T x，受制于A1x &lt;= 0, A3x = 1。</span></span>
<span id="cb154-17"><a href="#cb154-17" tabindex="-1"></a>  object.x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m.x), <span class="dv">1</span>) <span class="co">#目标函数：收益矩阵的值v=x_{m+1}=object.x^T x</span></span>
<span id="cb154-18"><a href="#cb154-18" tabindex="-1"></a>  A1.x.leq <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n.y)) <span class="co">#A1是由-A的转置与元素全为1的列合并得到的n*(m+1)维矩阵，即A1=-(A^T -1_n)</span></span>
<span id="cb154-19"><a href="#cb154-19" tabindex="-1"></a>  b1.x.leq <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n.y) <span class="co">#约束A_1x &lt;= 0</span></span>
<span id="cb154-20"><a href="#cb154-20" tabindex="-1"></a>  A3.x.eq <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m.x), <span class="dv">0</span>))) <span class="co">#A3是前m项为1，第m+1项为0的矩阵，即A3=(1_m^T 0)</span></span>
<span id="cb154-21"><a href="#cb154-21" tabindex="-1"></a>  b3.x.eq <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#约束A3x = 1，即sum(x^*)=1</span></span>
<span id="cb154-22"><a href="#cb154-22" tabindex="-1"></a>  <span class="co">#利用函数simplex求解，解得x=(x_1,..., x_m, x_{m+1}=v)</span></span>
<span id="cb154-23"><a href="#cb154-23" tabindex="-1"></a>  simplex.x <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>object.x, <span class="at">A1=</span>A1.x.leq, <span class="at">b1=</span>b1.x.leq, <span class="at">A3=</span>A3.x.eq, <span class="at">b3=</span>b3.x.eq, <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>iteration)</span>
<span id="cb154-24"><a href="#cb154-24" tabindex="-1"></a>  </span>
<span id="cb154-25"><a href="#cb154-25" tabindex="-1"></a>  <span class="co">#设玩家2的策略为y^*=(y_1,...,y_n)，把v作为额外变量，即要求最小值的目标函数，令y=(y_1,..., y_n, y_{n+1}=v)^T。最大化v=y_{n+1}=e_{n+1}^T y，受制于A1y &lt;= 0, A3y = 1。</span></span>
<span id="cb154-26"><a href="#cb154-26" tabindex="-1"></a>  object.y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n.y), <span class="dv">1</span>) <span class="co">#目标函数：收益矩阵的值v=y_{n+1}=object.y^T y</span></span>
<span id="cb154-27"><a href="#cb154-27" tabindex="-1"></a>  A1.y.leq <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m.x)) <span class="co">#A1是由A与元素全为-1的列合并得到的m*(n+1)维矩阵，即A1=(A 1_m)</span></span>
<span id="cb154-28"><a href="#cb154-28" tabindex="-1"></a>  b1.y.leq <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m.x) <span class="co">#约束A_1y &lt;= 0</span></span>
<span id="cb154-29"><a href="#cb154-29" tabindex="-1"></a>  A3.y.eq <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n.y), <span class="dv">0</span>))) <span class="co">#A3是前n项为1，第n+1项为0的矩阵，即A3=(1_n^T 0)</span></span>
<span id="cb154-30"><a href="#cb154-30" tabindex="-1"></a>  b3.y.eq <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#约束A3y = 1，即sum(y^*)=1</span></span>
<span id="cb154-31"><a href="#cb154-31" tabindex="-1"></a>  <span class="co">#利用函数simplex求解，解得y=(x_1,..., y_n, y_{n+1}=v)</span></span>
<span id="cb154-32"><a href="#cb154-32" tabindex="-1"></a>  simplex.y <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>object.y, <span class="at">A1=</span>A1.y.leq, <span class="at">b1=</span>b1.y.leq, <span class="at">A3=</span>A3.y.eq, <span class="at">b3=</span>b3.y.eq, <span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>iteration)</span>
<span id="cb154-33"><a href="#cb154-33" tabindex="-1"></a>  </span>
<span id="cb154-34"><a href="#cb154-34" tabindex="-1"></a>  <span class="co">#结果整理，以列表形式输出收益矩阵，最优策略，以及Morra游戏的值</span></span>
<span id="cb154-35"><a href="#cb154-35" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;payoff matrix&quot;</span> <span class="ot">=</span> original.A, <span class="st">&quot;strategy.x&quot;</span> <span class="ot">=</span> simplex.x<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m.x], <span class="st">&quot;strategy.y&quot;</span> <span class="ot">=</span> simplex.y<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n.y], <span class="st">&quot;value&quot;</span> <span class="ot">=</span> simplex.x<span class="sc">$</span>soln[m.x<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> A_max <span class="sc">+</span> A_min)</span>
<span id="cb154-36"><a href="#cb154-36" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb154-37"><a href="#cb154-37" tabindex="-1"></a>}</span></code></pre></div>
<p>And then we get the optimal strategies and the values of games <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> through the new function, and discuss
which one of the extreme points (11.12)-(11.15) equals the optimal
strategy of game <span class="math inline">\(A\)</span> and game <span class="math inline">\(B\)</span>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb155-2"><a href="#cb155-2" tabindex="-1"></a>              <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb155-3"><a href="#cb155-3" tabindex="-1"></a>              <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb155-4"><a href="#cb155-4" tabindex="-1"></a>              <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb155-5"><a href="#cb155-5" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb155-6"><a href="#cb155-6" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb155-7"><a href="#cb155-7" tabindex="-1"></a>              <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb155-8"><a href="#cb155-8" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb155-9"><a href="#cb155-9" tabindex="-1"></a>              <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="at">nrow =</span> <span class="dv">9</span>, <span class="at">ncol =</span> <span class="dv">9</span>) <span class="co">#收益矩阵</span></span>
<span id="cb155-10"><a href="#cb155-10" tabindex="-1"></a>B <span class="ot">&lt;-</span> A <span class="sc">+</span> <span class="dv">2</span> <span class="co">#收益矩阵每个元素都增加一个常数</span></span>
<span id="cb155-11"><a href="#cb155-11" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#包含函数simplex的包</span></span>
<span id="cb155-12"><a href="#cb155-12" tabindex="-1"></a><span class="co">#对A和B分别使用函数Morra.game，得到最优策略及Morra游戏的值</span></span>
<span id="cb155-13"><a href="#cb155-13" tabindex="-1"></a>result.A <span class="ot">&lt;-</span> <span class="fu">Morra.game</span>(A)</span>
<span id="cb155-14"><a href="#cb155-14" tabindex="-1"></a>result.B <span class="ot">&lt;-</span> <span class="fu">Morra.game</span>(B)</span></code></pre></div>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="co">#结果整理</span></span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a><span class="co">#比较游戏A和B的最优策略</span></span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>compare.strategy <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">cbind</span>(result.A<span class="sc">$</span>strategy.x, result.A<span class="sc">$</span>strategy.y, result.B<span class="sc">$</span>strategy.x, result.B<span class="sc">$</span>strategy.y), <span class="dv">8</span>)</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a><span class="fu">colnames</span>(compare.strategy) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;strategy 1 for A&quot;</span>, <span class="st">&quot;strategy 2 for A&quot;</span>, <span class="st">&quot;strategy 1 for B&quot;</span>, <span class="st">&quot;strategy 2 for B&quot;</span>)</span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(compare.strategy)</span></code></pre></div>
<table>
<colgroup>
<col width="4%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
<col width="23%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">strategy 1 for A</th>
<th align="right">strategy 2 for A</th>
<th align="right">strategy 1 for B</th>
<th align="right">strategy 2 for B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x1</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">x2</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">x3</td>
<td align="right">0.4098361</td>
<td align="right">0.4098361</td>
<td align="right">0.4098361</td>
<td align="right">0.4098361</td>
</tr>
<tr class="even">
<td align="left">x4</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">x5</td>
<td align="right">0.3278688</td>
<td align="right">0.3278688</td>
<td align="right">0.3278688</td>
<td align="right">0.3278688</td>
</tr>
<tr class="even">
<td align="left">x6</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">x7</td>
<td align="right">0.2622951</td>
<td align="right">0.2622951</td>
<td align="right">0.2622951</td>
<td align="right">0.2622951</td>
</tr>
<tr class="even">
<td align="left">x8</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">x9</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a><span class="co">#观察最优策略是式(11.12)-(11.15)中的哪一个</span></span>
<span id="cb157-2"><a href="#cb157-2" tabindex="-1"></a>extreme.pionts <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">5</span><span class="sc">/</span><span class="dv">12</span>,<span class="dv">16</span><span class="sc">/</span><span class="dv">37</span>,<span class="dv">20</span><span class="sc">/</span><span class="dv">47</span>,<span class="dv">25</span><span class="sc">/</span><span class="dv">61</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">12</span>,<span class="dv">12</span><span class="sc">/</span><span class="dv">37</span>,<span class="dv">15</span><span class="sc">/</span><span class="dv">47</span>,<span class="dv">20</span><span class="sc">/</span><span class="dv">61</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">c</span>(<span class="dv">3</span><span class="sc">/</span><span class="dv">12</span>,<span class="dv">9</span><span class="sc">/</span><span class="dv">37</span>,<span class="dv">12</span><span class="sc">/</span><span class="dv">47</span>,<span class="dv">16</span><span class="sc">/</span><span class="dv">61</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>), <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>))</span>
<span id="cb157-3"><a href="#cb157-3" tabindex="-1"></a>difference <span class="ot">&lt;-</span> extreme.pionts <span class="sc">-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(compare.strategy[,<span class="dv">1</span>],<span class="dv">4</span>), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">9</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-4"><a href="#cb157-4" tabindex="-1"></a><span class="co">#apply(extreme.pionts, 1, function(x) prod(all.equal(x,compare.strategy[,1])))</span></span>
<span id="cb157-5"><a href="#cb157-5" tabindex="-1"></a><span class="co">#apply(extreme.pionts, 1, function(x) identical(x,compare.strategy[,1]))</span></span>
<span id="cb157-6"><a href="#cb157-6" tabindex="-1"></a><span class="fu">as.logical</span>(<span class="fu">apply</span>(<span class="fu">abs</span>(difference)<span class="sc">&lt;</span><span class="fl">1e-8</span>, <span class="dv">1</span>, prod))</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="co">#比较游戏A和B的值</span></span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a>compare.value <span class="ot">&lt;-</span> <span class="fu">c</span>(result.A<span class="sc">$</span>value, result.B<span class="sc">$</span>value)</span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a><span class="fu">names</span>(compare.value) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;value of game A&quot;</span>, <span class="st">&quot;value of game B&quot;</span>)</span>
<span id="cb159-4"><a href="#cb159-4" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(compare.value)</span></code></pre></div>
<table style="width:50%;">
<colgroup>
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">value of game A</th>
<th align="center">value of game B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0</td>
<td align="center">2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>boot)</span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From above comparison between the solutions from solving game <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, we find that the optimal strategies of
game <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are the same and both close to the
extreme point given by (11.15), and the difference between the value of
game <span class="math inline">\(B\)</span> and the value of game <span class="math inline">\(A\)</span> equals the difference between the
elements of payoff matrix <span class="math inline">\(B\)</span> and
<span class="math inline">\(A\)</span>. As a result, we conclude that if
a constant is subtracted from each entry of the payoff matrix, the
optimal policy set does not change, and the decrease of the value of the
game is equal to the subtracted constant.</p>
</div>
</div>
</div>
<div id="homework-2023.11.20" class="section level1">
<h1>Homework-2023.11.20</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<div id="question-1.-11" class="section level3">
<h3>Question 1.</h3>
<ul>
<li>2.1.3 Exercise 4 (Pages 19 Advanced in R)</li>
<li>2.3.1 Exercise 1, 2 (Pages 26 Advanced in R)</li>
<li>2.4.5 Exercise 2, 3 (Pages 30 Advanced in R)</li>
<li>Exercises 2 (page 204, Advanced R)</li>
<li>Exercises 1 (page 213, Advanced R)</li>
</ul>
</div>
<div id="question-2.-8" class="section level3">
<h3>Question 2.</h3>
<p>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section)</p>
<ul>
<li>Write an R function.</li>
<li>Write an Rcpp function.</li>
<li>Compare the computation time of the two functions with the function
“microbenchmark”</li>
</ul>
</div>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
</div>
<div id="question-1.-12" class="section level2">
<h2>Question 1.</h2>
<div id="exercise-4-pages-19-advanced-in-r." class="section level3">
<h3>2.1.3 Exercise 4 (Pages 19 Advanced in R).</h3>
<p><strong>Problem.</strong> Why do you need to use unlist() to convert
a list to an atomic vector? Why doesn’t as.vector() work?</p>
<p><strong>Solution.</strong> Use a simple example to see the difference
of the function “unlist” and “as.vector”.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a>test.list <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>test.list; <span class="fu">str</span>(test.list)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2 3</code></pre>
<pre><code>## List of 1
##  $ : int [1:3] 1 2 3</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">as.vector</span>(test.list); <span class="fu">str</span>(<span class="fu">as.vector</span>(test.list))</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 2 3</code></pre>
<pre><code>## List of 1
##  $ : int [1:3] 1 2 3</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>; <span class="fu">str</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<pre><code>##  int [1:3] 1 2 3</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="fu">unlist</span>(test.list); <span class="fu">str</span>(<span class="fu">unlist</span>(test.list))</span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<pre><code>##  int [1:3] 1 2 3</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the example we find that given a list structure, the result
given by function “as.vector()” equals the original list, but the result
given by function “unlist()” equals the vector consists of the elements
in the list.</p>
<p>The reason is that the generic definition of “vector” in R contains
not only an atomic vector but also other data structures such as “list”.
The function “unlist()” is specifically for list structure, which
simplifies a list to produce a vector which contains all the atomic
components which occur in it. But “as.vector()” is a generic function
that still convert a list(vector) to a vector(list).</p>
</div>
<div id="exercise-1-pages-26-advanced-in-r." class="section level3">
<h3>2.3.1 Exercise 1 (Pages 26 Advanced in R).</h3>
<p><strong>Problem.</strong> What does dim() return when applied to a
vector?</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>test.vector <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>; <span class="fu">str</span>(test.vector)</span></code></pre></div>
<pre><code>##  int [1:3] 1 2 3</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="fu">dim</span>(test.vector)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">matrix</span>(test.vector, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code></pre></div>
<pre><code>## [1] 1 3</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the example we find that if a vector is entered, the function
“dim()” returns NULL, which is different from the case when a matrix is
entered. Because “dim()” is a function that only for matrix, array, and
data frame.</p>
</div>
<div id="exercise-2-pages-26-advanced-in-r." class="section level3">
<h3>2.3.1 Exercise 2 (Pages 26 Advanced in R).</h3>
<p><strong>Problem.</strong> If is.matrix(x) is TRUE, what will
is.array(x) return?</p>
<p><strong>Solution.</strong></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a>test.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a><span class="fu">is.matrix</span>(test.matrix)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="fu">is.array</span>(test.matrix)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the example we find that if a data structure returns TRUE after
“is.matrix()”, it will also return TRUE after “is.array()”. The reason
is that matrix structure belongs to the array structure and can be
regarded as a two-dimensional array.</p>
</div>
<div id="exercise-2-pages-30-advanced-in-r." class="section level3">
<h3>2.4.5 Exercise 2 (Pages 30 Advanced in R).</h3>
<p><strong>Problem.</strong> What does as.matrix() do when applied to a
data frame with columns of different types?</p>
<p><strong>Solution.</strong> We generate a data frame containing
different types of data structures such as int, numeric, logical,
character, matrix and list. And we will see what will be output after we
input this data frame in as.matrix().</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a>test.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a><span class="fu">colnames</span>(test.matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;col1&quot;</span>, <span class="st">&quot;col2&quot;</span>) </span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a><span class="co">#只要行数与数据框匹配，数据框的列也可以是矩阵或数组。</span></span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a><span class="co">#但是这里需要命名矩阵的列，否则运行as.matrix()会由于列数和列名长度不同而报错。</span></span>
<span id="cb186-5"><a href="#cb186-5" tabindex="-1"></a></span>
<span id="cb186-6"><a href="#cb186-6" tabindex="-1"></a>test.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">3.0</span>,<span class="fl">4.0</span>), <span class="at">c =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">d =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>), <span class="at">e =</span> test.matrix, <span class="at">f =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">2.0</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="fl">3.0</span>))), <span class="at">g =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), test.matrix)))</span>
<span id="cb186-7"><a href="#cb186-7" tabindex="-1"></a>test.dataframe; <span class="fu">str</span>(test.dataframe)</span></code></pre></div>
<pre><code>##   a b     c d e.col1 e.col2       f            g
## 1 1 1  TRUE a      1      5    1, 2         1, 2
## 2 2 2 FALSE b      2      6 1, 2, 3      a, b, c
## 3 3 3  TRUE c      3      7    1, 2  TRUE, FALSE
## 4 4 4 FALSE d      4      8 1, 2, 3 1, 2, 3,....</code></pre>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  8 variables:
##  $ a     : int  1 2 3 4
##  $ b     : num  1 2 3 4
##  $ c     : logi  TRUE FALSE TRUE FALSE
##  $ d     : chr  &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;
##  $ e.col1: int  1 2 3 4
##  $ e.col2: int  5 6 7 8
##  $ f     :List of 4
##   ..$ : int  1 2
##   ..$ : int  1 2 3
##   ..$ : num  1 2
##   ..$ : num  1 2 3
##   ..- attr(*, &quot;class&quot;)= chr &quot;AsIs&quot;
##  $ g     :List of 4
##   ..$ : int  1 2
##   ..$ : chr  &quot;a&quot; &quot;b&quot; &quot;c&quot;
##   ..$ : logi  TRUE FALSE
##   ..$ : int [1:4, 1:2] 1 2 3 4 5 6 7 8
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : NULL
##   .. .. ..$ : chr [1:2] &quot;col1&quot; &quot;col2&quot;
##   ..- attr(*, &quot;class&quot;)= chr &quot;AsIs&quot;</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="fu">as.matrix</span>(test.dataframe); <span class="fu">str</span>(<span class="fu">as.matrix</span>(test.dataframe))</span></code></pre></div>
<pre><code>##      a b c     d   e.col1 e.col2 f         g          
## [1,] 1 1 TRUE  &quot;a&quot; 1      5      integer,2 integer,2  
## [2,] 2 2 FALSE &quot;b&quot; 2      6      integer,3 character,3
## [3,] 3 3 TRUE  &quot;c&quot; 3      7      numeric,2 logical,2  
## [4,] 4 4 FALSE &quot;d&quot; 4      8      numeric,3 integer,8</code></pre>
<pre><code>## List of 32
##  $ : int 1
##  $ : int 2
##  $ : int 3
##  $ : int 4
##  $ : num 1
##  $ : num 2
##  $ : num 3
##  $ : num 4
##  $ : logi TRUE
##  $ : logi FALSE
##  $ : logi TRUE
##  $ : logi FALSE
##  $ : chr &quot;a&quot;
##  $ : chr &quot;b&quot;
##  $ : chr &quot;c&quot;
##  $ : chr &quot;d&quot;
##  $ : int 1
##  $ : int 2
##  $ : int 3
##  $ : int 4
##  $ : int 5
##  $ : int 6
##  $ : int 7
##  $ : int 8
##  $ : int [1:2] 1 2
##  $ : int [1:3] 1 2 3
##  $ : num [1:2] 1 2
##  $ : num [1:3] 1 2 3
##  $ : int [1:2] 1 2
##  $ : chr [1:3] &quot;a&quot; &quot;b&quot; &quot;c&quot;
##  $ : logi [1:2] TRUE FALSE
##  $ : int [1:4, 1:2] 1 2 3 4 5 6 7 8
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : NULL
##   .. ..$ : chr [1:2] &quot;col1&quot; &quot;col2&quot;
##  - attr(*, &quot;dim&quot;)= int [1:2] 4 8
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : NULL
##   ..$ : chr [1:8] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; ...</code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>This result is consistent with the description of the function
“as.matrix()” that is a generic function. The method for data frames
will return a character matrix if there is only atomic columns and any
non-(numeric/logical/complex) column, applying “as.vector()” to factors
and format to other non-character columns. Otherwise, the usual coercion
hierarchy (logical &lt; integer &lt; double &lt; complex) will be used,
e.g., all-logical data frames will be coerced to a logical matrix, mixed
logical-integer will give a integer matrix, etc.</p>
<p>What’s more, the print method for a matrix gives a rectangular layout
with dimnames or indices. For a list matrix, the entries of length not
one are printed in the form “integer,2”⁠ indicating the type and
length.</p>
</div>
<div id="exercise-3-pages-30-advanced-in-r." class="section level3">
<h3>2.4.5 Exercise 3 (Pages 30 Advanced in R).</h3>
<p><strong>Problem.</strong> Can you have a data frame with 0 rows? What
about 0 columns?</p>
<p><strong>Solution.</strong> Yes. We can generate a data frame with 0
rows by converting a matrix with 0 rows into a data frame. We can also
generate a data frame with 0 columns by converting a matrix with 0
columns to a data frame or by simply setting the row.names of the data
frame when using the function “data.frame()”.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="co">#使用函数data.frame()时只设置col.names无法生成0行的数据框。</span></span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a>row0.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>))</span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a>row0.dataframe; <span class="fu">dim</span>(row0.dataframe)</span></code></pre></div>
<pre><code>##   col.names
## 1         a
## 2         b</code></pre>
<pre><code>## [1] 2 1</code></pre>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a><span class="co">#使用函数data.frame()时只设置row.names可以生成0列的数据框。</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a>col0.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>))</span>
<span id="cb196-3"><a href="#cb196-3" tabindex="-1"></a>col0.dataframe; <span class="fu">dim</span>(col0.dataframe)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 2 rows</code></pre>
<pre><code>## [1] 2 0</code></pre>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" tabindex="-1"></a><span class="co">#通过将一个0行的矩阵转换为数据框，生成一个0行的数据框。</span></span>
<span id="cb199-2"><a href="#cb199-2" tabindex="-1"></a>row0.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb199-3"><a href="#cb199-3" tabindex="-1"></a>row0.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(row0.matrix)</span>
<span id="cb199-4"><a href="#cb199-4" tabindex="-1"></a>row0.dataframe; <span class="fu">dim</span>(row0.dataframe)</span></code></pre></div>
<pre><code>## [1] X1 X2
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<pre><code>## [1] 0 2</code></pre>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a><span class="co">#通过将一个0列的矩阵转换为数据框，生成一个0列的数据框。</span></span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a>col0.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(row0.matrix))</span>
<span id="cb202-3"><a href="#cb202-3" tabindex="-1"></a>col0.dataframe; <span class="fu">dim</span>(col0.dataframe)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 2 rows</code></pre>
<pre><code>## [1] 2 0</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercises-2-page-204-advanced-r." class="section level3">
<h3>Exercises 2 (page 204, Advanced R).</h3>
<p><strong>Problem.</strong> The function below scales a vector so it
falls in the range [0, 1]. How would you apply it to every column of a
data frame? How would you apply it to every numeric column in a data
frame?</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb206-2"><a href="#cb206-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb206-3"><a href="#cb206-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb206-4"><a href="#cb206-4" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Solution.</strong> Firstly, for a data frame consists of
numeric column, we use the function “lapply()” to apply function
“scale01()” to every column of it.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a><span class="co">#生成一个每列都是int或double型的数据框</span></span>
<span id="cb207-2"><a href="#cb207-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb207-3"><a href="#cb207-3" tabindex="-1"></a>numeric.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">5.0</span>, <span class="fl">4.0</span>, <span class="fl">3.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>), <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>))</span>
<span id="cb207-4"><a href="#cb207-4" tabindex="-1"></a>numeric.dataframe</span></code></pre></div>
<pre><code>##   a b          c
## 1 1 5 -0.6264538
## 2 2 4  0.1836433
## 3 3 3 -0.8356286
## 4 4 2  1.5952808
## 5 5 1  0.3295078</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="co">#对数据框的每一列使用函数scale01()</span></span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">lapply</span>(numeric.dataframe, scale01))</span></code></pre></div>
<pre><code>##      a    b          c
## 1 0.00 1.00 0.08604796
## 2 0.25 0.75 0.41929655
## 3 0.50 0.50 0.00000000
## 4 0.75 0.25 1.00000000
## 5 1.00 0.00 0.47930062</code></pre>
<p>Secondly, for a data frame containing different types of data
structures int, numeric, logical, character and list, we use the
function “lapply()” to apply function “scale01()” to every numeric
column of it.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="co">#生成列为int, double, logical, character或list的数据框</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a>mixed.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">3.0</span>,<span class="fl">4.0</span>), <span class="at">c =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">d =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>), <span class="at">e =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">2.0</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="fl">3.0</span>))), <span class="at">f =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>))))</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>mixed.dataframe</span></code></pre></div>
<pre><code>##   a b     c d       e           f
## 1 1 1  TRUE a    1, 2        1, 2
## 2 2 2 FALSE b 1, 2, 3     a, b, c
## 3 3 3  TRUE c    1, 2 TRUE, FALSE
## 4 4 4 FALSE d 1, 2, 3  1, 2, 3, 4</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" tabindex="-1"></a><span class="co">#对数据框的每一个numeric型的列使用函数scale01()</span></span>
<span id="cb213-2"><a href="#cb213-2" tabindex="-1"></a>scale.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">lapply</span>(mixed.dataframe, <span class="cf">function</span>(x) <span class="cf">if</span> (<span class="fu">is.numeric</span>(x)) <span class="fu">scale01</span>(x) <span class="cf">else</span> x))</span>
<span id="cb213-3"><a href="#cb213-3" tabindex="-1"></a>scale.dataframe; <span class="fu">str</span>(scale.dataframe)</span></code></pre></div>
<pre><code>##           a         b     c d       e           f
## 1 0.0000000 0.0000000  TRUE a    1, 2        1, 2
## 2 0.3333333 0.3333333 FALSE b 1, 2, 3     a, b, c
## 3 0.6666667 0.6666667  TRUE c    1, 2 TRUE, FALSE
## 4 1.0000000 1.0000000 FALSE d 1, 2, 3  1, 2, 3, 4</code></pre>
<pre><code>## &#39;data.frame&#39;:    4 obs. of  6 variables:
##  $ a: num  0 0.333 0.667 1
##  $ b: num  0 0.333 0.667 1
##  $ c: logi  TRUE FALSE TRUE FALSE
##  $ d: chr  &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;
##  $ e:List of 4
##   ..$ : int  1 2
##   ..$ : int  1 2 3
##   ..$ : num  1 2
##   ..$ : num  1 2 3
##   ..- attr(*, &quot;class&quot;)= chr &quot;AsIs&quot;
##  $ f:List of 4
##   ..$ : int  1 2
##   ..$ : chr  &quot;a&quot; &quot;b&quot; &quot;c&quot;
##   ..$ : logi  TRUE FALSE
##   ..$ : int [1:2, 1:2] 1 2 3 4
##   ..- attr(*, &quot;class&quot;)= chr &quot;AsIs&quot;</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="exercises-1-page-213-advanced-r." class="section level3">
<h3>Exercises 1 (page 213, Advanced R).</h3>
<p><strong>Problem.</strong> Use vapply() to:</p>
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol>
<p><strong>Solution.</strong> (a). For a numeric data frame, we use the
function “vapply()” to apply function “sd()” to every column of it.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" tabindex="-1"></a><span class="co">#生成一个每个元素都是numeric型的数据框</span></span>
<span id="cb217-2"><a href="#cb217-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb217-3"><a href="#cb217-3" tabindex="-1"></a>numeric.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">4.0</span>, <span class="fl">3.0</span>, <span class="fl">2.0</span>, <span class="fl">1.0</span>), <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>))</span>
<span id="cb217-4"><a href="#cb217-4" tabindex="-1"></a>numeric.dataframe</span></code></pre></div>
<pre><code>##   a b          c
## 1 1 4 -0.6264538
## 2 2 3  0.1836433
## 3 3 2 -0.8356286
## 4 4 1  1.5952808</code></pre>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a><span class="co">#对数据框的每一列使用函数sd()</span></span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a><span class="fu">vapply</span>(numeric.dataframe, sd, <span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##        a        b        c 
## 1.290994 1.290994 1.102160</code></pre>
<p>(b). For a mixed data frame containing different types of data
structures int, numeric, logical, character and list, we use the
function “vapply()” to apply function “sd()” to every numeric column of
it.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a><span class="co">#生成列为int, double, logical, character或list的数据框</span></span>
<span id="cb221-2"><a href="#cb221-2" tabindex="-1"></a>mixed.dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">b =</span> <span class="fu">c</span>(<span class="fl">4.0</span>,<span class="fl">3.0</span>,<span class="fl">2.0</span>,<span class="fl">1.0</span>), <span class="at">c =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>), <span class="at">d =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="at">e =</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>), <span class="at">f =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="fl">1.0</span>,<span class="fl">2.0</span>), <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="fl">3.0</span>))), <span class="at">g =</span> <span class="fu">I</span>(<span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>), <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>), <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>))))</span>
<span id="cb221-3"><a href="#cb221-3" tabindex="-1"></a>mixed.dataframe</span></code></pre></div>
<pre><code>##   a b          c     d e       f           g
## 1 1 4  0.3295078  TRUE a    1, 2        1, 2
## 2 2 3 -0.8204684 FALSE b 1, 2, 3     a, b, c
## 3 3 2  0.4874291  TRUE c    1, 2 TRUE, FALSE
## 4 4 1  0.7383247 FALSE d 1, 2, 3  1, 2, 3, 4</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" tabindex="-1"></a><span class="co">#先判断数据框的numeric型的列有哪些，然后对每一个numeric型的列使用函数sd()</span></span>
<span id="cb223-2"><a href="#cb223-2" tabindex="-1"></a>numeric.col <span class="ot">&lt;-</span> <span class="fu">vapply</span>(mixed.dataframe, is.numeric, <span class="at">FUN.VALUE =</span> <span class="cn">TRUE</span>)</span>
<span id="cb223-3"><a href="#cb223-3" tabindex="-1"></a><span class="fu">vapply</span>(mixed.dataframe[,numeric.col], sd, <span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         a         b         c 
## 1.2909944 1.2909944 0.6902835</code></pre>
</div>
</div>
<div id="question-2.-9" class="section level2">
<h2>Question 2.</h2>
<p><strong>Exercise 9.8 (pages 278, Statistical Computing with
R).</strong> This example appears in [40]. Consider the bivariate
density <span class="math display">\[f(x,y)\propto\binom{n}{x}y^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,\dots,n,\ 0\leq y\leq1.\]</span> It can be shown (see e.g. [23])
that for fixed <span class="math inline">\(a, b, n\)</span>, the
conditional distributions are Binomial<span class="math inline">\((n,
y)\)</span> and Beta<span class="math inline">\((x + a, n − x +
b)\)</span>. Use the Gibbs sampler to generate a chain with target joint
density <span class="math inline">\(f(x, y)\)</span>.</p>
<p><strong>Solution.</strong> From the target bivariate density, we have
the marginal distribution of random variables that <span class="math display">\[f_X(x)\propto\int_0^1f(x,y)dy=\binom{n}{x}\mathrm{Beta}(x+a,n-x+b)=\binom{n}{x}\frac{\Gamma(x+a)\Gamma(n-x+b)}{\Gamma(n+a+b)},\\
f_Y(y)\propto\sum_{x=0}^{n}f(x,y)=y^{a-1}(1-y)^{b-1}\sum_{x=0}^n\binom{n}{x}y^x(1-y)^{n-x}=y^{a-1}(1-y)^{b-1}(y+1-y)^n=y^{a-1}(1-y)^{b-1}.\]</span>
So the conditional distributions are <span class="math display">\[f_{X|Y}(x|y)=\frac{f(x,y)}{f(y)}=\binom{n}{x}y^x(1-y)^{n-x},\\
f_{Y|X}(y|x)=\frac{f(x,y)}{f(x)}=\frac{1}{\mathrm{Beta}(x+a,n-x+b)}y^{x+a-1}(1-y)^{n-x+b-1},\]</span>
which means that <span class="math display">\[(X|Y=y)\sim\mathrm{Binomial}(n,y),\quad
(Y|X=x)\sim\mathrm{Beta}(x+a,n-x+b).\]</span></p>
<p>We implement the Gibbs sampler through the Gibbs method.</p>
<ul>
<li>Initialize <span class="math inline">\((X_1, Y_1)\)</span>.</li>
<li>Repeat for <span class="math inline">\(t=2,\dots,N\)</span>:
<ul>
<li>Generate <span class="math inline">\(X_t\sim
f_{X|Y}(x|Y_{t-1})\)</span>, i.e. <span class="math inline">\((X_t|Y_{t-1})\sim\)</span><span class="math inline">\((n,Y_{t-1})\)</span>.</li>
<li>Generate <span class="math inline">\(Y_t\sim
f_{Y|X}(y|X_{t})\)</span>, i.e. <span class="math inline">\((Y_t|X_t)\sim\mathrm{Beta}(X_t+a,n-X_t+b)\)</span>.</li>
<li>Set bivariate random sample <span class="math inline">\((X_t,Y_t)\)</span>.</li>
<li>Increase <span class="math inline">\(t\)</span>.</li>
</ul></li>
</ul>
<div id="r-function" class="section level3">
<h3>R function</h3>
<p>We generate a R function to implement the Gibbs sampler.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" tabindex="-1"></a><span class="co">#Gibbs方法估计二元分布</span></span>
<span id="cb225-2"><a href="#cb225-2" tabindex="-1"></a>mcmc.Gibbs.R <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n, initial, N) {</span>
<span id="cb225-3"><a href="#cb225-3" tabindex="-1"></a>  <span class="co">#a, b, n: 二元分布参数</span></span>
<span id="cb225-4"><a href="#cb225-4" tabindex="-1"></a>  <span class="co">#initial: 初始值</span></span>
<span id="cb225-5"><a href="#cb225-5" tabindex="-1"></a>  <span class="co">#N: 需要生成的样本链长度</span></span>
<span id="cb225-6"><a href="#cb225-6" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> N) <span class="co">#样本链</span></span>
<span id="cb225-7"><a href="#cb225-7" tabindex="-1"></a>  X[,<span class="dv">1</span>] <span class="ot">&lt;-</span> initial <span class="co">#赋初值</span></span>
<span id="cb225-8"><a href="#cb225-8" tabindex="-1"></a>  </span>
<span id="cb225-9"><a href="#cb225-9" tabindex="-1"></a>  <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb225-10"><a href="#cb225-10" tabindex="-1"></a>    <span class="co">#从Y_{t-1}得到X_{t}，(X_t|Y_{t-1})服从Binomial(n,Y_{t-1})分布</span></span>
<span id="cb225-11"><a href="#cb225-11" tabindex="-1"></a>    X[<span class="dv">1</span>, t] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> X[<span class="dv">2</span>, t<span class="dv">-1</span>])</span>
<span id="cb225-12"><a href="#cb225-12" tabindex="-1"></a>    <span class="co">#从X_{t}得到Y_{t}，(Y_t|X_t)服从Beta(X_t+a,n-X_t+b)分布</span></span>
<span id="cb225-13"><a href="#cb225-13" tabindex="-1"></a>    X[<span class="dv">2</span>, t] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> X[<span class="dv">1</span>, t] <span class="sc">+</span> a, <span class="at">shape2 =</span>  n <span class="sc">-</span> X[<span class="dv">1</span>, t] <span class="sc">+</span> b)</span>
<span id="cb225-14"><a href="#cb225-14" tabindex="-1"></a>  }</span>
<span id="cb225-15"><a href="#cb225-15" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb225-16"><a href="#cb225-16" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="rcpp-function" class="section level3">
<h3>Rcpp function</h3>
<p>We generate a Rcpp function to implement the Gibbs sampler.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb226-1"><a href="#cb226-1" tabindex="-1"></a><span class="pp"># include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb226-2"><a href="#cb226-2" tabindex="-1"></a>using namespace Rcpp<span class="op">;</span></span>
<span id="cb226-3"><a href="#cb226-3" tabindex="-1"></a></span>
<span id="cb226-4"><a href="#cb226-4" tabindex="-1"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb226-5"><a href="#cb226-5" tabindex="-1"></a>NumericMatrix mcmc_Gibbs_Rcpp<span class="op">(</span><span class="dt">double</span> a<span class="op">,</span> <span class="dt">double</span> b<span class="op">,</span> <span class="dt">double</span> n<span class="op">,</span> NumericVector initial<span class="op">,</span> <span class="dt">int</span> N<span class="op">){</span></span>
<span id="cb226-6"><a href="#cb226-6" tabindex="-1"></a>  <span class="co">//a, b, n: 二元分布参数</span></span>
<span id="cb226-7"><a href="#cb226-7" tabindex="-1"></a>  <span class="co">//initial: 初始值</span></span>
<span id="cb226-8"><a href="#cb226-8" tabindex="-1"></a>  <span class="co">//N: 需要生成的样本链长度</span></span>
<span id="cb226-9"><a href="#cb226-9" tabindex="-1"></a>  NuemricMatrix X<span class="op">(</span><span class="dv">2</span><span class="op">,</span> N<span class="op">);</span> <span class="co">//样本链</span></span>
<span id="cb226-10"><a href="#cb226-10" tabindex="-1"></a>  X<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">0</span><span class="op">);</span> <span class="co">//赋初值</span></span>
<span id="cb226-11"><a href="#cb226-11" tabindex="-1"></a>  X<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">)</span> <span class="op">=</span> initial<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb226-12"><a href="#cb226-12" tabindex="-1"></a>  </span>
<span id="cb226-13"><a href="#cb226-13" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> t <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> t <span class="op">&lt;</span> N<span class="op">;</span> t<span class="op">++){</span></span>
<span id="cb226-14"><a href="#cb226-14" tabindex="-1"></a>    <span class="co">//从Y_{t-1}得到X_{t}，(X_t|Y_{t-1})服从Binomial(n,Y_{t-1})分布</span></span>
<span id="cb226-15"><a href="#cb226-15" tabindex="-1"></a>    X<span class="op">(</span><span class="dv">0</span><span class="op">,</span> t<span class="op">)</span> <span class="op">=</span> Rcpp<span class="op">::</span>rbinom<span class="op">(</span><span class="dv">1</span><span class="op">,</span> size <span class="op">=</span> n<span class="op">,</span> prob <span class="op">=</span> X<span class="op">(</span><span class="dv">1</span><span class="op">,</span> t<span class="op">-</span><span class="dv">1</span><span class="op">))[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb226-16"><a href="#cb226-16" tabindex="-1"></a>    <span class="co">//从X_{t}得到Y_{t}，(Y_t|X_t)服从Beta(X_t+a,n-X_t+b)分布</span></span>
<span id="cb226-17"><a href="#cb226-17" tabindex="-1"></a>    X<span class="op">(</span><span class="dv">1</span><span class="op">,</span> t<span class="op">)</span> <span class="op">=</span> Rcpp<span class="op">::</span>rbeta<span class="op">(</span><span class="dv">1</span><span class="op">,</span> shape1 <span class="op">=</span> X<span class="op">(</span><span class="dv">0</span><span class="op">,</span> t<span class="op">)</span> <span class="op">+</span> a<span class="op">,</span> shape2 <span class="op">=</span>  n <span class="op">-</span> X<span class="op">(</span><span class="dv">0</span><span class="op">,</span> t<span class="op">)</span> <span class="op">+</span> b<span class="op">)[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb226-18"><a href="#cb226-18" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb226-19"><a href="#cb226-19" tabindex="-1"></a>  <span class="cf">return</span><span class="op">(</span>X<span class="op">);</span></span>
<span id="cb226-20"><a href="#cb226-20" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
</div>
<div id="comparison-of-the-results" class="section level3">
<h3>Comparison of the results</h3>
<p>Then we use the function to generate Gibbs chains in the case that
<span class="math inline">\(a=2, b=5, n=10\)</span>. And we compare the
distributions of the Gibbs chains for random variables X and Y
respectively with the marginal distribution of them that <span class="math display">\[f_X(x)=\binom{n}{x}\frac{\mathrm{Beta}(x+a,n-x+b)}{\mathrm{Beta}(a,b)},\\
f_Y(y)=\frac{1}{\mathrm{Beta}(a,b)}y^{a-1}(1-y)^{b-1}.\]</span></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#样本链长度</span></span>
<span id="cb228-2"><a href="#cb228-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#预烧期长度</span></span>
<span id="cb228-3"><a href="#cb228-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>; b <span class="ot">&lt;-</span> <span class="dv">5</span>; n <span class="ot">&lt;-</span> <span class="dv">9</span> <span class="co">#二元分布参数</span></span>
<span id="cb228-4"><a href="#cb228-4" tabindex="-1"></a>initial <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>)</span>
<span id="cb228-5"><a href="#cb228-5" tabindex="-1"></a></span>
<span id="cb228-6"><a href="#cb228-6" tabindex="-1"></a><span class="co">#用R函数实现Gibbs方法得到样本链</span></span>
<span id="cb228-7"><a href="#cb228-7" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb228-8"><a href="#cb228-8" tabindex="-1"></a>mcmc.result.R <span class="ot">&lt;-</span> <span class="fu">mcmc.Gibbs.R</span>(a, b, n, initial, N)</span>
<span id="cb228-9"><a href="#cb228-9" tabindex="-1"></a>X.chain.R <span class="ot">&lt;-</span> mcmc.result.R[<span class="dv">1</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>B)]</span>
<span id="cb228-10"><a href="#cb228-10" tabindex="-1"></a>Y.chain.R <span class="ot">&lt;-</span> mcmc.result.R[<span class="dv">2</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>B)]</span>
<span id="cb228-11"><a href="#cb228-11" tabindex="-1"></a></span>
<span id="cb228-12"><a href="#cb228-12" tabindex="-1"></a><span class="co">#用Rcpp函数实现Gibbs方法得到样本链</span></span>
<span id="cb228-13"><a href="#cb228-13" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb228-14"><a href="#cb228-14" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="st">&#39;../src/mcmc.Gibbs.Rcpp.cpp&#39;</span>)</span></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork):
## path[1]=&quot;D:/user_student/hw/Statistical_calculation/final/SA22204174/src/../inst/include&quot;:
## 系统找不到指定的文件。</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a>mcmc.result.Rcpp <span class="ot">&lt;-</span> <span class="fu">mcmc_Gibbs_Rcpp</span>(a, b, n, initial, N)</span>
<span id="cb230-2"><a href="#cb230-2" tabindex="-1"></a>X.chain.Rcpp <span class="ot">&lt;-</span> mcmc.result.Rcpp[<span class="dv">1</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>B)]</span>
<span id="cb230-3"><a href="#cb230-3" tabindex="-1"></a>Y.chain.Rcpp <span class="ot">&lt;-</span> mcmc.result.Rcpp[<span class="dv">2</span>, <span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>B)]</span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" tabindex="-1"></a><span class="co">#列表比较关于X的样本链的分布和X的理论边缘分布</span></span>
<span id="cb231-2"><a href="#cb231-2" tabindex="-1"></a><span class="co">#X样本链分布</span></span>
<span id="cb231-3"><a href="#cb231-3" tabindex="-1"></a>X.chain.R.freq <span class="ot">&lt;-</span> <span class="fu">table</span>(X.chain.R) <span class="sc">/</span> (N<span class="sc">-</span>B)</span>
<span id="cb231-4"><a href="#cb231-4" tabindex="-1"></a>X.chain.Rcpp.freq <span class="ot">&lt;-</span> <span class="fu">table</span>(X.chain.Rcpp) <span class="sc">/</span> (N<span class="sc">-</span>B)</span>
<span id="cb231-5"><a href="#cb231-5" tabindex="-1"></a><span class="co">#X理论分布</span></span>
<span id="cb231-6"><a href="#cb231-6" tabindex="-1"></a>X.value <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb231-7"><a href="#cb231-7" tabindex="-1"></a>X.population <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, X.value) <span class="sc">*</span> <span class="fu">beta</span>(X.value<span class="sc">+</span>a, n<span class="sc">-</span>X.value<span class="sc">+</span>b) <span class="sc">/</span> <span class="fu">beta</span>(a, b)</span>
<span id="cb231-8"><a href="#cb231-8" tabindex="-1"></a></span>
<span id="cb231-9"><a href="#cb231-9" tabindex="-1"></a>X.compare <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X.chain.R.freq, X.chain.Rcpp.freq, X.population)</span>
<span id="cb231-10"><a href="#cb231-10" tabindex="-1"></a><span class="fu">rownames</span>(X.compare) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Samples from R function&quot;</span>, <span class="st">&quot;Samples from Rcpp function&quot;</span>, <span class="st">&quot;Theoretical distribution&quot;</span>)</span>
<span id="cb231-11"><a href="#cb231-11" tabindex="-1"></a><span class="fu">round</span>(X.compare,<span class="dv">4</span>)</span></code></pre></div>
<pre><code>##                                 0      1      2      3      4      5      6
## Samples from R function    0.1492 0.1870 0.2003 0.1680 0.1285 0.0907 0.0448
## Samples from Rcpp function 0.1492 0.1870 0.2003 0.1680 0.1285 0.0907 0.0448
## Theoretical distribution   0.1429 0.1978 0.1978 0.1678 0.1259 0.0839 0.0490
##                                 7      8      9
## Samples from R function    0.0215 0.0085 0.0015
## Samples from Rcpp function 0.0215 0.0085 0.0015
## Theoretical distribution   0.0240 0.0090 0.0020</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb233-2"><a href="#cb233-2" tabindex="-1"></a><span class="co">#作图比较关于由R函数生成的X的样本链的分布和X的理论边缘分布</span></span>
<span id="cb233-3"><a href="#cb233-3" tabindex="-1"></a><span class="fu">barplot</span>(X.chain.R.freq, <span class="at">space =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">&quot;Density of X from R function&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>) <span class="co">#X样本链分布</span></span>
<span id="cb233-4"><a href="#cb233-4" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span>n <span class="sc">+</span> <span class="fl">0.5</span>, X.population, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>) <span class="co">#X理论分布</span></span>
<span id="cb233-5"><a href="#cb233-5" tabindex="-1"></a></span>
<span id="cb233-6"><a href="#cb233-6" tabindex="-1"></a><span class="co">#作图比较关于由R函数生成的Y的样本链的分布和Y的理论边缘分布</span></span>
<span id="cb233-7"><a href="#cb233-7" tabindex="-1"></a>Y_axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb233-8"><a href="#cb233-8" tabindex="-1"></a><span class="fu">hist</span>(Y.chain.R, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Density of Y from R function&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">xlab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>) <span class="co">#Y样本链分布</span></span>
<span id="cb233-9"><a href="#cb233-9" tabindex="-1"></a><span class="fu">lines</span>(Y_axis, Y_axis<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>Y_axis)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> <span class="fu">beta</span>(a,b), <span class="at">col =</span> <span class="dv">2</span>) <span class="co">#Y理论分布</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb234-2"><a href="#cb234-2" tabindex="-1"></a><span class="co">#作图比较关于由Rcpp函数生成的X的样本链的分布和X的理论边缘分布</span></span>
<span id="cb234-3"><a href="#cb234-3" tabindex="-1"></a><span class="fu">barplot</span>(X.chain.Rcpp.freq, <span class="at">space =</span> <span class="dv">0</span>, <span class="at">main =</span> <span class="st">&quot;Density of X from Rcpp function&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>) <span class="co">#X样本链分布</span></span>
<span id="cb234-4"><a href="#cb234-4" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">0</span><span class="sc">:</span>n <span class="sc">+</span> <span class="fl">0.5</span>, X.population, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">20</span>) <span class="co">#X理论分布</span></span>
<span id="cb234-5"><a href="#cb234-5" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" tabindex="-1"></a><span class="co">#作图比较关于由Rcpp函数生成的Y的样本链的分布和Y的理论边缘分布</span></span>
<span id="cb234-7"><a href="#cb234-7" tabindex="-1"></a>Y_axis <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb234-8"><a href="#cb234-8" tabindex="-1"></a><span class="fu">hist</span>(Y.chain.Rcpp, <span class="at">breaks =</span> <span class="st">&quot;Scott&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">main =</span> <span class="st">&quot;Density of Y from Rcpp function&quot;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>), <span class="at">xlab =</span> <span class="st">&quot;Y&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Density&quot;</span>) <span class="co">#Y样本链分布</span></span>
<span id="cb234-9"><a href="#cb234-9" tabindex="-1"></a><span class="fu">lines</span>(Y_axis, Y_axis<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>Y_axis)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">/</span> <span class="fu">beta</span>(a,b), <span class="at">col =</span> <span class="dv">2</span>) <span class="co">#Y理论分布</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As we can see, the Gibbs chains generated from R function and Rcpp
function are the same because them are generated under the same seed.
And we can conclude that the distributions of Gibbs chains for random
variables X and Y are close to the theoretical distributions.</p>
</div>
<div id="comparison-of-the-computation-time" class="section level3">
<h3>Comparison of the computation time</h3>
<p>We compare the computation time of the two functions.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.3.2</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" tabindex="-1"></a>compare.time <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">R.function =</span> <span class="fu">mcmc.Gibbs.R</span>(a, b, n, initial, N), <span class="at">Rcpp.function =</span> <span class="fu">mcmc_Gibbs_Rcpp</span>(a, b, n, initial, N))</span>
<span id="cb237-2"><a href="#cb237-2" tabindex="-1"></a><span class="fu">summary</span>(compare.time)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##            expr      lq   median       uq
## 1    R.function 21.1577 25.45185 30.10705
## 2 Rcpp.function  2.2319  2.29635  2.52285</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" tabindex="-1"></a><span class="fu">detach</span>(package<span class="sc">:</span>microbenchmark)</span>
<span id="cb239-2"><a href="#cb239-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<p>From the comparison above, we find that the computation speed of Rcpp
function is much faster than the R function. This supports the claim
that using Rcpp in R allows for more efficient computation.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
